{"ast":null,"code":"import _objectSpread from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Typography}from\"@material-ui/core\";import SongCard from\"./SongCard\";import youtubeSearch from\"../../apis/youtubeSearch\";// make a permanent playlist object with few songs catergory\nvar playlistsIds={LatestSongs:\"PLFgquLnL59akA2PflFpeQG9L01VFg90wS\",VpopSongs:\"PLWW7O4OXAEuPL8HUT5ELAOwdvpPA1YZd6\",EdmSongs:\"PLw-VjHDlEOgs658kAHR_LAaILBXb-s6Q5\",TopBolloywood:\"PLcRN7uK9CFpPkvCc-08tWOQo6PAg4u0lA\",TopPop:\"PL-i6X_qhBtJvEAEGGe1vYJy7B3hM2Bgzk\",Reggaeton:\"PLS_oEMUyvA728OZPmF9WPKjsGtfC75LiN\"};var slowConnectionTimeout;var HomePage=function HomePage(){// for home playlist\nvar _useState=useState({}),_useState2=_slicedToArray(_useState,2),songObj=_useState2[0],setSongObj=_useState2[1];var fetchFromApi=function fetchFromApi(){slowConnectionTimeout=setTimeout(function(){},5000);var getTrendingMusic=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return youtubeSearch.get(\"videos\",{params:{chart:\"mostPopular\",videoCategoryId:\"10\",regionCode:localStorage.getItem(\"country_code\")}});case 2:res=_context.sent;return _context.abrupt(\"return\",res.data.items);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getTrendingMusic(){return _ref.apply(this,arguments);};}();var getPlayListItems=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return youtubeSearch.get(\"playlistItems\",{params:{playlistId:data}});case 2:res=_context2.sent;return _context2.abrupt(\"return\",res.data.items);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function getPlayListItems(_x){return _ref2.apply(this,arguments);};}();getTrendingMusic().then(function(data){setSongObj(function(prevState){return _objectSpread(_objectSpread({},prevState),{trending:data});});});getPlayListItems(playlistsIds.VpopSongs).then(function(data){setSongObj(function(prevState){return _objectSpread(_objectSpread({},prevState),{latestSongs:data});});});getPlayListItems(playlistsIds.TopPop).then(function(data){setSongObj(function(prevState){return _objectSpread(_objectSpread({},prevState),{romanticSongs:data});});});getPlayListItems(playlistsIds.EdmSongs).then(function(data){setSongObj(function(prevState){return _objectSpread(_objectSpread({},prevState),{topBolloywood:data});});});};useEffect(function(){var startingTime=new Date();var storedTime=localStorage.getItem(\"trackTime\");var savedSongs=JSON.parse(localStorage.getItem(\"homePageSongObj\"));if(!window.navigator.onLine){alert(\"You don't have internet!\");}var checkTimeAndFetch=function checkTimeAndFetch(){var timeElapsed=new Date()-Date.parse(storedTime);//parse the date\nvar timeElapsedInHr=timeElapsed/(1000*60*60);//convert ms into hr\n// if time is more than 12 hr we will fetch from the api\nconsole.log(\"Saved song\",savedSongs);if(timeElapsedInHr>12||!savedSongs.latestSongs){fetchFromApi();localStorage.setItem(\"trackTime\",startingTime);//dont forgot to update the time\n}else{setSongObj(savedSongs);}};if(!storedTime){// if no time stored we will store it\nlocalStorage.setItem(\"trackTime\",startingTime);fetchFromApi();}else{checkTimeAndFetch();}},[]);// if song object changes we will push it to localstoarge\nuseEffect(function(){localStorage.setItem(\"homePageSongObj\",JSON.stringify(songObj));},[songObj]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(SongCard,{songs:songObj.trending,categotyTitle:\"Trending Now\"}),/*#__PURE__*/React.createElement(SongCard,{songs:songObj.latestSongs,categotyTitle:\"VNpop Music\"}),/*#__PURE__*/React.createElement(SongCard,{songs:songObj.romanticSongs,categotyTitle:\"Bolero List\"}),/*#__PURE__*/React.createElement(SongCard,{songs:songObj.topBolloywood,categotyTitle:\"Top EDM\"}));};export default HomePage;","map":{"version":3,"sources":["C:/myProJects/Server/weatherapp/src/components/sections/HomePage.js"],"names":["React","useState","useEffect","Typography","SongCard","youtubeSearch","playlistsIds","LatestSongs","VpopSongs","EdmSongs","TopBolloywood","TopPop","Reggaeton","slowConnectionTimeout","HomePage","songObj","setSongObj","fetchFromApi","setTimeout","getTrendingMusic","get","params","chart","videoCategoryId","regionCode","localStorage","getItem","res","data","items","getPlayListItems","playlistId","then","prevState","trending","latestSongs","romanticSongs","topBolloywood","startingTime","Date","storedTime","savedSongs","JSON","parse","window","navigator","onLine","alert","checkTimeAndFetch","timeElapsed","timeElapsedInHr","console","log","setItem","stringify"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Typography } from \"@material-ui/core\";\r\n\r\nimport SongCard from \"./SongCard\";\r\n\r\nimport youtubeSearch from \"../../apis/youtubeSearch\";\r\n\r\n// make a permanent playlist object with few songs catergory\r\nconst playlistsIds = {\r\n  LatestSongs: \"PLFgquLnL59akA2PflFpeQG9L01VFg90wS\",\r\n  VpopSongs: \"PLWW7O4OXAEuPL8HUT5ELAOwdvpPA1YZd6\",\r\n  EdmSongs: \"PLw-VjHDlEOgs658kAHR_LAaILBXb-s6Q5\",\r\n  TopBolloywood: \"PLcRN7uK9CFpPkvCc-08tWOQo6PAg4u0lA\",\r\n  TopPop: \"PL-i6X_qhBtJvEAEGGe1vYJy7B3hM2Bgzk\",\r\n  Reggaeton: \"PLS_oEMUyvA728OZPmF9WPKjsGtfC75LiN\"\r\n};\r\n\r\nlet slowConnectionTimeout;\r\nconst HomePage = () => {\r\n  // for home playlist\r\n  const [songObj, setSongObj] = useState({});\r\n\r\n  const fetchFromApi = () => {\r\n    slowConnectionTimeout = setTimeout(() => {}, 5000);\r\n\r\n    const getTrendingMusic = async () => {\r\n      const res = await youtubeSearch.get(\"videos\", {\r\n        params: {\r\n          chart: \"mostPopular\",\r\n          videoCategoryId: \"10\",\r\n          regionCode: localStorage.getItem(\"country_code\")\r\n        }\r\n      });\r\n\r\n      return res.data.items;\r\n    };\r\n\r\n    const getPlayListItems = async data => {\r\n      const res = await youtubeSearch.get(\"playlistItems\", {\r\n        params: {\r\n          playlistId: data\r\n        }\r\n      });\r\n      return res.data.items;\r\n    };\r\n\r\n    getTrendingMusic().then(data => {\r\n      setSongObj(prevState => {\r\n        return { ...prevState, ...{ trending: data } };\r\n      });\r\n    });\r\n\r\n    getPlayListItems(playlistsIds.VpopSongs).then(data => {\r\n      setSongObj(prevState => {\r\n        return { ...prevState, ...{ latestSongs: data } };\r\n      });\r\n    });\r\n\r\n    getPlayListItems(playlistsIds.TopPop).then(data => {\r\n      setSongObj(prevState => {\r\n        return { ...prevState, ...{ romanticSongs: data } };\r\n      });\r\n    });\r\n\r\n    getPlayListItems(playlistsIds.EdmSongs).then(data => {\r\n      setSongObj(prevState => {\r\n        return { ...prevState, ...{ topBolloywood: data } };\r\n      });\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const startingTime = new Date();\r\n    const storedTime = localStorage.getItem(\"trackTime\");\r\n    const savedSongs = JSON.parse(localStorage.getItem(\"homePageSongObj\"));\r\n\r\n    if (!window.navigator.onLine) {\r\n      alert(\"You don't have internet!\");\r\n    }\r\n\r\n    const checkTimeAndFetch = () => {\r\n      const timeElapsed = new Date() - Date.parse(storedTime); //parse the date\r\n\r\n      const timeElapsedInHr = timeElapsed / (1000 * 60 * 60); //convert ms into hr\r\n\r\n      // if time is more than 12 hr we will fetch from the api\r\n\r\n      console.log(\"Saved song\", savedSongs);\r\n      if (timeElapsedInHr > 12 || !savedSongs.latestSongs) {\r\n        fetchFromApi();\r\n        localStorage.setItem(\"trackTime\", startingTime); //dont forgot to update the time\r\n      } else {\r\n        setSongObj(savedSongs);\r\n      }\r\n    };\r\n\r\n    if (!storedTime) {\r\n      // if no time stored we will store it\r\n      localStorage.setItem(\"trackTime\", startingTime);\r\n      fetchFromApi();\r\n    } else {\r\n      checkTimeAndFetch();\r\n    }\r\n  }, []);\r\n\r\n  // if song object changes we will push it to localstoarge\r\n  useEffect(() => {\r\n    localStorage.setItem(\"homePageSongObj\", JSON.stringify(songObj));\r\n  }, [songObj]);\r\n\r\n  return (\r\n    <>\r\n      <br />\r\n      <SongCard songs={songObj.trending} categotyTitle={\"Trending Now\"} />\r\n\r\n      <SongCard songs={songObj.latestSongs} categotyTitle={\"VNpop Music\"} />\r\n\r\n      <SongCard songs={songObj.romanticSongs} categotyTitle={\"Bolero List\"} />\r\n\r\n      <SongCard songs={songObj.topBolloywood} categotyTitle={\"Top EDM\"} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default HomePage;\r\n"]},"metadata":{},"sourceType":"module"}