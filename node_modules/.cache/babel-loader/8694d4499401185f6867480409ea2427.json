{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect,useCallback,Suspense,lazy}from\"react\";import{BrowserRouter as Router,withRouter,Route,Link,Switch}from\"react-router-dom\";import{AnimatePresence}from\"framer-motion\";import{Tabs,Tab,withStyles,Grid,CircularProgress}from\"@material-ui/core\";import{Home,Favorite,VideoLibrary,History,GetApp}from\"@material-ui/icons/\";import{GlobalContext}from\"./GlobalState\";import{getHistory,getLikedSongs,getDownloadedSongs,removeDownloadingState,db}from\"../external/saveSong\";import SettingsPage from\"./sections/SettingsPage\";// import the db from save song\nimport MainPlayer from\"../components/player/MainPlayer\";// pages\nvar LoginPage=lazy(function(){return import(\"./LoginPage\");});var RenderDatabase=lazy(function(){return import(\"./RenderDatabase\");});var SearchResult=lazy(function(){return import(\"./SearchResult\");});var HomePage=lazy(function(){return import(\"./sections/HomePage\");});var FeedbackForm=lazy(function(){return import(\"./sections/FeedbackForm\");});var PrivacyPage=lazy(function(){return import(\"./sections/PrivacyPage\");});var DonatePage=lazy(function(){return import(\"./sections/DonatePage\");});var ContributorsPage=lazy(function(){return import(\"./sections/ContributorsPage\");});// custom styling the tab menus\nvar CustomTab=withStyles({root:{background:\"#4d6472\",position:\"fixed\",bottom:\"0\",padding:0,width:\"100%\",zIndex:1300},indicator:{display:\"none\"},labelIcon:{margin:0}})(Tabs);var CustomTabs=withStyles({root:{color:\"#FFB2C1\",fontSize:\".75rem\",margin:0,\"&:hover\":{color:\"#ffffffed\",opacity:1},\"&$selected\":{color:\"#fff\"},\"&:focus\":{color:\"#FFFFFF\"}},selected:{}})(Tab);var deferredPrompt=undefined;var previousLocation;window.addEventListener(\"beforeinstallprompt\",function(e){// Stash the event so it can be triggered later.\ndeferredPrompt=e;});var CurrentSection=function CurrentSection(_ref){var history=_ref.history,location=_ref.location;var _useContext=useContext(GlobalContext),_useContext2=_slicedToArray(_useContext,1),_useContext2$=_useContext2[0],currentVideoSnippet=_useContext2$.currentVideoSnippet,searchResult=_useContext2$.searchResult;console.log(currentVideoSnippet);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),songsHistoryState=_useState2[0],setSongsHistory=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),songsLikedState=_useState4[0],setSongsLiked=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),songsDownloadedState=_useState6[0],setSongsDownloaded=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),tabValue=_useState8[0],setTabValue=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),updateCount=_useState10[0],setUpdateCount=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),redirectState=_useState12[0],setRedirectState=_useState12[1];var circularLoader=/*#__PURE__*/React.createElement(Grid,{style:{height:\"100vh\"},container:true,justify:\"center\",alignItems:\"center\"},/*#__PURE__*/React.createElement(CircularProgress,null));function handleChange(event,newValue){setTabValue(newValue);}var fetchSongs=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=tabValue;_context.next=_context.t0===1?3:_context.t0===2?9:_context.t0===3?15:21;break;case 3:_context.t1=setSongsLiked;_context.next=6;return getLikedSongs();case 6:_context.t2=_context.sent;(0,_context.t1)(_context.t2);return _context.abrupt(\"break\",22);case 9:_context.t3=setSongsDownloaded;_context.next=12;return getDownloadedSongs();case 12:_context.t4=_context.sent;(0,_context.t3)(_context.t4);return _context.abrupt(\"break\",22);case 15:_context.t5=setSongsHistory;_context.next=18;return getHistory();case 18:_context.t6=_context.sent;(0,_context.t5)(_context.t6);return _context.abrupt(\"break\",22);case 21:return _context.abrupt(\"break\",22);case 22:case\"end\":return _context.stop();}}},_callee);})),[tabValue]);//\nuseEffect(function(){fetchSongs();},[tabValue,fetchSongs]);useEffect(function(){fetchSongs();console.log(\"fetching the songs\");},[updateCount,fetchSongs]);useEffect(function(){db.on(\"changes\",function(){setUpdateCount(function(c){return c+1;});});// will remove all the songs which are downloading in the first place\nremoveDownloadingState();var isThisNewUser=localStorage.getItem(\"isThisNew\");if(isThisNewUser===\"no\"){setRedirectState(true);}// if this is not a new user redirect it to home\npreviousLocation=location;history.listen(function(location){if(location.pathname!==\"/play\"){previousLocation=location;console.log(previousLocation);}});},[]);useEffect(function(){// we will redirect everytime user comes to root page\nif(redirectState&&history.location.pathname===\"/\"){history.replace(\"/home\");}// if the location is not play then we will push new location\n},[setRedirectState,history,redirectState]);var checkPrevLocation=function checkPrevLocation(){if(location.pathname===\"/play\"){return previousLocation;}else{return location;}};// we will load the homepage with all the playlists\nvar continueToHome=function continueToHome(){localStorage.setItem(\"isThisNew\",\"no\");history.replace(\"/\");if(deferredPrompt){// show the prompt to install app\ndeferredPrompt.prompt();// Wait for the user to respond to the prompt\ndeferredPrompt.userChoice.then(function(choiceResult){if(choiceResult.outcome===\"accepted\"){console.log(\"User accepted the A2HS prompt\");}else{console.log(\"User dismissed the A2HS prompt\");}deferredPrompt=null;});}};var returnMainPlayer=function returnMainPlayer(props){// we will return the main player if the path is not the \"/\"\nif(window.location.pathname!==\"/\"){return/*#__PURE__*/React.createElement(MainPlayer,props);}else{return null;}};// the set tab value will keep the tab active on their route\n// there are 4 tabs so there will be 3 indexes\nreturn/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Suspense,{fallback:circularLoader},/*#__PURE__*/React.createElement(Switch,{location:checkPrevLocation()},/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/page1\",render:function render(props){return/*#__PURE__*/React.createElement(LoginPage,{continueToHome:continueToHome});}}),/*#__PURE__*/React.createElement(Route,{path:\"/search\",render:function render(props){return/*#__PURE__*/React.createElement(SearchResult,{videos:searchResult});}}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/home\",render:function render(props){setTabValue(0);return/*#__PURE__*/React.createElement(HomePage,null);}}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/liked\",render:function render(props){setTabValue(1);return/*#__PURE__*/React.createElement(RenderDatabase,Object.assign({songs:songsLikedState},props,{key:location.pathname}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/downloads\",render:function render(props){setTabValue(2);return/*#__PURE__*/React.createElement(RenderDatabase,{songs:songsDownloadedState,key:location.pathname});}}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/history\",render:function render(props){setTabValue(3);return/*#__PURE__*/React.createElement(RenderDatabase,{songs:songsHistoryState,key:location.pathname});}}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/app\",render:function render(props){window.location.replace(\"/\");return/*#__PURE__*/React.createElement(\"div\",null,\"Redirecting you to play store\");}}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/settings\",component:SettingsPage}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/privacy\",component:PrivacyPage}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/feedback\",component:FeedbackForm}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/donate\",component:DonatePage}),/*#__PURE__*/React.createElement(Route,{path:\"/page1/contributors\",component:ContributorsPage})),/*#__PURE__*/React.createElement(Route,{path:\"/\",render:function render(props){return returnMainPlayer(props);}}),/*#__PURE__*/React.createElement(\"div\",{style:{height:currentVideoSnippet.id?\"100px\":\"50px\"}})),/*#__PURE__*/React.createElement(CustomTab,{value:tabValue,onChange:handleChange,variant:\"fullWidth\",indicatorColor:\"primary\",textColor:\"primary\"},/*#__PURE__*/React.createElement(CustomTabs,{icon:/*#__PURE__*/React.createElement(Home,null),\"aria-label\":\"Home\",component:Link,to:\"/page1/home\",label:\"Home\"}),/*#__PURE__*/React.createElement(CustomTabs,{icon:/*#__PURE__*/React.createElement(Favorite,null),\"aria-label\":\"Liked\",component:Link,to:\"/page1/liked\",label:\"Liked\"}),/*#__PURE__*/React.createElement(CustomTabs,{icon:/*#__PURE__*/React.createElement(GetApp,null),\"aria-label\":\"Downloads\",component:Link,to:\"/page1/downloads\",label:\"Downloads\"}),/*#__PURE__*/React.createElement(CustomTabs,{icon:/*#__PURE__*/React.createElement(History,null),\"aria-label\":\"History\",component:Link,to:\"/page1/history\",label:\"History\"})));};export default withRouter(CurrentSection);","map":{"version":3,"sources":["C:/myProJects/Server/weatherapp/src/components/CurrentSection.js"],"names":["React","useContext","useState","useEffect","useCallback","Suspense","lazy","BrowserRouter","Router","withRouter","Route","Link","Switch","AnimatePresence","Tabs","Tab","withStyles","Grid","CircularProgress","Home","Favorite","VideoLibrary","History","GetApp","GlobalContext","getHistory","getLikedSongs","getDownloadedSongs","removeDownloadingState","db","SettingsPage","MainPlayer","LoginPage","RenderDatabase","SearchResult","HomePage","FeedbackForm","PrivacyPage","DonatePage","ContributorsPage","CustomTab","root","background","position","bottom","padding","width","zIndex","indicator","display","labelIcon","margin","CustomTabs","color","fontSize","opacity","selected","deferredPrompt","undefined","previousLocation","window","addEventListener","e","CurrentSection","history","location","currentVideoSnippet","searchResult","console","log","songsHistoryState","setSongsHistory","songsLikedState","setSongsLiked","songsDownloadedState","setSongsDownloaded","tabValue","setTabValue","updateCount","setUpdateCount","redirectState","setRedirectState","circularLoader","height","handleChange","event","newValue","fetchSongs","on","c","isThisNewUser","localStorage","getItem","listen","pathname","replace","checkPrevLocation","continueToHome","setItem","prompt","userChoice","then","choiceResult","outcome","returnMainPlayer","props","id"],"mappings":"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","sourcesContent":["import React, {\r\n  useContext,\r\n  useState,\r\n  useEffect,\r\n  useCallback,\r\n  Suspense,\r\n  lazy\r\n} from \"react\";\r\n\r\nimport {\r\n  BrowserRouter as Router,\r\n  withRouter,\r\n  Route,\r\n  Link,\r\n  Switch\r\n} from \"react-router-dom\";\r\n\r\nimport { AnimatePresence } from \"framer-motion\";\r\nimport {\r\n  Tabs,\r\n  Tab,\r\n  withStyles,\r\n  Grid,\r\n  CircularProgress\r\n} from \"@material-ui/core\";\r\n\r\n\r\nimport {\r\n  Home,\r\n  Favorite,\r\n  VideoLibrary,\r\n  History,\r\n  GetApp\r\n} from \"@material-ui/icons/\";\r\n\r\nimport { GlobalContext } from \"./GlobalState\";\r\nimport {\r\n  getHistory,\r\n  getLikedSongs,\r\n  getDownloadedSongs,\r\n  removeDownloadingState,\r\n  db\r\n} from \"../external/saveSong\";\r\n\r\nimport SettingsPage from \"./sections/SettingsPage\";\r\n// import the db from save song\r\nimport MainPlayer from \"../components/player/MainPlayer\";\r\n// pages\r\nconst LoginPage = lazy(() => import(\"./LoginPage\"));\r\nconst RenderDatabase = lazy(() => import(\"./RenderDatabase\"));\r\nconst SearchResult = lazy(() => import(\"./SearchResult\"));\r\nconst HomePage = lazy(() => import(\"./sections/HomePage\"));\r\nconst FeedbackForm = lazy(() => import(\"./sections/FeedbackForm\"));\r\nconst PrivacyPage = lazy(() => import(\"./sections/PrivacyPage\"));\r\nconst DonatePage = lazy(() => import(\"./sections/DonatePage\"));\r\nconst ContributorsPage = lazy(() => import(\"./sections/ContributorsPage\"));\r\n\r\n// custom styling the tab menus\r\nconst CustomTab = withStyles({\r\n  root: {\r\n    background: \"#4d6472\",\r\n    position: \"fixed\",\r\n    bottom: \"0\",\r\n    padding: 0,\r\n    width: \"100%\",\r\n    zIndex: 1300\r\n  },\r\n  indicator: {\r\n    display: \"none\"\r\n  },\r\n  labelIcon: {\r\n    margin: 0\r\n  }\r\n})(Tabs);\r\n\r\nconst CustomTabs = withStyles({\r\n  root: {\r\n    color: \"#FFB2C1\",\r\n    fontSize: \".75rem\",\r\n    margin: 0,\r\n\r\n    \"&:hover\": {\r\n      color: \"#ffffffed\",\r\n      opacity: 1\r\n    },\r\n    \"&$selected\": {\r\n      color: \"#fff\"\r\n    },\r\n    \"&:focus\": {\r\n      color: \"#FFFFFF\"\r\n    }\r\n  },\r\n\r\n  selected: {}\r\n})(Tab);\r\n\r\nlet deferredPrompt = undefined;\r\nlet previousLocation;\r\n\r\nwindow.addEventListener(\"beforeinstallprompt\", e => {\r\n  // Stash the event so it can be triggered later.\r\n  deferredPrompt = e;\r\n});\r\n\r\nconst CurrentSection = ({ history, location }) => {\r\n  const [{ currentVideoSnippet, searchResult }] = useContext(GlobalContext);\r\n  console.log(currentVideoSnippet);\r\n\r\n  const [songsHistoryState, setSongsHistory] = useState([]);\r\n  const [songsLikedState, setSongsLiked] = useState([]);\r\n  const [songsDownloadedState, setSongsDownloaded] = useState([]);\r\n  const [tabValue, setTabValue] = useState(0);\r\n  const [updateCount, setUpdateCount] = useState(0);\r\n  const [redirectState, setRedirectState] = useState(null);\r\n\r\n  const circularLoader = (\r\n    <Grid\r\n      style={{ height: \"100vh\" }}\r\n      container\r\n      justify=\"center\"\r\n      alignItems=\"center\"\r\n    >\r\n      <CircularProgress />\r\n    </Grid>\r\n  );\r\n\r\n  function handleChange(event, newValue) {\r\n    setTabValue(newValue);\r\n  }\r\n\r\n  const fetchSongs = useCallback(async () => {\r\n    //it's same as the orders of our tabs\r\n    switch (tabValue) {\r\n      case 1:\r\n        setSongsLiked(await getLikedSongs());\r\n        break;\r\n\r\n      case 2:\r\n        setSongsDownloaded(await getDownloadedSongs());\r\n        break;\r\n\r\n      case 3:\r\n        setSongsHistory(await getHistory());\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }, [tabValue]);\r\n  //\r\n  useEffect(() => {\r\n    fetchSongs();\r\n  }, [tabValue, fetchSongs]);\r\n\r\n  useEffect(() => {\r\n    fetchSongs();\r\n    console.log(\"fetching the songs\");\r\n  }, [updateCount, fetchSongs]);\r\n\r\n  useEffect(() => {\r\n    db.on(\"changes\", () => {\r\n      setUpdateCount(c => c + 1);\r\n    });\r\n    // will remove all the songs which are downloading in the first place\r\n    removeDownloadingState();\r\n\r\n    const isThisNewUser = localStorage.getItem(\"isThisNew\");\r\n    if (isThisNewUser === \"no\") {\r\n      setRedirectState(true);\r\n    }\r\n    // if this is not a new user redirect it to home\r\n    previousLocation = location;\r\n    history.listen(location => {\r\n      if (location.pathname !== \"/play\") {\r\n        previousLocation = location;\r\n        console.log(previousLocation);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // we will redirect everytime user comes to root page\r\n    if (redirectState && history.location.pathname === \"/\") {\r\n      history.replace(\"/home\");\r\n    }\r\n\r\n    // if the location is not play then we will push new location\r\n  }, [setRedirectState, history, redirectState]);\r\n\r\n  const checkPrevLocation = () => {\r\n    if (location.pathname === \"/play\") {\r\n      return previousLocation;\r\n    } else {\r\n      return location;\r\n    }\r\n  };\r\n\r\n  // we will load the homepage with all the playlists\r\n  const continueToHome = () => {\r\n    localStorage.setItem(\"isThisNew\", \"no\");\r\n    history.replace(\"/\");\r\n\r\n    if (deferredPrompt) {\r\n      // show the prompt to install app\r\n      deferredPrompt.prompt();\r\n      // Wait for the user to respond to the prompt\r\n      deferredPrompt.userChoice.then(choiceResult => {\r\n        if (choiceResult.outcome === \"accepted\") {\r\n          console.log(\"User accepted the A2HS prompt\");\r\n        } else {\r\n          console.log(\"User dismissed the A2HS prompt\");\r\n        }\r\n        deferredPrompt = null;\r\n      });\r\n    }\r\n  };\r\n\r\n  const returnMainPlayer = props => {\r\n    // we will return the main player if the path is not the \"/\"\r\n\r\n    if (window.location.pathname !== \"/\") {\r\n      return <MainPlayer {...props} />;\r\n    } else {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  // the set tab value will keep the tab active on their route\r\n  // there are 4 tabs so there will be 3 indexes\r\n  return (\r\n    <div>\r\n      <Suspense fallback={circularLoader}>\r\n        <Switch location={checkPrevLocation()}>\r\n          <Route\r\n            exact\r\n            path=\"/page1\"\r\n            render={props => {\r\n              return <LoginPage continueToHome={continueToHome} />;\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/search\"\r\n            render={props => <SearchResult videos={searchResult} />}\r\n          />\r\n          <Route\r\n            path=\"/page1/home\"\r\n            render={props => {\r\n              setTabValue(0);\r\n              return <HomePage />;\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/page1/liked\"\r\n            render={props => {\r\n              setTabValue(1);\r\n              return (\r\n                <RenderDatabase\r\n                  songs={songsLikedState}\r\n                  {...props}\r\n                  key={location.pathname}\r\n                />\r\n              );\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/page1/downloads\"\r\n            render={props => {\r\n              setTabValue(2);\r\n              return (\r\n                <RenderDatabase\r\n                  songs={songsDownloadedState}\r\n                  key={location.pathname}\r\n                />\r\n              );\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/page1/history\"\r\n            render={props => {\r\n              setTabValue(3);\r\n              return (\r\n                <RenderDatabase\r\n                  songs={songsHistoryState}\r\n                  key={location.pathname}\r\n                />\r\n              );\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/page1/app\"\r\n            render={props => {\r\n              window.location.replace(\r\n                \"/\"\r\n              );\r\n              return <div>Redirecting you to play store</div>;\r\n            }}\r\n          />\r\n\r\n          <Route path=\"/page1/settings\" component={SettingsPage} />\r\n          <Route path=\"/page1/privacy\" component={PrivacyPage} />\r\n\r\n          <Route path=\"/page1/feedback\" component={FeedbackForm} />\r\n          <Route path=\"/page1/donate\" component={DonatePage} />\r\n          <Route path=\"/page1/contributors\" component={ContributorsPage} />\r\n        </Switch>\r\n        <Route path=\"/\" render={props => returnMainPlayer(props)} />\r\n\r\n        <div style={{ height: currentVideoSnippet.id ? \"100px\" : \"50px\" }} />\r\n      </Suspense>\r\n      {/* if the player is on then return 100px else 50px*/}\r\n      <CustomTab\r\n        value={tabValue}\r\n        onChange={handleChange}\r\n        variant=\"fullWidth\"\r\n        indicatorColor=\"primary\"\r\n        textColor=\"primary\"\r\n      >\r\n        <CustomTabs\r\n          icon={<Home />}\r\n          aria-label=\"Home\"\r\n          component={Link}\r\n          to=\"/page1/home\"\r\n          label=\"Home\"\r\n        />\r\n\r\n        <CustomTabs\r\n          icon={<Favorite />}\r\n          aria-label=\"Liked\"\r\n          component={Link}\r\n          to=\"/page1/liked\"\r\n          label=\"Liked\"\r\n        />\r\n\r\n        <CustomTabs\r\n          icon={<GetApp />}\r\n          aria-label=\"Downloads\"\r\n          component={Link}\r\n          to=\"/page1/downloads\"\r\n          label=\"Downloads\"\r\n        />\r\n        <CustomTabs\r\n          icon={<History />}\r\n          aria-label=\"History\"\r\n          component={Link}\r\n          to=\"/page1/history\"\r\n          label=\"History\"\r\n        />\r\n      </CustomTab>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withRouter(CurrentSection);\r\n"]},"metadata":{},"sourceType":"module"}