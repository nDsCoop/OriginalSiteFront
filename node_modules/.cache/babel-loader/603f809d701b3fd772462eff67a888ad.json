{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import defaultImg from\"../images/Logosvg3.svg\";import className from'classnames';import{Link}from'react-router-dom';import{OrderedMap}from'immutable';import _,{chunk}from'lodash';import{ObjectID}from\"../helpers/objectid\";import{IconButton}from'@material-ui/core';import{CgSoftwareUpload}from'react-icons/cg';import{MdSettings,MdDeleteForever,MdInsertEmoticon,MdMic}from'react-icons/md';import moment from'moment';import{UserBar}from\"./UserBar\";import Dropzone from\"react-dropzone\";import Picker,{SKIN_TONE_MEDIUM_DARK}from'emoji-picker-react';import AudioAnalyser from'./library/AudioAnalyser';import{MainVideo}from'./MainVideo';// import { ReactMic } from 'react-mic';\nvar App3=/*#__PURE__*/function(_Component){_inherits(App3,_Component);var _super=_createSuper(App3);function App3(props){var _this;_classCallCheck(this,App3);_this=_super.call(this,props);_this.onClickOutSide=function(e){if(_this.ref&&!_this.ref.contains(e.target)){// console.log(\"Here click out side login form!\");\n_this.setState({showEmoji:false});}};_this.onDrop=function(files){var store=_this.props.store;console.log(\"file goc: \",files);var formData=new FormData();formData.append(\"file\",files[0]);store.upLoadfile(formData);console.log(\"file format: \",formData);};_this.sendTyping=function(){var store=_this.props.store;var activeChannel=store.getActiveChannel();_this.lastUpdateTime=Date.now();if(!_this.state.isTyping){_this.setState({isTyping:true});store.addTyping(activeChannel,true);_this.startCheckingTyping();}};_this.startCheckingTyping=function(){console.log(\"Typing\");_this.typingInterval=setInterval(function(){if(Date.now()-_this.lastUpdateTime>350){_this.setState({isTyping:false});_this.stopCheckingTyping();}},300);};_this.stopCheckingTyping=function(){var store=_this.props.store;var activeChannel=store.getActiveChannel();console.log(\"Stop Typing\");if(_this.typingInterval){clearInterval(_this.typingInterval);store.addTyping(activeChannel,false);// console.log(this.state.isTyping);\n}};_this.renderChannelTitle=function(){var channel=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var store=_this.props.store;var members=store.getMembersFromChannel(channel);var names=[];members.forEach(function(user){var name=_.get(user,'name');names.push(name);});var title=_.join(names,', ');if(!title&&_.get(channel,'isNew')){title='New Mss';}return/*#__PURE__*/React.createElement(\"h4\",null,title);};_this.handleOnClick=function(user){var store=_this.props.store;var userId=_.get(user,'_id');var channelId=_.get(store.getActiveChannel(),'_id');store.addUserToChannel(channelId,userId);_this.setState({searchUser:''});};_this._onCreateChannel=function(e){e.preventDefault();var store=_this.props.store;var currentUser=store.getCurrentUser();var currentUserId=_.get(currentUser,'_id');var channelId=new ObjectID().toString();var channel={_id:channelId,title:\"\",lastMessage:\"Let's a chat\",members:new OrderedMap(),messages:new OrderedMap(),isNew:true,userId:currentUserId,created:new Date(),typing:false};channel.members=channel.members.set(currentUserId,true);store.onCreateNewChannel(channel);};_this.scrollMessagesToBottom=function(){if(_this.messagesRef){_this.messagesRef.scrollTop=_this.messagesRef.scrollHeight;}};_this.handleSubmit=function(e){var newMessage=_this.state.newMessage;var store=_this.props.store;e.preventDefault();if(_.trim(newMessage).length){var messageId=new ObjectID().toString();var channel=store.getActiveChannel();var channelId=_.get(channel,'_id',null);var currentUser=store.getCurrentUser();var message={_id:messageId,channelId:channelId,body:newMessage,userId:_.get(currentUser,'_id'),type:\"text\",me:true};store.addMessage(messageId,message);_this.setState({newMessage:\"\"});}_this.setState({newMessage:\"\",showEmoji:false});};_this._onResi=function(){_this.setState({height:window.innerHeight});};_this.state={height:window.innerHeight,newMessage:'',searchUser:'',showSearchUser:false,isTyping:false,showEmoji:false,audio:null,temp:5000,isShowGetAud:false,record:false};return _this;}_createClass(App3,[{key:\"startRecording\",value:function(){var _startRecording=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var store,audio,chunks,recoder;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:store=this.props.store;_context.next=3;return navigator.mediaDevices.getUserMedia({audio:true,video:false});case 3:audio=_context.sent;this.setState({audio:audio});this.setState({isShowGetAud:true});this.setState({record:true});chunks=[];recoder=new MediaRecorder(audio);recoder.start();recoder.ondataavailable=function(e){chunks.push(e.data);var namefile=new ObjectID().toString();var files=new File(chunks,\"\".concat(namefile+'.mp3'),{type:\"audio/wav\"});var path=URL.createObjectURL(files);files.path=\"\".concat(_.toString(path.substring(27)+'.mp3'));var name=_.toString(files.path);files.fileName=\"\".concat(name);// console.log(\"file goc 1: \", files);\nvar file=[];file.push(files);// console.log(\"File goc\", file);\nvar formData=new FormData();formData.append('file',file[0]);// store.upLoadfile(formData);\n};case 11:case\"end\":return _context.stop();}}},_callee,this);}));function startRecording(){return _startRecording.apply(this,arguments);}return startRecording;}()//stop\n},{key:\"stopRecording\",value:function stopRecording(){if(this.state.audio!==null){this.state.audio.getTracks().forEach(function(track){return track.stop();});this.setState({audio:null});this.setState({record:false});}else{console.log(\"Error shortage-lenght!\");}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.stopCheckingTyping();}},{key:\"renderChannelAvatar\",value:function renderChannelAvatar(channel){var store=this.props.store;var members=store.getMembersFromChannel(channel);var maxDisplay=4;var total=members.size>maxDisplay?maxDisplay:members.size;var avatars=members.map(function(user,index){return index<maxDisplay?/*#__PURE__*/React.createElement(\"img\",{key:index,src:_.get(user,'avatar'),alt:_.get(user,'name')}):null;});return/*#__PURE__*/React.createElement(\"div\",{className:className('channel-avatars',\"channel-avatars-\".concat(total))},avatars);}},{key:\"componentDidUpdate\",// addTestMessages = () => {\n//     const {store} = this.props\n//     for(let i = 0; i < 20; i++){\n//         let isMe = false;\n//         if(i % 2 === 0) {\n//             isMe = true;\n//         }\n//         const newMsg = {\n//             _id: `${i}`,\n//             author: `Author: ${i}`,\n//             body: `The body of message ${i}`,\n//             avatar: defaultImg,\n//             me: isMe,\n//             timing: '0:00'\n//         }\n//         store.addMessage(i, newMsg);\n//     }\n//     for (let c = 0; c<10; c++){\n//         const newChannel ={\n//             _id: `${c}`,\n//             title: `Channel title ${c}`,\n//             lastMessage: `Hey there is.. ${c}`,\n//             members: new OrderedMap({\n//                 '1': true,\n//                 '2': true,\n//             }),\n//             messages: new OrderedMap(),\n//             created: new Date(),\n//         }\n//         const moreMsgId =`${c + 1}`;\n//         const msgId = `${c}`;\n//         newChannel.messages = newChannel.messages.set(msgId, true);\n//         newChannel.messages = newChannel.messages.set(moreMsgId, true);\n//         store.addChannel(c, newChannel);\n//     }\n// }\nvalue:function componentDidUpdate(){this.scrollMessagesToBottom();// console.log(\"CDidUpdate\");\n}},{key:\"componentDidMount\",value:function componentDidMount(){window.addEventListener('resize',this._onResi);window.addEventListener('mousedown',this.onClickOutSide);// this.addTestMessages();\n// console.log(\"CDidMount\");\n}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('resize',this._onResi);window.removeEventListener('mousedown',this.onClickOutSide);// console.log(\"CWillUnMount\");\n}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,height=_this$state.height,newMessage=_this$state.newMessage,showEmoji=_this$state.showEmoji,isShowGetAud=_this$state.isShowGetAud;var store=this.props.store;// const isConnected = store.isConnected();\nvar activeChannel=store.getActiveChannel();var messages=store.getMessagesFromChannel(activeChannel);var members=store.getMembersFromChannel(activeChannel);var channels=store.getChannels();var usersList=store.getSearchUsers();var me=store.getCurrentUser();var onEmojiClick=function onEmojiClick(event,emojiObject){_this2.setState({newMessage:\"\".concat(emojiObject.emoji)});console.log(\"\".concat(emojiObject.emoji));};var style={height:height};var resultSearch=function resultSearch(){return/*#__PURE__*/React.createElement(\"div\",{className:\"search-user\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-list\"},usersList.map(function(user,index){return/*#__PURE__*/React.createElement(\"div\",{onClick:function onClick(){return _this2.handleOnClick(user);},key:index,className:\"user\"},/*#__PURE__*/React.createElement(\"img\",{src:user.avatar,alt:user.name}),/*#__PURE__*/React.createElement(\"span\",null,user.name));})));};return/*#__PURE__*/React.createElement(\"div\",{style:style,className:\"app3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"header-left\"},/*#__PURE__*/React.createElement(\"div\",{className:\"action\"},/*#__PURE__*/React.createElement(Link,{onClick:function onClick(e){return _this2._onCreateChannel(e);},className:\"btn-primary\"},\"AddNew\"))),_.get(activeChannel,'isNew')?/*#__PURE__*/React.createElement(\"div\",{className:\"toolbar\"},/*#__PURE__*/React.createElement(\"form\",{className:\"tool\"},/*#__PURE__*/React.createElement(\"textarea\",{type:\"text\",value:this.state.searchUser,placeholder:\"To UserName/Email\",onChange:function onChange(e){var searchTxt=_.get(e,'target.value');_this2.setState({searchUser:searchTxt},function(){store.startSearchUsers(searchTxt);});}})),resultSearch()):null,/*#__PURE__*/React.createElement(\"div\",{className:\"header-mid\"},this.renderChannelTitle(activeChannel)),/*#__PURE__*/React.createElement(\"div\",{className:\"header-right\"},/*#__PURE__*/React.createElement(UserBar,{store:store}),/*#__PURE__*/React.createElement(\"div\",{className:\"toolsRight-bar\"},/*#__PURE__*/React.createElement(IconButton,{style:{color:\"rgba(0, 0, 0, 0.5)\"}},/*#__PURE__*/React.createElement(MdSettings,null))))),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-main\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-left\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chanels\"},channels.map(function(channel,index){return/*#__PURE__*/React.createElement(\"div\",{onClick:function onClick(index){store.setActiveChannelId(channel._id);},key:channel._id,className:className('chanel',{'active':_.get(activeChannel,'_id')===_.get(channel,'_id',null)})},/*#__PURE__*/React.createElement(\"div\",{className:\"user-img\"},_this2.renderChannelAvatar(channel)),/*#__PURE__*/React.createElement(\"div\",{className:className('chanel-info',{'notify':_.get(channel,'notify',null)})},_this2.renderChannelTitle(channel)));}))),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"toolChat\"},/*#__PURE__*/React.createElement(Dropzone,{onDrop:this.onDrop},function(_ref){var getRootProps=_ref.getRootProps,getInputProps=_ref.getInputProps;return/*#__PURE__*/React.createElement(\"section\",null,/*#__PURE__*/React.createElement(\"div\",getRootProps(),/*#__PURE__*/React.createElement(\"input\",getInputProps()),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(CgSoftwareUpload,null))));})),/*#__PURE__*/React.createElement(\"div\",{ref:function ref(_ref3){return _this2.messagesRef=_ref3;},className:\"messages\"},messages.map(function(mess,index){var user=_.get(mess,'user');return/*#__PURE__*/React.createElement(\"div\",{key:index,className:\"\".concat(mess.me?'message-me':'message')},/*#__PURE__*/React.createElement(\"img\",{src:_.get(user,'avatar'),alt:\"user-img\",className:\"img-user\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"message-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"username\"},\"\".concat(mess.me?'You':_.get(mess,'user.name')),\" say: \"),/*#__PURE__*/React.createElement(\"p\",{className:\"message-text\"},\"\".concat(mess.body).substring(0,8)===\"uploads/\"?// this will be either video or image \n\"\".concat(mess.body).substring(\"\".concat(mess.body).length-3,\"\".concat(mess.body).length)==='mp3'?/*#__PURE__*/React.createElement(\"video\",{style:{maxWidth:'20rem'},src:\"http://localhost:8080/\".concat(mess.body),alt:\"video\",type:\"video/mp4\",controls:true}):/*#__PURE__*/React.createElement(\"img\",{style:{maxWidth:'20rem'},src:\"http://localhost:8080/\".concat(mess.body),alt:\"img\"}):/*#__PURE__*/React.createElement(\"p\",null,mess.body),/*#__PURE__*/React.createElement(\"p\",{className:\"timing\"},mess.timing))));}),showEmoji?/*#__PURE__*/React.createElement(\"div\",{className:\"emoji\",ref:function ref(_ref2){return _this2.ref=_ref2;}},/*#__PURE__*/React.createElement(Picker,{onEmojiClick:onEmojiClick,skinTone:SKIN_TONE_MEDIUM_DARK})):null),isShowGetAud?/*#__PURE__*/React.createElement(\"div\",{className:\"getAdi\"},/*#__PURE__*/React.createElement(\"div\",null,this.state.audio?/*#__PURE__*/React.createElement(AudioAnalyser,{audio:this.state.audio}):null)):null,_.get(activeChannel,'typing')&&_.get(activeChannel,'typier')!==_.get(me,'_id')?/*#__PURE__*/React.createElement(\"div\",{disabled:newMessage.length>1,className:\"typing-status\"},\"Is Typing..\"):null,members.size>0?/*#__PURE__*/React.createElement(\"div\",{className:\"message-input\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit,disabled:newMessage.length<1,className:\"message-form\"},/*#__PURE__*/React.createElement(IconButton,{onClick:function onClick(){_this2.setState({showEmoji:!showEmoji});}},/*#__PURE__*/React.createElement(MdInsertEmoticon,null)),/*#__PURE__*/React.createElement(\"textarea\",{id:\"message\",ref:function ref(input){return _this2.input=input;},type:\"text\",className:\"form-control\",value:newMessage,autoComplete:'off',placeholder:\"Type something interesting\",onKeyUp:function onKeyUp(e){{if(e.keyCode===13&&!e.shiftKey){_this2.handleSubmit(e);}}{if(e.keyCode!==13){_this2.sendTyping();}}},onChange:function onChange(_ref4){var target=_ref4.target;_this2.setState({newMessage:target.value});}}),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(MdMic,{onMouseDown:function onMouseDown(){_this2.startRecording();},onMouseUp:function onMouseUp(){_this2.stopRecording();}})),/*#__PURE__*/React.createElement(\"button\",{disabled:newMessage.length<1,type:\"submit\",className:\"send\",onClick:this.handleSubmit},\" Send \"))):null),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-right\"},/*#__PURE__*/React.createElement(\"div\",{className:\"title-right\"},\"Members\"),/*#__PURE__*/React.createElement(\"div\",{className:\"chanels\"},members.map(function(member,index){var isOnline=_.get(member,'online',false);return/*#__PURE__*/React.createElement(\"div\",{key:index,className:\"chanel\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-img-channel\"},/*#__PURE__*/React.createElement(\"img\",{src:_.get(member,'avatar'),alt:\"user-img\"}),/*#__PURE__*/React.createElement(\"span\",{className:className('user-status',{'online':isOnline})})),/*#__PURE__*/React.createElement(\"div\",{className:\"chanel-info\"},/*#__PURE__*/React.createElement(\"h4\",null,member.name),/*#__PURE__*/React.createElement(\"p\",null,\"Joined: 2000 years ago\")),/*#__PURE__*/React.createElement(\"div\",{onClick:function onClick(){store.removeMemberFromChannel(activeChannel,member);},className:\"icon-DelUser\"},/*#__PURE__*/React.createElement(IconButton,{style:{color:\"rgb(200, 68, 20)\",fontSize:\"20\"}},/*#__PURE__*/React.createElement(MdDeleteForever,null))));}))),/*#__PURE__*/React.createElement(MainVideo,null)));}}]);return App3;}(Component);export{App3 as default};","map":{"version":3,"sources":["C:/myProJects/Server/weatherapp/src/components/App3.js"],"names":["React","Component","className","Link","OrderedMap","_","chunk","ObjectID","IconButton","CgSoftwareUpload","MdSettings","MdDeleteForever","MdInsertEmoticon","MdMic","moment","UserBar","Dropzone","Picker","SKIN_TONE_MEDIUM_DARK","AudioAnalyser","MainVideo","App3","props","onClickOutSide","e","ref","contains","target","setState","showEmoji","onDrop","files","store","console","log","formData","FormData","append","upLoadfile","sendTyping","activeChannel","getActiveChannel","lastUpdateTime","Date","now","state","isTyping","addTyping","startCheckingTyping","typingInterval","setInterval","stopCheckingTyping","clearInterval","renderChannelTitle","channel","members","getMembersFromChannel","names","forEach","user","name","get","push","title","join","handleOnClick","userId","channelId","addUserToChannel","searchUser","_onCreateChannel","preventDefault","currentUser","getCurrentUser","currentUserId","toString","_id","lastMessage","messages","isNew","created","typing","set","onCreateNewChannel","scrollMessagesToBottom","messagesRef","scrollTop","scrollHeight","handleSubmit","newMessage","trim","length","messageId","message","body","type","me","addMessage","_onResi","height","window","innerHeight","showSearchUser","audio","temp","isShowGetAud","record","navigator","mediaDevices","getUserMedia","video","chunks","recoder","MediaRecorder","start","ondataavailable","data","namefile","File","path","URL","createObjectURL","substring","fileName","file","getTracks","track","stop","maxDisplay","total","size","avatars","map","index","addEventListener","removeEventListener","getMessagesFromChannel","channels","getChannels","usersList","getSearchUsers","onEmojiClick","event","emojiObject","emoji","style","resultSearch","avatar","searchTxt","startSearchUsers","color","setActiveChannelId","renderChannelAvatar","getRootProps","getInputProps","mess","maxWidth","timing","input","keyCode","shiftKey","value","startRecording","stopRecording","member","isOnline","removeMemberFromChannel","fontSize"],"mappings":"i6BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,C,+CAEA,MAAOC,CAAAA,SAAP,KAAsB,YAAtB,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,UAAT,KAA2B,WAA3B,CACA,MAAOC,CAAAA,CAAP,EAAYC,KAAZ,KAAyB,QAAzB,CACA,OAAQC,QAAR,KAAuB,qBAAvB,CACA,OAASC,UAAT,KAA2B,mBAA3B,CACA,OAASC,gBAAT,KAAiC,gBAAjC,CACA,OAASC,UAAT,CAAqBC,eAArB,CAAsCC,gBAAtC,CAAwDC,KAAxD,KAAqE,gBAArE,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CACA,OAASC,OAAT,KAAwB,WAAxB,CACA,MAAOC,CAAAA,QAAP,KAAqB,gBAArB,CACA,MAAOC,CAAAA,MAAP,EAAiBC,qBAAjB,KAA8C,oBAA9C,CACA,MAAOC,CAAAA,aAAP,KAA0B,yBAA1B,CACA,OAAQC,SAAR,KAAwB,aAAxB,CACA;GAIqBC,CAAAA,I,4FACjB,cAAYC,KAAZ,CAAkB,sCACd,uBAAMA,KAAN,EADc,MAiEdC,cAjEc,CAiEG,SAACC,CAAD,CAAO,CACpB,GAAG,MAAKC,GAAL,EAAY,CAAC,MAAKA,GAAL,CAASC,QAAT,CAAkBF,CAAC,CAACG,MAApB,CAAhB,CAA4C,CACxC;AACA,MAAKC,QAAL,CAAc,CACVC,SAAS,CAAE,KADD,CAAd,EAGH,CACJ,CAxEa,OA0EdC,MA1Ec,CA0EL,SAACC,KAAD,CAAW,IACTC,CAAAA,KADS,CACA,MAAKV,KADL,CACTU,KADS,CAEhBC,OAAO,CAACC,GAAR,CAAY,YAAZ,CAAyBH,KAAzB,EACA,GAAII,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAf,CACAD,QAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBN,KAAK,CAAC,CAAD,CAA7B,EACAC,KAAK,CAACM,UAAN,CAAiBH,QAAjB,EACAF,OAAO,CAACC,GAAR,CAAY,eAAZ,CAA4BC,QAA5B,EACH,CAjFa,OAwFdI,UAxFc,CAwFD,UAAK,IACNP,CAAAA,KADM,CACI,MAAKV,KADT,CACNU,KADM,CAEd,GAAMQ,CAAAA,aAAa,CAAGR,KAAK,CAACS,gBAAN,EAAtB,CACA,MAAKC,cAAL,CAAsBC,IAAI,CAACC,GAAL,EAAtB,CACA,GAAG,CAAC,MAAKC,KAAL,CAAWC,QAAf,CAAwB,CACpB,MAAKlB,QAAL,CAAc,CAACkB,QAAQ,CAAC,IAAV,CAAd,EACAd,KAAK,CAACe,SAAN,CAAgBP,aAAhB,CAA+B,IAA/B,EACA,MAAKQ,mBAAL,GAEH,CACJ,CAlGa,OAwGdA,mBAxGc,CAwGQ,UAAI,CACtBf,OAAO,CAACC,GAAR,CAAY,QAAZ,EACA,MAAKe,cAAL,CAAsBC,WAAW,CAAC,UAAI,CAClC,GAAIP,IAAI,CAACC,GAAL,GAAa,MAAKF,cAAnB,CAAqC,GAAxC,CAA4C,CACxC,MAAKd,QAAL,CAAc,CAACkB,QAAQ,CAAC,KAAV,CAAd,EACA,MAAKK,kBAAL,GACH,CACJ,CALgC,CAK9B,GAL8B,CAAjC,CAMH,CAhHa,OAqHdA,kBArHc,CAqHO,UAAI,IACbnB,CAAAA,KADa,CACH,MAAKV,KADF,CACbU,KADa,CAErB,GAAMQ,CAAAA,aAAa,CAAGR,KAAK,CAACS,gBAAN,EAAtB,CACAR,OAAO,CAACC,GAAR,CAAY,aAAZ,EACA,GAAG,MAAKe,cAAR,CAAuB,CACnBG,aAAa,CAAC,MAAKH,cAAN,CAAb,CACAjB,KAAK,CAACe,SAAN,CAAgBP,aAAhB,CAA+B,KAA/B,EACJ;AACC,CACJ,CA9Ha,OAoJlBa,kBApJkB,CAoJG,UAAoB,IAAnBC,CAAAA,OAAmB,2DAAT,IAAS,IAC7BtB,CAAAA,KAD6B,CACnB,MAAKV,KADc,CAC7BU,KAD6B,CAErC,GAAMuB,CAAAA,OAAO,CAAGvB,KAAK,CAACwB,qBAAN,CAA4BF,OAA5B,CAAhB,CACC,GAAMG,CAAAA,KAAK,CAAG,EAAd,CAEAF,OAAO,CAACG,OAAR,CAAgB,SAACC,IAAD,CAAU,CACtB,GAAMC,CAAAA,IAAI,CAAGvD,CAAC,CAACwD,GAAF,CAAMF,IAAN,CAAY,MAAZ,CAAb,CACAF,KAAK,CAACK,IAAN,CAAWF,IAAX,EACH,CAHD,EAIA,GAAIG,CAAAA,KAAK,CAAG1D,CAAC,CAAC2D,IAAF,CAAOP,KAAP,CAAc,IAAd,CAAZ,CACA,GAAG,CAACM,KAAD,EAAU1D,CAAC,CAACwD,GAAF,CAAMP,OAAN,CAAe,OAAf,CAAb,CAAqC,CACjCS,KAAK,CAAG,SAAR,CACH,CACF,mBAAO,8BAAKA,KAAL,CAAP,CACH,CAlKiB,OAoKlBE,aApKkB,CAoKF,SAACN,IAAD,CAAU,IAEd3B,CAAAA,KAFc,CAEL,MAAKV,KAFA,CAEdU,KAFc,CAGtB,GAAMkC,CAAAA,MAAM,CAAG7D,CAAC,CAACwD,GAAF,CAAMF,IAAN,CAAY,KAAZ,CAAf,CACA,GAAMQ,CAAAA,SAAS,CAAG9D,CAAC,CAACwD,GAAF,CAAO7B,KAAK,CAACS,gBAAN,EAAP,CAAgC,KAAhC,CAAlB,CACAT,KAAK,CAACoC,gBAAN,CAAuBD,SAAvB,CAAkCD,MAAlC,EACA,MAAKtC,QAAL,CAAc,CACVyC,UAAU,CAAE,EADF,CAAd,EAGH,CA7KiB,OA8KlBC,gBA9KkB,CA8KC,SAAC9C,CAAD,CAAO,CACtBA,CAAC,CAAC+C,cAAF,GADsB,GAEdvC,CAAAA,KAFc,CAEL,MAAKV,KAFA,CAEdU,KAFc,CAGtB,GAAMwC,CAAAA,WAAW,CAAGxC,KAAK,CAACyC,cAAN,EAApB,CACA,GAAMC,CAAAA,aAAa,CAAGrE,CAAC,CAACwD,GAAF,CAAMW,WAAN,CAAmB,KAAnB,CAAtB,CACA,GAAML,CAAAA,SAAS,CAAG,GAAI5D,CAAAA,QAAJ,GAAeoE,QAAf,EAAlB,CACA,GAAMrB,CAAAA,OAAO,CAAG,CACZsB,GAAG,CAAET,SADO,CAEZJ,KAAK,CAAE,EAFK,CAGZc,WAAW,CAAE,cAHD,CAIZtB,OAAO,CAAE,GAAInD,CAAAA,UAAJ,EAJG,CAKZ0E,QAAQ,CAAE,GAAI1E,CAAAA,UAAJ,EALE,CAMZ2E,KAAK,CAAE,IANK,CAOZb,MAAM,CAAEQ,aAPI,CAQZM,OAAO,CAAE,GAAIrC,CAAAA,IAAJ,EARG,CASZsC,MAAM,CAAE,KATI,CAAhB,CAWA3B,OAAO,CAACC,OAAR,CAAkBD,OAAO,CAACC,OAAR,CAAgB2B,GAAhB,CAAoBR,aAApB,CAAmC,IAAnC,CAAlB,CACA1C,KAAK,CAACmD,kBAAN,CAAyB7B,OAAzB,EACH,CAjMiB,OAkMlB8B,sBAlMkB,CAkMO,UAAM,CAC3B,GAAG,MAAKC,WAAR,CAAoB,CAChB,MAAKA,WAAL,CAAiBC,SAAjB,CAA6B,MAAKD,WAAL,CAAiBE,YAA9C,CACH,CACJ,CAtMiB,OAqOlBC,YArOkB,CAqOH,SAAChE,CAAD,CAAO,IAEViE,CAAAA,UAFU,CAEK,MAAK5C,KAFV,CAEV4C,UAFU,IAGVzD,CAAAA,KAHU,CAGA,MAAKV,KAHL,CAGVU,KAHU,CAIlBR,CAAC,CAAC+C,cAAF,GAEA,GAAGlE,CAAC,CAACqF,IAAF,CAAOD,UAAP,EAAmBE,MAAtB,CAA6B,CACzB,GAAMC,CAAAA,SAAS,CAAG,GAAIrF,CAAAA,QAAJ,GAAeoE,QAAf,EAAlB,CACA,GAAMrB,CAAAA,OAAO,CAAGtB,KAAK,CAACS,gBAAN,EAAhB,CACA,GAAM0B,CAAAA,SAAS,CAAG9D,CAAC,CAACwD,GAAF,CAAMP,OAAN,CAAgB,KAAhB,CAAuB,IAAvB,CAAlB,CACA,GAAMkB,CAAAA,WAAW,CAAGxC,KAAK,CAACyC,cAAN,EAApB,CACA,GAAMoB,CAAAA,OAAO,CAAG,CACZjB,GAAG,CAAEgB,SADO,CAEZzB,SAAS,CAAEA,SAFC,CAGZ2B,IAAI,CAAGL,UAHK,CAIZvB,MAAM,CAAE7D,CAAC,CAACwD,GAAF,CAAMW,WAAN,CAAmB,KAAnB,CAJI,CAKZuB,IAAI,CAAC,MALO,CAMZC,EAAE,CAAE,IANQ,CAAhB,CASAhE,KAAK,CAACiE,UAAN,CAAiBL,SAAjB,CAA4BC,OAA5B,EACA,MAAKjE,QAAL,CAAc,CAAC6D,UAAU,CAAE,EAAb,CAAd,EACH,CACD,MAAK7D,QAAL,CAAc,CACV6D,UAAU,CAAE,EADF,CAEV5D,SAAS,CAAE,KAFD,CAAd,EAKH,CAjQiB,OAkQlBqE,OAlQkB,CAkQR,UAAM,CACZ,MAAKtE,QAAL,CAAc,CAACuE,MAAM,CAAEC,MAAM,CAACC,WAAhB,CAAd,EACH,CApQiB,CAEd,MAAKxD,KAAL,CAAa,CACTsD,MAAM,CAAEC,MAAM,CAACC,WADN,CAETZ,UAAU,CAAE,EAFH,CAGTpB,UAAU,CAAE,EAHH,CAITiC,cAAc,CAAG,KAJR,CAKTxD,QAAQ,CAAE,KALD,CAMTjB,SAAS,CAAE,KANF,CAOT0E,KAAK,CAAE,IAPE,CAQTC,IAAI,CAAG,IARE,CASTC,YAAY,CAAE,KATL,CAUTC,MAAM,CAAE,KAVC,CAAb,CAFc,aAejB,C,wSAIU1E,K,CAAS,KAAKV,K,CAAdU,K,uBACa2E,CAAAA,SAAS,CAACC,YAAV,CAAuBC,YAAvB,CAAoC,CACtDN,KAAK,CAAE,IAD+C,CAEtDO,KAAK,CAAE,KAF+C,CAApC,C,QAAdP,K,eAIN,KAAK3E,QAAL,CAAc,CAAE2E,KAAK,CAALA,KAAF,CAAd,EACA,KAAK3E,QAAL,CAAc,CAAC6E,YAAY,CAAE,IAAf,CAAd,EACA,KAAK7E,QAAL,CAAc,CAAE8E,MAAM,CAAE,IAAV,CAAd,EAEMK,M,CAAS,E,CACTC,O,CAAU,GAAIC,CAAAA,aAAJ,CAAkBV,KAAlB,C,CAChBS,OAAO,CAACE,KAAR,GAEAF,OAAO,CAACG,eAAR,CAA0B,SAAS3F,CAAT,CAAY,CAClCuF,MAAM,CAACjD,IAAP,CAAYtC,CAAC,CAAC4F,IAAd,EACA,GAAMC,CAAAA,QAAQ,CAAG,GAAI9G,CAAAA,QAAJ,GAAeoE,QAAf,EAAjB,CACA,GAAI5C,CAAAA,KAAK,CAAG,GAAIuF,CAAAA,IAAJ,CAASP,MAAT,WAAoBM,QAAQ,CAAC,MAA7B,EAAwC,CAACtB,IAAI,CAAE,WAAP,CAAxC,CAAZ,CACA,GAAMwB,CAAAA,IAAI,CAAGC,GAAG,CAACC,eAAJ,CAAoB1F,KAApB,CAAb,CACAA,KAAK,CAACwF,IAAN,WAAgBlH,CAAC,CAACsE,QAAF,CAAW4C,IAAI,CAACG,SAAL,CAAe,EAAf,EAAmB,MAA9B,CAAhB,EACA,GAAM9D,CAAAA,IAAI,CAAGvD,CAAC,CAACsE,QAAF,CAAW5C,KAAK,CAACwF,IAAjB,CAAb,CACAxF,KAAK,CAAC4F,QAAN,WAAoB/D,IAApB,EACA;AACA,GAAIgE,CAAAA,IAAI,CAAG,EAAX,CACAA,IAAI,CAAC9D,IAAL,CAAU/B,KAAV,EACA;AACA,GAAMI,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAjB,CACAD,QAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBuF,IAAI,CAAC,CAAD,CAA5B,EACA;AACH,CAfD,C,gKAkBJ;qDACgB,CACb,GAAG,KAAK/E,KAAL,CAAW0D,KAAX,GAAqB,IAAxB,CAA6B,CAC5B,KAAK1D,KAAL,CAAW0D,KAAX,CAAiBsB,SAAjB,GAA6BnE,OAA7B,CAAqC,SAAAoE,KAAK,QAAIA,CAAAA,KAAK,CAACC,IAAN,EAAJ,EAA1C,EACA,KAAKnG,QAAL,CAAc,CAAE2E,KAAK,CAAE,IAAT,CAAd,EACA,KAAK3E,QAAL,CAAc,CAAE8E,MAAM,CAAE,KAAV,CAAd,EACA,CAJD,IAIO,CACHzE,OAAO,CAACC,GAAR,CAAY,wBAAZ,EACH,CAGH,C,mEAuB0B,CACnB,KAAKiB,kBAAL,GACH,C,gEA2CeG,O,CAAQ,IACjBtB,CAAAA,KADiB,CACR,KAAKV,KADG,CACjBU,KADiB,CAGxB,GAAMuB,CAAAA,OAAO,CAAGvB,KAAK,CAACwB,qBAAN,CAA4BF,OAA5B,CAAhB,CAEA,GAAM0E,CAAAA,UAAU,CAAG,CAAnB,CACA,GAAMC,CAAAA,KAAK,CAAG1E,OAAO,CAAC2E,IAAR,CAAeF,UAAf,CAA4BA,UAA5B,CAAyCzE,OAAO,CAAC2E,IAA/D,CAEA,GAAMC,CAAAA,OAAO,CAAG5E,OAAO,CAAC6E,GAAR,CAAY,SAACzE,IAAD,CAAO0E,KAAP,CAAiB,CAIzC,MAAOA,CAAAA,KAAK,CAAGL,UAAR,cAAsB,2BAAK,GAAG,CAAEK,KAAV,CAAiB,GAAG,CAAEhI,CAAC,CAACwD,GAAF,CAAMF,IAAN,CAAY,QAAZ,CAAtB,CAA6C,GAAG,CAAEtD,CAAC,CAACwD,GAAF,CAAMF,IAAN,CAAY,MAAZ,CAAlD,EAAtB,CAAkG,IAAzG,CAEH,CANe,CAAhB,CASA,mBAAO,2BAAK,SAAS,CAAEzD,SAAS,CAAC,iBAAD,2BAAuC+H,KAAvC,EAAzB,EAA2EE,OAA3E,CAAP,CACH,C,4BAkHD;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;mCACoB,CAChB,KAAK/C,sBAAL,GACA;AAEH,C,6DACkB,CACfgB,MAAM,CAACkC,gBAAP,CAAwB,QAAxB,CAAkC,KAAKpC,OAAvC,EACAE,MAAM,CAACkC,gBAAP,CAAwB,WAAxB,CAAqC,KAAK/G,cAA1C,EACA;AACA;AACH,C,mEACqB,CAClB6E,MAAM,CAACmC,mBAAP,CAA2B,QAA3B,CAAqC,KAAKrC,OAA1C,EACAE,MAAM,CAACmC,mBAAP,CAA2B,WAA3B,CAAwC,KAAKhH,cAA7C,EACA;AACH,C,uCAEQ,iCAEkD,KAAKsB,KAFvD,CAEGsD,MAFH,aAEGA,MAFH,CAEWV,UAFX,aAEWA,UAFX,CAEuB5D,SAFvB,aAEuBA,SAFvB,CAEkC4E,YAFlC,aAEkCA,YAFlC,IAGGzE,CAAAA,KAHH,CAGa,KAAKV,KAHlB,CAGGU,KAHH,CAIL;AACA,GAAMQ,CAAAA,aAAa,CAAGR,KAAK,CAACS,gBAAN,EAAtB,CACA,GAAMqC,CAAAA,QAAQ,CAAG9C,KAAK,CAACwG,sBAAN,CAA6BhG,aAA7B,CAAjB,CACA,GAAMe,CAAAA,OAAO,CAAGvB,KAAK,CAACwB,qBAAN,CAA4BhB,aAA5B,CAAhB,CACA,GAAMiG,CAAAA,QAAQ,CAAGzG,KAAK,CAAC0G,WAAN,EAAjB,CACA,GAAMC,CAAAA,SAAS,CAAG3G,KAAK,CAAC4G,cAAN,EAAlB,CACA,GAAM5C,CAAAA,EAAE,CAAGhE,KAAK,CAACyC,cAAN,EAAX,CAEA,GAAMoE,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,KAAD,CAAQC,WAAR,CAAwB,CACzC,MAAI,CAACnH,QAAL,CAAc,CAAC6D,UAAU,WAAIsD,WAAW,CAACC,KAAhB,CAAX,CAAd,EACA/G,OAAO,CAACC,GAAR,WAAe6G,WAAW,CAACC,KAA3B,GACH,CAHD,CAMA,GAAMC,CAAAA,KAAK,CAAG,CACV9C,MAAM,CAAEA,MADE,CAAd,CAGA,GAAM+C,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CAEnB,mBACI,2BAAK,SAAS,CAAC,aAAf,eACI,2BAAK,SAAS,CAAC,WAAf,EACCP,SAAS,CAACP,GAAV,CAAc,SAACzE,IAAD,CAAO0E,KAAP,CAAgB,CAC3B,mBAAO,2BAAK,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACpE,aAAL,CAAmBN,IAAnB,CAAN,EAAd,CAA8C,GAAG,CAAE0E,KAAnD,CAA0D,SAAS,CAAC,MAApE,eACP,2BAAK,GAAG,CAAE1E,IAAI,CAACwF,MAAf,CAAuB,GAAG,CAAExF,IAAI,CAACC,IAAjC,EADO,cAEP,gCAAOD,IAAI,CAACC,IAAZ,CAFO,CAAP,CAIH,CALA,CADD,CADJ,CADJ,CAaP,CAfD,CAgBA,mBACI,2BAAK,KAAK,CAAEqF,KAAZ,CAAmB,SAAS,CAAC,MAA7B,eAEG,2BAAK,SAAS,CAAC,aAAf,eACK,2BAAK,SAAS,CAAC,aAAf,eACI,2BAAK,SAAS,CAAC,QAAf,eACI,oBAAC,IAAD,EAAM,OAAO,CAAE,iBAACzH,CAAD,QAAO,CAAA,MAAI,CAAC8C,gBAAL,CAAsB9C,CAAtB,CAAP,EAAf,CAAgD,SAAS,CAAC,aAA1D,WADJ,CADJ,CADL,CAMMnB,CAAC,CAACwD,GAAF,CAAMrB,aAAN,CAAqB,OAArB,eAAgC,2BAAK,SAAS,CAAC,SAAf,eAC7B,4BAAM,SAAS,CAAC,MAAhB,eACI,gCACA,IAAI,CAAC,MADL,CAEA,KAAK,CAAI,KAAKK,KAAL,CAAWwB,UAFpB,CAGA,WAAW,CAAC,mBAHZ,CAIA,QAAQ,CAAI,kBAAC7C,CAAD,CAAO,CACf,GAAM4H,CAAAA,SAAS,CAAG/I,CAAC,CAACwD,GAAF,CAAMrC,CAAN,CAAS,cAAT,CAAlB,CACA,MAAI,CAACI,QAAL,CAAc,CACVyC,UAAU,CAAE+E,SADF,CAAd,CAEG,UAAM,CACLpH,KAAK,CAACqH,gBAAN,CAAuBD,SAAvB,EACH,CAJD,EAMH,CAZD,EADJ,CAD6B,CAiB5BF,YAAY,EAjBgB,CAAhC,CAkBY,IAxBlB,cA0BK,2BAAK,SAAS,CAAC,YAAf,EACM,KAAK7F,kBAAL,CAAwBb,aAAxB,CADN,CA1BL,cA6BK,2BAAK,SAAS,CAAC,cAAf,eACI,oBAAC,OAAD,EAAS,KAAK,CAAKR,KAAnB,EADJ,cAEI,2BAAK,SAAS,CAAC,gBAAf,eACA,oBAAC,UAAD,EAAa,KAAK,CAAE,CAAEsH,KAAK,CAAE,oBAAT,CAApB,eACI,oBAAC,UAAD,MADJ,CADA,CAFJ,CA7BL,CAFH,cAwCI,2BAAK,SAAS,CAAC,WAAf,eACI,2BAAK,SAAS,CAAC,cAAf,eACI,2BAAK,SAAS,CAAC,SAAf,EACKb,QAAQ,CAACL,GAAT,CAAa,SAAC9E,OAAD,CAAU+E,KAAV,CAAmB,CAC7B,mBACI,2BAAK,OAAO,CAAG,iBAACA,KAAD,CAAW,CACtBrG,KAAK,CAACuH,kBAAN,CAAyBjG,OAAO,CAACsB,GAAjC,EACH,CAFD,CAEG,GAAG,CAAEtB,OAAO,CAACsB,GAFhB,CAEqB,SAAS,CAAE1E,SAAS,CAAC,QAAD,CAAW,CAAC,SAAWG,CAAC,CAACwD,GAAF,CAAMrB,aAAN,CAAqB,KAArB,IAAgCnC,CAAC,CAACwD,GAAF,CAAMP,OAAN,CAAe,KAAf,CAAsB,IAAtB,CAA5C,CAAX,CAFzC,eAGI,2BAAK,SAAS,CAAC,UAAf,EACK,MAAI,CAACkG,mBAAL,CAAyBlG,OAAzB,CADL,CAHJ,cAMI,2BAAK,SAAS,CAAEpD,SAAS,CAAC,aAAD,CAAe,CAAC,SAAUG,CAAC,CAACwD,GAAF,CAAMP,OAAN,CAAe,QAAf,CAAyB,IAAzB,CAAX,CAAf,CAAzB,EACK,MAAI,CAACD,kBAAL,CAAwBC,OAAxB,CADL,CANJ,CADJ,CAaH,CAdA,CADL,CADJ,CADJ,cAqBI,2BAAK,SAAS,CAAC,cAAf,eACI,2BAAK,SAAS,CAAC,UAAf,eACI,oBAAC,QAAD,EAAU,MAAM,CAAE,KAAKxB,MAAvB,EACK,kBAAE2H,CAAAA,YAAF,MAAEA,YAAF,CAAgBC,aAAhB,MAAgBA,aAAhB,oBACG,gDACA,0BAASD,YAAY,EAArB,cACI,4BAAWC,aAAa,EAAxB,CADJ,cAEI,oBAAC,UAAD,mBACI,oBAAC,gBAAD,MADJ,CAFJ,CADA,CADH,EADL,CADJ,CADJ,cAeI,2BAAK,GAAG,CAAE,aAACjI,KAAD,QAAS,CAAA,MAAI,CAAC4D,WAAL,CAAmB5D,KAA5B,EAAV,CAA2C,SAAS,CAAC,UAArD,EAEQqD,QAAQ,CAACsD,GAAT,CAAa,SAACuB,IAAD,CAAOtB,KAAP,CAAiB,CAC1B,GAAM1E,CAAAA,IAAI,CAAGtD,CAAC,CAACwD,GAAF,CAAM8F,IAAN,CAAY,MAAZ,CAAb,CACA,mBACA,2BAAK,GAAG,CAAEtB,KAAV,CAAiB,SAAS,WAAKsB,IAAI,CAAC3D,EAAL,CAAU,YAAV,CAAyB,SAA9B,CAA1B,eAEA,2BAAK,GAAG,CAAE3F,CAAC,CAACwD,GAAF,CAAMF,IAAN,CAAY,QAAZ,CAAV,CAAiC,GAAG,CAAC,UAArC,CAAgD,SAAS,CAAC,UAA1D,EAFA,cAIA,2BAAK,SAAS,CAAC,cAAf,eAEI,2BAAK,SAAS,CAAC,UAAf,YAA8BgG,IAAI,CAAC3D,EAAL,CAAU,KAAV,CAAkB3F,CAAC,CAACwD,GAAF,CAAM8F,IAAN,CAAY,WAAZ,CAAhD,WAFJ,cAII,yBAAG,SAAS,CAAC,cAAb,EACU,UAAGA,IAAI,CAAC7D,IAAR,EAAe4B,SAAf,CAAyB,CAAzB,CAA4B,CAA5B,IAAmC,UAAnC,CACF;AAEA,UAAIiC,IAAI,CAAC7D,IAAT,EAAiB4B,SAAjB,CAA2B,UAAIiC,IAAI,CAAC7D,IAAT,EAAiBH,MAAjB,CAA0B,CAArD,CAAwD,UAAIgE,IAAI,CAAC7D,IAAT,EAAiBH,MAAzE,IAAqF,KAArF,cACI,6BACI,KAAK,CAAE,CAAEiE,QAAQ,CAAE,OAAZ,CADX,CAEI,GAAG,iCAA2BD,IAAI,CAAC7D,IAAhC,CAFP,CAE+C,GAAG,CAAC,OAFnD,CAGI,IAAI,CAAC,WAHT,CAGqB,QAAQ,KAH7B,EADJ,cAOI,2BACI,KAAK,CAAE,CAAE8D,QAAQ,CAAE,OAAZ,CADX,CAEI,GAAG,iCAA2BD,IAAI,CAAC7D,IAAhC,CAFP,CAGI,GAAG,CAAC,KAHR,EAVF,cAgBN,6BAAI6D,IAAI,CAAC7D,IAAT,CAjBJ,cAoBI,yBAAG,SAAS,CAAC,QAAb,EAAuB6D,IAAI,CAACE,MAA5B,CApBJ,CAJJ,CAJA,CADA,CAoCH,CAtCD,CAFR,CA0CShI,SAAS,cAAG,2BAAK,SAAS,CAAC,OAAf,CAAuB,GAAG,CAAI,aAACJ,KAAD,QAAS,CAAA,MAAI,CAACA,GAAL,CAAWA,KAApB,EAA9B,eACT,oBAAC,MAAD,EAAS,YAAY,CAAEoH,YAAvB,CAAqC,QAAQ,CAAE3H,qBAA/C,EADS,CAAH,CAED,IA5CjB,CAfJ,CAgEIuF,YAAY,cAAG,2BAAK,SAAS,CAAC,QAAf,eACP,+BACC,KAAK5D,KAAL,CAAW0D,KAAX,cAAmB,oBAAC,aAAD,EAAe,KAAK,CAAE,KAAK1D,KAAL,CAAW0D,KAAjC,EAAnB,CAAgE,IADjE,CADO,CAAH,CAIH,IApEb,CAuEKlG,CAAC,CAACwD,GAAF,CAAMrB,aAAN,CAAqB,QAArB,GAAkCnC,CAAC,CAACwD,GAAF,CAAMrB,aAAN,CAAqB,QAArB,IAAmCnC,CAAC,CAACwD,GAAF,CAAMmC,EAAN,CAAU,KAAV,CAArE,cAAwF,2BAAM,QAAQ,CAAKP,UAAU,CAACE,MAAX,CAAoB,CAAvC,CAA2C,SAAS,CAAC,eAArD,gBAAxF,CAAiL,IAvEtL,CAwEQpC,OAAO,CAAC2E,IAAR,CAAe,CAAf,cAAmB,2BAAK,SAAS,CAAC,eAAf,eACnB,4BACI,QAAQ,CAAI,KAAK1C,YADrB,CAEI,QAAQ,CAAKC,UAAU,CAACE,MAAX,CAAoB,CAFrC,CAGI,SAAS,CAAC,cAHd,eAII,oBAAC,UAAD,EAAY,OAAO,CAAI,kBAAM,CAAC,MAAI,CAAC/D,QAAL,CAAc,CAACC,SAAS,CAAE,CAACA,SAAb,CAAd,EAAuC,CAArE,eACI,oBAAC,gBAAD,MADJ,CAJJ,cAOI,gCACI,EAAE,CAAG,SADT,CAEI,GAAG,CAAE,aAACiI,KAAD,QAAU,CAAA,MAAI,CAACA,KAAL,CAAaA,KAAvB,EAFT,CAGI,IAAI,CAAG,MAHX,CAII,SAAS,CAAG,cAJhB,CAKI,KAAK,CAAKrE,UALd,CAMI,YAAY,CAAI,KANpB,CAOI,WAAW,CAAG,4BAPlB,CAQI,OAAO,CAAK,iBAACjE,CAAD,CAAO,CACf,CAAE,GAAGA,CAAC,CAACuI,OAAF,GAAc,EAAd,EAAoB,CAACvI,CAAC,CAACwI,QAA1B,CACE,CAAE,MAAI,CAACxE,YAAL,CAAkBhE,CAAlB,EAAuB,CAAC,CAC9B,CAAE,GAAIA,CAAC,CAACuI,OAAF,GAAc,EAAlB,CAAsB,CAAE,MAAI,CAACxH,UAAL,GAAmB,CAAC,CAC7C,CAZT,CAcI,QAAQ,CACP,wBAAY,IAAVZ,CAAAA,MAAU,OAAVA,MAAU,CACX,MAAI,CAACC,QAAL,CAAc,CAAC6D,UAAU,CAAC9D,MAAM,CAACsI,KAAnB,CAAd,EACA,CAjBN,EAPJ,cA8BY,oBAAC,UAAD,mBACA,oBAAC,KAAD,EAAO,WAAW,CAAG,sBAAM,CAAC,MAAI,CAACC,cAAL,GAAsB,CAAlD,CAAoD,SAAS,CAAG,oBAAM,CAAC,MAAI,CAACC,aAAL,GAAqB,CAA5F,EADA,CA9BZ,cAkCI,8BACI,QAAQ,CAAK1E,UAAU,CAACE,MAAX,CAAoB,CADrC,CAEI,IAAI,CAAG,QAFX,CAGI,SAAS,CAAG,MAHhB,CAII,OAAO,CAAK,KAAKH,YAJrB,WAlCJ,CADmB,CAAnB,CA4CA,IApHR,CArBJ,cA6II,2BAAK,SAAS,CAAC,eAAf,eACI,2BAAK,SAAS,CAAC,aAAf,YADJ,cAEI,2BAAK,SAAS,CAAC,SAAf,EACMjC,OAAO,CAAC6E,GAAR,CAAY,SAACgC,MAAD,CAAS/B,KAAT,CAAmB,CAE7B,GAAMgC,CAAAA,QAAQ,CAAGhK,CAAC,CAACwD,GAAF,CAAMuG,MAAN,CAAc,QAAd,CAAwB,KAAxB,CAAjB,CACA,mBACI,2BAAK,GAAG,CAAI/B,KAAZ,CAAoB,SAAS,CAAC,QAA9B,eAEI,2BAAK,SAAS,CAAC,kBAAf,eACI,2BAAK,GAAG,CAAEhI,CAAC,CAACwD,GAAF,CAAMuG,MAAN,CAAc,QAAd,CAAV,CAAmC,GAAG,CAAC,UAAvC,EADJ,cAEI,4BAAM,SAAS,CAAElK,SAAS,CAAC,aAAD,CAAgB,CAAC,SAAUmK,QAAX,CAAhB,CAA1B,EAFJ,CAFJ,cAMI,2BAAK,SAAS,CAAC,aAAf,eACI,8BAAMD,MAAM,CAACxG,IAAb,CADJ,cAEI,sDAFJ,CANJ,cAUI,2BAAK,OAAO,CAAI,kBAAM,CAClB5B,KAAK,CAACsI,uBAAN,CAA8B9H,aAA9B,CAA6C4H,MAA7C,EACH,CAFD,CAGC,SAAS,CAAC,cAHX,eAIA,oBAAC,UAAD,EAAa,KAAK,CAAE,CAAEd,KAAK,CAAE,kBAAT,CAA6BiB,QAAQ,CAAE,IAAvC,CAApB,eACI,oBAAC,eAAD,MADJ,CAJA,CAVJ,CADJ,CAsBH,CAzBC,CADN,CAFJ,CA7IJ,cA8KI,oBAAC,SAAD,MA9KJ,CAxCJ,CADJ,CA4NH,C,kBAjkB6BtK,S,SAAboB,I","sourcesContent":["import React, { Component } from 'react'\r\nimport defaultImg from '../images/Logosvg3.svg';\r\nimport className from 'classnames';\r\nimport { Link } from 'react-router-dom';\r\nimport { OrderedMap } from 'immutable';\r\nimport _, { chunk } from 'lodash';\r\nimport {ObjectID} from \"../helpers/objectid\";\r\nimport { IconButton } from '@material-ui/core';\r\nimport { CgSoftwareUpload } from 'react-icons/cg'\r\nimport { MdSettings, MdDeleteForever, MdInsertEmoticon, MdMic } from 'react-icons/md';\r\nimport moment from 'moment';\r\nimport { UserBar } from \"./UserBar\";\r\nimport Dropzone from \"react-dropzone\";\r\nimport Picker, { SKIN_TONE_MEDIUM_DARK } from 'emoji-picker-react';\r\nimport AudioAnalyser from './library/AudioAnalyser';\r\nimport {MainVideo} from './MainVideo';\r\n// import { ReactMic } from 'react-mic';\r\n\r\n\r\n\r\nexport default class App3 extends Component {\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            height: window.innerHeight,\r\n            newMessage: '',\r\n            searchUser: '',\r\n            showSearchUser : false,\r\n            isTyping: false,\r\n            showEmoji: false,\r\n            audio: null,\r\n            temp : 5000,\r\n            isShowGetAud: false,\r\n            record: false,\r\n        }\r\n\r\n    }\r\n   \r\n   \r\n    async startRecording() {\r\n        const {store} = this.props;\r\n        const audio = await navigator.mediaDevices.getUserMedia({\r\n          audio: true,\r\n          video: false,\r\n        });\r\n        this.setState({ audio });\r\n        this.setState({isShowGetAud: true});\r\n        this.setState({ record: true });\r\n\r\n        const chunks = [];\r\n        const recoder = new MediaRecorder(audio);\r\n        recoder.start();\r\n\r\n        recoder.ondataavailable = function(e) {\r\n            chunks.push(e.data);\r\n            const namefile = new ObjectID().toString();\r\n            let files = new File(chunks, `${namefile+'.mp3'}` , {type: \"audio/wav\"});\r\n            const path = URL.createObjectURL(files);\r\n            files.path = `${_.toString(path.substring(27)+'.mp3')}`;\r\n            const name = _.toString(files.path);\r\n            files.fileName = `${name}`;\r\n            // console.log(\"file goc 1: \", files);\r\n            let file = [];\r\n            file.push(files);\r\n            // console.log(\"File goc\", file);\r\n            const formData = new FormData();\r\n            formData.append('file', file[0] );\r\n            // store.upLoadfile(formData);\r\n        }\r\n    }\r\n        \r\n    //stop\r\n    stopRecording() {\r\n       if(this.state.audio !== null){\r\n        this.state.audio.getTracks().forEach(track => track.stop());\r\n        this.setState({ audio: null });\r\n        this.setState({ record: false }); \r\n       } else {\r\n           console.log(\"Error shortage-lenght!\");\r\n       }\r\n               \r\n        \r\n    }\r\n\r\n\r\n        \r\n        onClickOutSide = (e) => {\r\n            if(this.ref && !this.ref.contains(e.target)){\r\n                // console.log(\"Here click out side login form!\");\r\n                this.setState({\r\n                    showEmoji: false,\r\n                })\r\n            }\r\n        }\r\n\r\n        onDrop = (files) => {\r\n            const {store} = this.props;\r\n            console.log(\"file goc: \",files);\r\n            let formData = new FormData;\r\n            formData.append(\"file\", files[0]);\r\n            store.upLoadfile(formData);\r\n            console.log(\"file format: \",formData);\r\n        }\r\n\r\n\r\n        componentWillUnmount() {\r\n            this.stopCheckingTyping()\r\n        }\r\n\r\n        sendTyping = () =>{\r\n            const { store } = this.props;\r\n            const activeChannel = store.getActiveChannel();\r\n            this.lastUpdateTime = Date.now()\r\n            if(!this.state.isTyping){\r\n                this.setState({isTyping:true});\r\n                store.addTyping(activeChannel, true);\r\n                this.startCheckingTyping();\r\n\r\n            }\r\n        }\r\n\r\n\t/*\r\n\t*\tstartCheckingTyping\r\n\t*\tStart an interval that checks if the user is typing.\r\n\t*/\r\n        startCheckingTyping = ()=>{\r\n            console.log(\"Typing\");\r\n            this.typingInterval = setInterval(()=>{\r\n                if((Date.now() - this.lastUpdateTime) > 350){\r\n                    this.setState({isTyping:false})\r\n                    this.stopCheckingTyping()\r\n                }\r\n            }, 300)\r\n        }\r\n\t/*\r\n\t*\tstopCheckingTyping\r\n\t*\tStart the interval from checking if the user is typing.\r\n\t*/\r\n        stopCheckingTyping = ()=>{\r\n            const { store } = this.props;\r\n            const activeChannel = store.getActiveChannel();\r\n            console.log(\"Stop Typing\");\r\n            if(this.typingInterval){\r\n                clearInterval(this.typingInterval)\r\n                store.addTyping(activeChannel, false);\r\n            // console.log(this.state.isTyping);\r\n            }\r\n        }\r\n\r\n\r\n    renderChannelAvatar(channel){\r\n        const {store} = this.props;\r\n\r\n        const members = store.getMembersFromChannel(channel);\r\n\r\n        const maxDisplay = 4;\r\n        const total = members.size > maxDisplay ? maxDisplay : members.size;\r\n\r\n        const avatars = members.map((user, index) => {\r\n\r\n\r\n\r\n            return index < maxDisplay ?  <img key={index} src={_.get(user, 'avatar')} alt={_.get(user, 'name')} /> : null\r\n\r\n        });\r\n\r\n\r\n        return <div className={className('channel-avatars', `channel-avatars-${total}`)}>{avatars}</div>\r\n    }\r\n    renderChannelTitle = (channel = null) => {\r\n        const { store } = this.props;\r\n        const members = store.getMembersFromChannel(channel);\r\n         const names = [];\r\n\r\n         members.forEach((user) => {\r\n             const name = _.get(user, 'name')\r\n             names.push(name);\r\n         });\r\n         let title = _.join(names, ', ');\r\n         if(!title && _.get(channel, 'isNew')){\r\n             title = 'New Mss';\r\n         }\r\n        return <h4>{title}</h4>\r\n    }\r\n   \r\n    handleOnClick = (user) => {\r\n       \r\n        const { store } =this.props;\r\n        const userId = _.get(user, '_id');\r\n        const channelId = _.get( store.getActiveChannel(),'_id')\r\n        store.addUserToChannel(channelId, userId);\r\n        this.setState({\r\n            searchUser: '',\r\n        })\r\n    }\r\n    _onCreateChannel = (e) => {\r\n        e.preventDefault()\r\n        const { store } =this.props;\r\n        const currentUser = store.getCurrentUser();\r\n        const currentUserId = _.get(currentUser, '_id');\r\n        const channelId = new ObjectID().toString();\r\n        const channel = {\r\n            _id: channelId,\r\n            title: \"\",\r\n            lastMessage: \"Let's a chat\",\r\n            members: new OrderedMap(),\r\n            messages: new OrderedMap(),\r\n            isNew: true,\r\n            userId: currentUserId,\r\n            created: new Date(),\r\n            typing: false,\r\n        };\r\n        channel.members = channel.members.set(currentUserId, true);\r\n        store.onCreateNewChannel(channel);\r\n    }\r\n    scrollMessagesToBottom = () => {\r\n        if(this.messagesRef){\r\n            this.messagesRef.scrollTop = this.messagesRef.scrollHeight;\r\n        }\r\n    }\r\n    // renderMessage(message){\r\n    //     const txt = _.get(message, 'body' , '');\r\n    //     const html = _.split(txt, '\\n').map((m, key) => {\r\n    //         return <p key={key} dangerouslySetInnerHTML={{ __html: m }}></p>\r\n    //     })\r\n\r\n    //         message.substring(0, 8) === \"uploads/\" ?\r\n    //             // this will be either video or image \r\n\r\n    //             message.substring(message.length - 3, message.length) === 'mp4' ?\r\n    //                 <video\r\n    //                     style={{ maxWidth: '200px' }}\r\n    //                     src={`http://localhost:3000/${message.body}`} alt=\"video\"\r\n    //                     type=\"video/mp4\" controls\r\n    //                 />\r\n    //                 :\r\n    //                 <img\r\n    //                     style={{ maxWidth: '200px' }}\r\n    //                     src={`http://localhost:5000/${message.body}`}\r\n    //                     alt=\"img\"\r\n    //                 />\r\n    //         :\r\n    //         <p>\r\n    //             {message.body}\r\n    //         </p>\r\n\r\n        \r\n        \r\n    //     return html;\r\n    // }\r\n    handleSubmit = (e) => {\r\n\r\n        const { newMessage } = this.state;\r\n        const { store } = this.props;\r\n        e.preventDefault();\r\n\r\n        if(_.trim(newMessage).length){\r\n            const messageId = new ObjectID().toString();\r\n            const channel = store.getActiveChannel();\r\n            const channelId = _.get(channel , '_id', null);\r\n            const currentUser = store.getCurrentUser();\r\n            const message = {\r\n                _id: messageId,\r\n                channelId: channelId,\r\n                body : newMessage,\r\n                userId: _.get(currentUser, '_id'),\r\n                type:\"text\",\r\n                me: true,\r\n            };\r\n            \r\n            store.addMessage(messageId, message);\r\n            this.setState({newMessage: \"\"});\r\n        }\r\n        this.setState({\r\n            newMessage: \"\",\r\n            showEmoji: false\r\n        });\r\n\r\n    };\r\n    _onResi = () => {\r\n        this.setState({height: window.innerHeight});\r\n    }\r\n    // addTestMessages = () => {\r\n    //     const {store} = this.props\r\n\r\n      \r\n    //     for(let i = 0; i < 20; i++){\r\n    //         let isMe = false;\r\n    //         if(i % 2 === 0) {\r\n    //             isMe = true;\r\n    //         }\r\n    //         const newMsg = {\r\n    //             _id: `${i}`,\r\n    //             author: `Author: ${i}`,\r\n    //             body: `The body of message ${i}`,\r\n    //             avatar: defaultImg,\r\n    //             me: isMe,\r\n    //             timing: '0:00'\r\n    //         }\r\n    //         store.addMessage(i, newMsg);\r\n\r\n    //     }\r\n\r\n    //     for (let c = 0; c<10; c++){\r\n    //         const newChannel ={\r\n    //             _id: `${c}`,\r\n    //             title: `Channel title ${c}`,\r\n    //             lastMessage: `Hey there is.. ${c}`,\r\n    //             members: new OrderedMap({\r\n    //                 '1': true,\r\n    //                 '2': true,\r\n    //             }),\r\n    //             messages: new OrderedMap(),\r\n    //             created: new Date(),\r\n    //         }\r\n    //         const moreMsgId =`${c + 1}`;\r\n    //         const msgId = `${c}`;\r\n    //         newChannel.messages = newChannel.messages.set(msgId, true);\r\n    //         newChannel.messages = newChannel.messages.set(moreMsgId, true);\r\n    //         store.addChannel(c, newChannel);\r\n    //     }\r\n\r\n    // }\r\n    componentDidUpdate(){\r\n        this.scrollMessagesToBottom();\r\n        // console.log(\"CDidUpdate\");\r\n       \r\n    }\r\n    componentDidMount(){\r\n        window.addEventListener('resize', this._onResi);\r\n        window.addEventListener('mousedown', this.onClickOutSide);\r\n        // this.addTestMessages();\r\n        // console.log(\"CDidMount\");\r\n    }\r\n    componentWillUnmount(){\r\n        window.removeEventListener('resize', this._onResi);\r\n        window.removeEventListener('mousedown', this.onClickOutSide);\r\n        // console.log(\"CWillUnMount\");\r\n    }\r\n    \r\n    render() {\r\n\r\n        const { height, newMessage, showEmoji, isShowGetAud} = this.state;\r\n        const { store } = this.props;\r\n        // const isConnected = store.isConnected();\r\n        const activeChannel = store.getActiveChannel();\r\n        const messages = store.getMessagesFromChannel(activeChannel);\r\n        const members = store.getMembersFromChannel(activeChannel);\r\n        const channels = store.getChannels();\r\n        const usersList = store.getSearchUsers();\r\n        const me = store.getCurrentUser();\r\n\r\n        const onEmojiClick = (event, emojiObject) => {\r\n            this.setState({newMessage:`${emojiObject.emoji}`});\r\n            console.log(`${emojiObject.emoji}`);\r\n        }\r\n       \r\n\r\n        const style = {\r\n            height: height,\r\n        }\r\n        const resultSearch = () => {\r\n\r\n                return (\r\n                    <div className=\"search-user\">\r\n                        <div className=\"user-list\">\r\n                        {usersList.map((user, index) =>{\r\n                            return <div onClick={() => this.handleOnClick(user)} key={index} className=\"user\">\r\n                            <img src={user.avatar} alt={user.name} />\r\n                            <span>{user.name}</span>\r\n                        </div>\r\n                        })\r\n                        } \r\n                        </div>\r\n                    </div>\r\n                )\r\n        }\r\n        return (\r\n            <div style={style} className=\"app3\">\r\n                \r\n               <div className=\"chat-header\">\r\n                    <div className=\"header-left\">\r\n                        <div className=\"action\">\r\n                            <Link onClick={(e) => this._onCreateChannel(e)} className=\"btn-primary\">AddNew</Link>\r\n                        </div>\r\n                    </div>\r\n                    {_.get(activeChannel, 'isNew') ? <div className=\"toolbar\">\r\n                        <form className=\"tool\">\r\n                            <textarea\r\n                            type=\"text\"\r\n                            value ={ this.state.searchUser }\r\n                            placeholder=\"To UserName/Email\"\r\n                            onChange = {(e) => {\r\n                                const searchTxt = _.get(e, 'target.value');\r\n                                this.setState({\r\n                                    searchUser: searchTxt,\r\n                                }, () => {\r\n                                    store.startSearchUsers(searchTxt);\r\n                                })\r\n                                \r\n                            }}\r\n                            />\r\n                        </form>\r\n                        {resultSearch()}\r\n                        </div> : null }\r\n\r\n                    <div className=\"header-mid\">\r\n                        { this.renderChannelTitle(activeChannel) }\r\n                    </div>\r\n                    <div className=\"header-right\">\r\n                        <UserBar store = { store } />\r\n                        <div className=\"toolsRight-bar\">\r\n                        <IconButton  style={{ color: \"rgba(0, 0, 0, 0.5)\"}}>\r\n                            <MdSettings />\r\n                        </IconButton>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"chat-main\">\r\n                    <div className=\"sidebar-left\">\r\n                        <div className=\"chanels\">\r\n                            {channels.map((channel, index) =>{\r\n                                return (\r\n                                    <div onClick= {(index) => {\r\n                                        store.setActiveChannelId(channel._id);\r\n                                    }} key={channel._id} className={className('chanel', {'active' : _.get(activeChannel, '_id') === _.get(channel, '_id', null)})}>\r\n                                        <div className=\"user-img\">\r\n                                            {this.renderChannelAvatar(channel)}\r\n                                        </div>\r\n                                        <div className={className('chanel-info',{'notify': _.get(channel, 'notify', null)})}>\r\n                                            {this.renderChannelTitle(channel)}\r\n                                            {/* <p>{channel.lastMessage}</p> */}\r\n                                        </div>\r\n                                    </div>\r\n                                )\r\n                            })}\r\n                            \r\n                        </div>\r\n                    </div>\r\n                    <div className=\"chat-content\">\r\n                        <div className=\"toolChat\">\r\n                            <Dropzone onDrop={this.onDrop}>\r\n                                {({getRootProps, getInputProps}) => (\r\n                                    <section>\r\n                                    <div {...getRootProps()}>\r\n                                        <input {...getInputProps()} />\r\n                                        <IconButton>\r\n                                            <CgSoftwareUpload />\r\n                                        </IconButton>\r\n                                    </div>\r\n                                    </section>\r\n                                )}\r\n                            </Dropzone>\r\n                        </div>\r\n                        <div ref={(ref) => this.messagesRef = ref} className=\"messages\">\r\n                            { \r\n                                messages.map((mess, index) => { \r\n                                    const user = _.get(mess, 'user');\r\n                                    return (\r\n                                    <div key={index} className={`${mess.me ? 'message-me' : 'message'}`}>\r\n\r\n                                    <img src={_.get(user, 'avatar')} alt=\"user-img\" className=\"img-user\"></img>\r\n\r\n                                    <div className=\"message-body\">\r\n\r\n                                        <div className=\"username\">{`${mess.me ? 'You' : _.get(mess, 'user.name')}`} say: </div>\r\n                                        \r\n                                        <p className=\"message-text\">\r\n                                                { `${mess.body}`.substring(0, 8) === \"uploads/\" ?\r\n                                                // this will be either video or image \r\n\r\n                                                (`${mess.body}`).substring((`${mess.body}`).length - 3, (`${mess.body}`).length) === 'mp3' ? \r\n                                                    <video\r\n                                                        style={{ maxWidth: '20rem' }}\r\n                                                        src={`http://localhost:8080/${mess.body}`} alt=\"video\"\r\n                                                        type=\"video/mp4\" controls\r\n                                                    />\r\n                                                    :\r\n                                                    <img\r\n                                                        style={{ maxWidth: '20rem' }}\r\n                                                        src={`http://localhost:8080/${mess.body}`}\r\n                                                        alt=\"img\"\r\n                                                    />\r\n                                            :\r\n                                            <p>{mess.body}</p>\r\n                                            } \r\n                                            {/* { this.renderMessage(mess) } */}\r\n                                            <p className=\"timing\">{mess.timing}</p>\r\n\r\n                                        </p>\r\n                                    </div>\r\n                                    </div>\r\n                                    );\r\n                                   \r\n                                })\r\n                            }\r\n                                {showEmoji ? <div className=\"emoji\" ref = {(ref) => this.ref = ref}>\r\n                                    <Picker  onEmojiClick={onEmojiClick} skinTone={SKIN_TONE_MEDIUM_DARK}/>\r\n                                </div> : null }\r\n                              \r\n                                 \r\n                        </div>\r\n                        {\r\n                        isShowGetAud ? <div className=\"getAdi\">\r\n                                <div>\r\n                                {this.state.audio ? <AudioAnalyser audio={this.state.audio} /> : null}\r\n                                </div>\r\n                        </div> : null\r\n                        }\r\n                        \r\n                        {_.get(activeChannel, 'typing') && _.get(activeChannel, 'typier') !== _.get(me, '_id') ? <div  disabled = { newMessage.length > 1 } className=\"typing-status\">Is Typing..</div> : null}\r\n                        {   members.size > 0 ? <div className=\"message-input\">\r\n                            <form \r\n                                onSubmit= { this.handleSubmit }\r\n                                disabled = { newMessage.length < 1 }\r\n                                className=\"message-form\">\r\n                                <IconButton onClick = {() => {this.setState({showEmoji: !showEmoji})}}>\r\n                                    <MdInsertEmoticon />\r\n                                </IconButton>\r\n                                <textarea  \r\n                                    id = \"message\"\r\n                                    ref={(input)=> this.input = input}\r\n                                    type = \"text\"\r\n                                    className = \"form-control\"\r\n                                    value = { newMessage }\r\n                                    autoComplete = {'off'}\r\n                                    placeholder = \"Type something interesting\"\r\n                                    onKeyUp = { (e) => { \r\n                                        { if(e.keyCode === 13 && !e.shiftKey) \r\n                                            { this.handleSubmit(e); }}\r\n                                        { if( e.keyCode !== 13 ){ this.sendTyping() }}\r\n                                        }\r\n                                    }\r\n                                    onChange = {\r\n                                    \t({target})=>{\r\n                                    \t\tthis.setState({newMessage:target.value})\r\n                                    \t}\r\n                                    }\r\n                                    />\r\n\r\n                                \r\n                                            {/*onClick = {() => this.toggleMicrophone()} */}\r\n                                        <IconButton  >\r\n                                        <MdMic onMouseDown= {() => {this.startRecording()}} onMouseUp= {() => {this.stopRecording()}} />\r\n                                        </IconButton>\r\n                            \r\n                                <button\r\n                                    disabled = { newMessage.length < 1 }\r\n                                    type = \"submit\"\r\n                                    className = \"send\"\r\n                                    onClick = { this.handleSubmit }\r\n                                > Send </button>\r\n                            </form>\r\n\t\t\t                </div>\r\n                            :\r\n                            null\r\n                        }\r\n                    </div>\r\n                   \r\n                    <div className=\"sidebar-right\">\r\n                        <div className=\"title-right\">Members</div>\r\n                        <div className=\"chanels\">\r\n                            { members.map((member, index) => {\r\n\r\n                                const isOnline = _.get(member, 'online', false);\r\n                                return (\r\n                                    <div key ={ index } className=\"chanel\">\r\n\r\n                                        <div className=\"user-img-channel\">\r\n                                            <img src={_.get(member, 'avatar')} alt=\"user-img\" />\r\n                                            <span className={className('user-status', {'online': isOnline})}></span>\r\n                                        </div>\r\n                                        <div className=\"chanel-info\">\r\n                                            <h4>{ member.name }</h4>\r\n                                            <p>Joined: 2000 years ago</p>\r\n                                        </div>\r\n                                        <div onClick = {() => {\r\n                                            store.removeMemberFromChannel(activeChannel, member);\r\n                                        }}\r\n                                         className=\"icon-DelUser\">\r\n                                        <IconButton  style={{ color: \"rgb(200, 68, 20)\", fontSize: \"20\"}}>\r\n                                            <MdDeleteForever />\r\n                                        </IconButton>\r\n                                        </div>\r\n\r\n                                    </div>\r\n                                )\r\n                            })}\r\n                            \r\n                        </div>\r\n                        \r\n                    </div>\r\n                    <MainVideo />\r\n\r\n                </div>  \r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}