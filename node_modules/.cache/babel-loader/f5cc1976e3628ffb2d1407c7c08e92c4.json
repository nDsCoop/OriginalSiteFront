{"ast":null,"code":"var _jsxFileName = \"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\src\\\\components\\\\Video.js\";\nimport React, { Component } from 'react';\nimport { MdVideocam, MdVideocamOff, MdMicOff, MdMic } from 'react-icons/md';\n\nclass Video extends Component {\n  constructor(props) {\n    super(props);\n\n    this.mutemic = e => {\n      try {\n        const stream = this.video.srcObject.getTracks().filter(track => track.kind === 'audio');\n        this.setState(prevState => {\n          if (stream) stream[0].enabled = !prevState.mic;\n          return {\n            mic: !prevState.mic\n          };\n        });\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    this.mutecamera = e => {\n      try {\n        const stream = this.video.srcObject.getTracks().filter(track => track.kind === 'video');\n        this.setState(prevState => {\n          if (stream) stream[0].enabled = !prevState.camera;\n          return {\n            camera: !prevState.camera\n          };\n        });\n      } catch (error) {\n        console.error(error);\n      }\n\n      ;\n    };\n\n    this.state = {\n      mic: true,\n      camera: true,\n      // currentStream: new MediaStream(),\n      // videoTrack: false,\n      videoVisible: true\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.videoStream) {\n      this.video.srcObject = this.props.videoStream;\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    // console.log('1. nextProps', this.props.showMuteControls, nextProps.videoStream && nextProps.videoStream.getTracks())\n    console.log('1', this.props.videoType, nextProps.videoStream); // This is done only once\n\n    if (nextProps.videoStream && nextProps.videoStream !== this.props.videoStream) {\n      // if (!this.props.videoStream) {\n      console.log('2', this.props.videoType, nextProps.videoStream);\n      this.video.srcObject = nextProps.videoStream;\n    } // This is done only once when we receive a video track\n\n\n    const videoTrack = nextProps.videoStream && nextProps.videoStream.getVideoTracks();\n\n    if (this.props.videoType === 'remoteVideo' && videoTrack && videoTrack.length) {\n      videoTrack[0].onmute = () => {\n        // alert('muted')\n        this.setState({\n          videoVisible: false\n        });\n        this.props.videoMuted(nextProps.videoStream);\n      };\n\n      videoTrack[0].onunmute = () => {\n        this.setState({\n          videoVisible: true\n        });\n        this.props.videoMuted(nextProps.videoStream);\n      };\n    }\n\n    const audioTrack = nextProps.videoStream && nextProps.videoStream.getAudioTracks();\n\n    if (this.props.videoType === 'remoteVideo' && audioTrack && audioTrack.length) {\n      audioTrack[0].onmute = () => {\n        alert('muted'); // this.setState({\n        //   videoVisible: false,\n        // })\n        // this.props.videoMuted(nextProps.videoStream)\n      };\n    }\n  }\n\n  render() {\n    const muteControls = this.props.showMuteControls && /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'flex-end'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      onClick: this.mutemic,\n      style: {\n        cursor: 'pointer',\n        padding: 5,\n        fontSize: 20,\n        color: this.state.mic && 'white' || 'red'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }\n    }, this.state.mic && /*#__PURE__*/React.createElement(MdMic, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 153\n      }\n    }) || /*#__PURE__*/React.createElement(MdMicOff, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 166\n      }\n    })), /*#__PURE__*/React.createElement(\"i\", {\n      onClick: this.mutecamera,\n      style: {\n        cursor: 'pointer',\n        padding: 5,\n        fontSize: 20,\n        color: this.state.camera && 'white' || 'red'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }\n    }, this.state.camera && /*#__PURE__*/React.createElement(MdVideocam, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 162\n      }\n    }) || /*#__PURE__*/React.createElement(MdVideocamOff, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 180\n      }\n    })));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: { ...this.props.frameStyle\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      id: this.props.id,\n      muted: this.props.muted,\n      autoPlay: true,\n      style: {\n        visibility: this.state.videoVisible && 'visible' || 'hidden',\n        ...this.props.videoStyles\n      } // ref={ this.props.videoRef }\n      ,\n      ref: ref => {\n        this.video = ref;\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }\n    }), muteControls);\n  }\n\n}\n\nexport default Video;","map":{"version":3,"sources":["C:/myProJects/Server/weatherapp/src/components/Video.js"],"names":["React","Component","MdVideocam","MdVideocamOff","MdMicOff","MdMic","Video","constructor","props","mutemic","e","stream","video","srcObject","getTracks","filter","track","kind","setState","prevState","enabled","mic","err","console","error","mutecamera","camera","state","videoVisible","componentDidMount","videoStream","componentWillReceiveProps","nextProps","log","videoType","videoTrack","getVideoTracks","length","onmute","videoMuted","onunmute","audioTrack","getAudioTracks","alert","render","muteControls","showMuteControls","display","justifyContent","cursor","padding","fontSize","color","frameStyle","id","muted","visibility","videoStyles","ref"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { MdVideocam, MdVideocamOff, MdMicOff, MdMic } from 'react-icons/md';\r\nclass Video extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      mic: true,\r\n      camera: true,\r\n      // currentStream: new MediaStream(),\r\n      // videoTrack: false,\r\n      videoVisible: true,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (this.props.videoStream) {\r\n      this.video.srcObject = this.props.videoStream\r\n    }\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n\r\n    // console.log('1. nextProps', this.props.showMuteControls, nextProps.videoStream && nextProps.videoStream.getTracks())\r\n    console.log('1', this.props.videoType, nextProps.videoStream)\r\n\r\n    // This is done only once\r\n    if (nextProps.videoStream && nextProps.videoStream !== this.props.videoStream) {\r\n    // if (!this.props.videoStream) {\r\n      console.log('2', this.props.videoType, nextProps.videoStream)\r\n      this.video.srcObject = nextProps.videoStream\r\n    }\r\n\r\n    // This is done only once when we receive a video track\r\n    const videoTrack = nextProps.videoStream && nextProps.videoStream.getVideoTracks()\r\n    if (this.props.videoType === 'remoteVideo' && videoTrack && videoTrack.length) {\r\n\r\n      videoTrack[0].onmute = () => {\r\n        // alert('muted')\r\n        this.setState({\r\n          videoVisible: false,\r\n        })\r\n        this.props.videoMuted(nextProps.videoStream)\r\n      }\r\n\r\n      videoTrack[0].onunmute = () => {\r\n        this.setState({\r\n          videoVisible: true,\r\n        })\r\n        this.props.videoMuted(nextProps.videoStream)\r\n      }\r\n    }\r\n\r\n\r\n    const audioTrack = nextProps.videoStream && nextProps.videoStream.getAudioTracks()\r\n    if (this.props.videoType === 'remoteVideo' && audioTrack && audioTrack.length) {\r\n      audioTrack[0].onmute = () => {\r\n        alert('muted')\r\n        // this.setState({\r\n        //   videoVisible: false,\r\n        // })\r\n        // this.props.videoMuted(nextProps.videoStream)\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  mutemic = (e) => {\r\n    try{\r\n      const stream = this.video.srcObject.getTracks().filter(track => track.kind === 'audio')\r\n      this.setState(prevState => {\r\n        if (stream) stream[0].enabled = !prevState.mic\r\n        return {mic: !prevState.mic}\r\n      })\r\n    }\r\n    catch (err) {\r\n      console.error(err);\r\n    }\r\n  }\r\n\r\n  mutecamera = (e) => {\r\n    try{\r\n      const stream = this.video.srcObject.getTracks().filter(track => track.kind === 'video')\r\n      this.setState(prevState => {\r\n        if (stream) stream[0].enabled = !prevState.camera\r\n        return {camera: !prevState.camera}\r\n      })\r\n    }\r\n    catch(error){\r\n      console.error(error);\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const muteControls = this.props.showMuteControls && (\r\n      <div style={{display:'flex', justifyContent: 'flex-end'}}>\r\n        <i onClick={this.mutemic} style={{ cursor: 'pointer', padding: 5, fontSize: 20, color: this.state.mic && 'white' || 'red' }}>{this.state.mic && <MdMic /> || <MdMicOff />}</i>\r\n        <i onClick={this.mutecamera} style={{ cursor: 'pointer', padding: 5, fontSize: 20, color: this.state.camera && 'white' || 'red' }}>{this.state.camera && <MdVideocam /> || <MdVideocamOff />}</i>\r\n      </div>\r\n    )\r\n\r\n    return (\r\n      <div\r\n        style={{ ...this.props.frameStyle,  }}\r\n      >\r\n        {/* <audio id={this.props.id} muted={this.props.muted} ref={ (ref) => {this.video = ref }}></audio> */}\r\n        <video\r\n          id={this.props.id}\r\n          muted={this.props.muted}\r\n          autoPlay\r\n          style={{\r\n            visibility: this.state.videoVisible && 'visible' || 'hidden',\r\n            ...this.props.videoStyles,\r\n          }}\r\n          // ref={ this.props.videoRef }\r\n          ref={ (ref) => {this.video = ref }}\r\n        ></video>\r\n        {muteControls}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Video"]},"metadata":{},"sourceType":"module"}