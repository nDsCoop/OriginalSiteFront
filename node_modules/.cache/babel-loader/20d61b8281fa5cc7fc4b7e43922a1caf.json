{"ast":null,"code":"var _jsxFileName = \"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\src\\\\components\\\\MainVideo.js\";\nimport React, { Component } from 'react';\nimport io from 'socket.io-client';\nconst socketUrl = \"http://192.168.1.3:5050\";\nexport class MainVideo extends Component {\n  constructor(props) {\n    super(props);\n\n    this.initSocket = () => {\n      const socket = io(socketUrl);\n      socket.on('connect', () => {\n        console.log(\"connected\");\n      });\n      this.setState({\n        socket\n      });\n    };\n\n    this.createOffer = () => {\n      console.log(\"Offer\");\n      this.pc.createOffer({\n        offerToReceiveVideo: 1\n      }).then(sdp => {\n        console.log(JSON.stringify(sdp));\n        this.pc.setLocalDescription(sdp);\n      }, e => {});\n    };\n\n    this.setRemoteDescription = () => {\n      const desc = JSON.parse(this.textref.value);\n      this.pc.setRemoteDescription(new RTCSessionDescription(desc));\n    };\n\n    this.createAnswer = () => {\n      console.log('Answer');\n      this.pc.createAnswer({\n        offerToReceiveVideo: 1\n      }).then(sdp => {\n        console.log(JSON.stringify(sdp));\n        this.pc.setLocalDescription(sdp);\n      }, e => {});\n    };\n\n    this.addCandidate = () => {\n      const candidate = JSON.parse(this.textref.value);\n      console.log('Adding cadidata: ', candidate);\n      this.pc.addIceCandidate(new RTCIceCandidate(candidate));\n    };\n\n    this.localVideoref = React.createRef();\n    this.remoteVideoref = React.createRef();\n    this.state = {\n      socket: null\n    };\n  }\n\n  componentWillMount() {\n    this.initSocket();\n  }\n\n  componentDidMount() {\n    const pc_config = null;\n    this.pc = new RTCPeerConnection(pc_config);\n\n    this.pc.onicecandidate = e => {\n      if (e.candidate) console.log(JSON.stringify(e.candidate));\n    };\n\n    this.pc.oniceconnectionstatechange = e => {\n      console.log(e);\n    };\n\n    this.pc.onaddstream = e => {\n      this.remoteVideoref.current.srcObject = e.stream;\n    };\n\n    const constraints = {\n      audio: true,\n      video: true\n    };\n\n    const success = stream => {\n      window.localStream = stream;\n      this.localVideoref.current.srcObject = stream;\n      this.pc.onaddstream(stream);\n    };\n\n    const failure = e => {\n      console.log(\"Error: \", e); //\n    };\n\n    navigator.mediaDevices.getUserMedia(constraints).then(success).catch(failure);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"video\", {\n      ref: this.localVideoref,\n      style: {\n        width: 240,\n        height: 240,\n        margin: 5,\n        backgroundColor: 'black'\n      },\n      autoPlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"video\", {\n      ref: this.remoteVideoref,\n      style: {\n        width: 240,\n        height: 240,\n        margin: 5,\n        backgroundColor: 'black'\n      },\n      autoPlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.createOffer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, \"Offer\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.createAnswer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }\n    }, \"Answer\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"textarea\", {\n      style: {\n        height: '2rem',\n        width: '23rem'\n      },\n      ref: ref => {\n        this.textref = ref;\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.setRemoteDescription,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, \"Set Remoete Desc\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.addCandidate,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 17\n      }\n    }, \"Add Candidate\"));\n  }\n\n}\nexport default MainVideo;","map":{"version":3,"sources":["C:/myProJects/Server/weatherapp/src/components/MainVideo.js"],"names":["React","Component","io","socketUrl","MainVideo","constructor","props","initSocket","socket","on","console","log","setState","createOffer","pc","offerToReceiveVideo","then","sdp","JSON","stringify","setLocalDescription","e","setRemoteDescription","desc","parse","textref","value","RTCSessionDescription","createAnswer","addCandidate","candidate","addIceCandidate","RTCIceCandidate","localVideoref","createRef","remoteVideoref","state","componentWillMount","componentDidMount","pc_config","RTCPeerConnection","onicecandidate","oniceconnectionstatechange","onaddstream","current","srcObject","stream","constraints","audio","video","success","window","localStream","failure","navigator","mediaDevices","getUserMedia","catch","render","width","height","margin","backgroundColor","ref"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport io from 'socket.io-client';\r\nconst socketUrl = \"http://192.168.1.3:5050\"\r\nexport class MainVideo extends Component {\r\n    constructor(props){\r\n        super(props)\r\n        this.localVideoref = React.createRef();\r\n        this.remoteVideoref = React.createRef();\r\n        this.state = {\r\n            socket: null\r\n        };\r\n    }\r\n    componentWillMount() {\r\n        this.initSocket()\r\n    }\r\n    initSocket = () => {\r\n        const socket = io(socketUrl)\r\n        socket.on('connect', () => {\r\n            console.log(\"connected\");\r\n        })\r\n        this.setState({socket})\r\n    }\r\n\r\n    componentDidMount(){\r\n        const pc_config = null\r\n        this.pc = new RTCPeerConnection(pc_config)\r\n        this.pc.onicecandidate = (e) => {\r\n            if(e.candidate) console.log(JSON.stringify(e.candidate))\r\n        }\r\n        this.pc.oniceconnectionstatechange = (e) => {\r\n            console.log(e)\r\n        }\r\n        \r\n        this.pc.onaddstream = (e) => {\r\n            this.remoteVideoref.current.srcObject = e.stream\r\n        }\r\n        const constraints = { audio: true, video: true }\r\n\r\n\r\n        const success = (stream) => {\r\n            window.localStream = stream\r\n            this.localVideoref.current.srcObject = stream\r\n            this.pc.onaddstream(stream)\r\n        }\r\n        const failure = (e) => {\r\n            console.log(\"Error: \", e);\r\n            //\r\n        }\r\n        navigator.mediaDevices.getUserMedia( constraints )\r\n        .then( success )\r\n        .catch( failure )\r\n    }\r\n    createOffer = () => {\r\n        console.log(\"Offer\");\r\n        this.pc.createOffer({offerToReceiveVideo: 1})\r\n        .then(sdp => {\r\n            console.log(JSON.stringify(sdp))\r\n            this.pc.setLocalDescription(sdp)\r\n        }, e => {})\r\n    }\r\n    setRemoteDescription = () => {\r\n        const desc = JSON.parse(this.textref.value)\r\n        this.pc.setRemoteDescription(new RTCSessionDescription(desc))\r\n    }\r\n    createAnswer = () => {\r\n        console.log('Answer');\r\n        this.pc.createAnswer({offerToReceiveVideo: 1})\r\n        .then(sdp => {\r\n            console.log(JSON.stringify(sdp))\r\n            this.pc.setLocalDescription(sdp)\r\n        }, e => {})\r\n    }\r\n    addCandidate = () => {\r\n        const candidate = JSON.parse(this.textref.value)\r\n        console.log('Adding cadidata: ', candidate)\r\n\r\n        this.pc.addIceCandidate(new RTCIceCandidate(candidate))\r\n    }\r\n\r\n    render() {\r\n        \r\n        return (\r\n            <div>\r\n                <video ref={this.localVideoref}\r\n                style={{width: 240, height: 240, margin: 5, backgroundColor: 'black'}}\r\n                autoPlay ></video>\r\n                \r\n                <video ref={this.remoteVideoref}\r\n                style={{width: 240, height: 240, margin: 5, backgroundColor: 'black'}}\r\n                autoPlay ></video>\r\n\r\n                <button onClick={this.createOffer}>Offer</button>\r\n                <button onClick={this.createAnswer}>Answer</button>\r\n                <br/>\r\n                <textarea style={{height:'2rem', width: '23rem'}} ref={ref => { this.textref = ref}}/>\r\n                <br/>\r\n                <button onClick={this.setRemoteDescription}>Set Remoete Desc</button>\r\n                <button onClick={this.addCandidate}>Add Candidate</button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default MainVideo\r\n"]},"metadata":{},"sourceType":"module"}