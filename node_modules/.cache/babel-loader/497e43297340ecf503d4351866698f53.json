{"ast":null,"code":"var _jsxFileName = \"C:\\\\myProJects\\\\WeatherApp\\\\weatherapp\\\\src\\\\components\\\\player\\\\MainPlayer.js\";\nimport React, { useEffect, useContext, useState, useRef } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport { useSwipeable } from \"react-swipeable\";\nimport PlayPauseButton from \"./PlayPauseButton\";\nimport NextButton from \"./NextButton\";\nimport PreviousButton from \"./PreviousButton\";\nimport MusicArt from \"./MusicArt\";\nimport TimelineController from \"./TimelineController\";\nimport TopBar from \"./TopBar\";\nimport MiniMusicArt from \"./MiniMusicArt\";\nimport RelatedVideos from \"../RelatedVideos\";\nimport getAudioLink from \"../../apis/getAudioLink\";\nimport youtubeSearch from \"../../apis/yotubeSearch\";\nimport { updatePlayingSong } from \"../../external/saveSong\";\nimport \"../../external/saveCountry\";\nimport \"../../style.css\";\nimport { GlobalContext } from \"../GlobalState\"; // window.onbeforeunload = function() {\n//   return 'You have unsaved changes!';\n// }\n\nlet relatedVideosVar;\n\nconst MainPlayer = ({\n  location,\n  history\n}) => {\n  let params = new URLSearchParams(location.search);\n  const [{\n    currentVideoSnippet,\n    themeSelectValue\n  }, dispatch] = useContext(GlobalContext);\n\n  const setCurrentVideoSnippet = data => {\n    dispatch({\n      type: \"setCurrentVideoSnippet\",\n      snippet: data\n    });\n  };\n\n  const [relatedVideos, setRelatedVideos] = useState([]);\n  const [isItFromPlaylist, setIsItFromPlaylist] = useState(false); //\n\n  const [audioState, setAudioState] = useState(null); // there will be 4 states\n  // loading, loaded, playing, paused\n\n  const [playerState, setPlayerState] = useState(null); // there will be 3 states\n  // maximized, minimized, playlist\n\n  const [minimized, setMinimized] = useState(true);\n  const [isRepeatOn, setIsRepeatOn] = useState(false);\n  const [rating, setRating] = useState(\"none\");\n  const [isNextFromMini, setIsNextFromMini] = useState(false);\n  const [audioURL, setAudioURL] = useState(null);\n  const body = document.querySelector(\"body\");\n  const audioPlayer = useRef();\n  const player = audioPlayer.current;\n\n  const setupMediaSessions = () => {\n    if (\"mediaSession\" in navigator) {\n      console.log(\"navigator setupped\");\n      navigator.mediaSession.metadata = new window.MediaMetadata({\n        title: currentVideoSnippet.title,\n        artist: currentVideoSnippet.channelTitle,\n        artwork: [{\n          src: currentVideoSnippet.sdThumbnail,\n          sizes: \"512x512\",\n          type: \"image/png\"\n        }]\n      });\n      navigator.mediaSession.setActionHandler(\"play\", () => {\n        /* Code excerpted. */\n        playAudio();\n      });\n      navigator.mediaSession.setActionHandler(\"pause\", () => {\n        /* Code excerpted. */\n        audioPlayer.current.pause();\n      });\n      navigator.mediaSession.setActionHandler(\"previoustrack\", () => {\n        playPrevious();\n      });\n      navigator.mediaSession.setActionHandler(\"nexttrack\", () => {\n        playNext();\n      });\n    }\n  };\n\n  const playAudio = () => {\n    audioPlayer.current.play().then(_ => {\n      // Automatic playback started!\n      // Show playing UI.\n      console.log(\"audio played auto\");\n      setupMediaSessions();\n    }).catch(error => {\n      // Auto-play was prevented\n      // Show paused UI.\n      console.log(\"playback prevented\");\n      setAudioState(\"paused\");\n    });\n  };\n\n  useEffect(() => {\n    console.log(\"state changed triggedred\");\n\n    const getAudio = async data => {\n      // audioPlayer.current.src = \"\";\n      // maximize the player every time id changes\n      // only if playlist is not open\n      if (playerState !== \"playlist\" && !isNextFromMini) {\n        setPlayerState(\"maximized\"); //\n\n        console.log(\"maximizing here yar and state is\", playerState);\n      }\n\n      setTimeout(() => {\n        setIsNextFromMini(false); // change it back to false\n      }, 200);\n      setAudioState(\"loading\");\n      const res = await getAudioLink.get(\"/song\", {\n        params: {\n          id: data\n        }\n      }); // set the audio data\n\n      const proxyURL = \"https://server.ylight.xyz/proxy/\";\n      audioPlayer.current.src = res.data;\n      playAudio(); // var audioContext = new AudioContext();\n      // var track = audioContext.createMediaElementSource(audioPlayer.current);\n      // track.connect(audioContext.destination);\n    };\n\n    if (currentVideoSnippet.audio) {\n      console.log(\"yes its downloaded we will play from local file\"); // maximize the player every time id changes\n\n      setPlayerState(\"maximized\");\n      setAudioState(\"loading\");\n      audioPlayer.current.src = window.URL.createObjectURL(currentVideoSnippet.audio);\n      playAudio();\n    } else if (currentVideoSnippet.id) {\n      getAudio(currentVideoSnippet.id);\n    }\n\n    if (currentVideoSnippet.id) {\n      const searchRelated = async () => {\n        const res = await youtubeSearch.get(\"/search\", {\n          params: {\n            relatedToVideoId: currentVideoSnippet.id,\n            maxResults: 10\n          }\n        });\n        setRelatedVideos(res.data.items);\n      }; // if its not from the mini next button then only change history\n\n\n      if (!isNextFromMini) {\n        // if the click is not from playlist then only we will search for realated video\n        if (!isItFromPlaylist) {\n          // console.log(\"searching for related vids\", relatedVideos);\n          // if player is in playlist mode we will just replace history else push it\n          if (location.pathname !== \"/play\") {\n            // prevent duplicating history\n            history.push(`/play?id=${currentVideoSnippet.id}`);\n          }\n\n          searchRelated();\n        } else {\n          history.replace(`/play?id=${currentVideoSnippet.id}`);\n          setIsItFromPlaylist(false);\n        }\n      }\n\n      console.log(currentVideoSnippet);\n    } // set rating to none when we load new song\n\n\n    setRating(\"none\");\n  }, [currentVideoSnippet, setIsItFromPlaylist]); // useEffect(() => {\n  //   console.log(\"from playlist\", isItFromPlaylist);\n  // }, [isItFromPlaylist]);\n\n  useEffect(() => {\n    relatedVideosVar = relatedVideos;\n    console.log(\"related\", relatedVideos);\n  }, [relatedVideos]);\n  useEffect(() => {\n    console.log(\"isnext state\", isNextFromMini);\n  }, [isNextFromMini]);\n\n  const setAudioSrcAndPlay = async id => {\n    const res = await getAudioLink.get(\"/song\", {\n      params: {\n        id: id\n      }\n    }); // set the audio data\n\n    audioPlayer.current.src = res.data;\n    playAudio();\n  };\n\n  const setVideoSnippet = video => {\n    setCurrentVideoSnippet({\n      id: video.id.videoId,\n      title: video.snippet.title,\n      channelTitle: video.snippet.channelTitle,\n      maxThumbnail: `https://img.youtube.com/vi/${video.id.videoId}/hqdefault.jpg`,\n      sdThumbnail: `https://img.youtube.com/vi/${video.id.videoId}/sddefault.jpg` // this is the url of the max resolution of thumbnail\n\n    }); // if window is minimized then only we will run this function\n\n    if (document.hidden) {\n      setAudioSrcAndPlay(video.id.videoId);\n    }\n  };\n\n  const playNext = () => {\n    // also set this is from playlist\n    setIsItFromPlaylist(true);\n    console.log(\"play next related videos\", relatedVideos); // find the index of playing song in the playlist\n\n    const currentIndex = relatedVideosVar.findIndex(video => video.id.videoId === currentVideoSnippet.id);\n    console.log(\"the current index is\", currentIndex);\n    let video;\n    console.log(\"hey we will play next song\");\n    video = relatedVideosVar[currentIndex + 1]; //we will play the next song\n\n    setVideoSnippet(video);\n  };\n\n  const playPrevious = () => {\n    setIsItFromPlaylist(true); // if the player time is greater than 5 sec we will move the time to 0\n\n    if (player.currentTime > 5) {\n      player.currentTime = 0;\n    } else {\n      const currentIndex = relatedVideosVar.findIndex(video => video.id.videoId === currentVideoSnippet.id);\n      let video;\n\n      if (currentIndex !== -1) {\n        video = relatedVideosVar[currentIndex - 1]; //we will play the next song\n\n        setVideoSnippet(video);\n      } else {\n        player.currentTime = 0;\n      }\n    }\n  };\n\n  let playerStyle = {\n    position: \"fixed\",\n    right: 0,\n    bottom: 0,\n    background: \"#fff\",\n    width: \"100%\",\n    height: \"100%\",\n    zIndex: 1400,\n    display: \"inline block\",\n    transition: \"all .3s ease\"\n  };\n\n  if (playerState === \"minimized\") {\n    playerStyle.transform = \"translateY(calc(100% - 106px))\";\n    playerStyle.zIndex = 0; // if theme is not dark then only apply the pink style\n\n    if (themeSelectValue === \"Dark\") {\n      playerStyle.background = \"#333\";\n    } else {\n      playerStyle.background = \"#e91e63\";\n    } // playerStyle.bottom = \"48px\";\n    // calculate the top height and we are subtracting 148px becz\n    // 48 is the value of menu bar and 100px is minimized height\n    // make body overflow scroll ðŸ˜\n\n\n    body.style.overflow = \"auto\";\n  }\n\n  if (playerState === \"maximized\") {\n    // make body overflow hidden ðŸ™ˆ\n    body.style.overflow = \"hidden\";\n\n    if (themeSelectValue === \"Dark\") {\n      playerStyle.background = \"#333\";\n    }\n  }\n\n  if (playerState === \"playlist\") {\n    playerStyle.transform = \"translateY(-418px)\";\n  }\n\n  const expandPlayer = () => {\n    if (playerState === \"minimized\") {\n      setPlayerState(\"maximized\");\n      setMinimized(true);\n      history.push({\n        pathname: \"/play\",\n        search: `?id=${currentVideoSnippet.id}`,\n        state: {\n          modal: true\n        }\n      });\n    }\n  };\n\n  const toggleMaxPlaylist = () => {\n    if (playerState === \"playlist\") {\n      setPlayerState(\"maximized\");\n    } else {\n      setPlayerState(\"playlist\");\n    }\n\n    console.log(\"Maximize the playlist\");\n  };\n\n  const updateSongDB = async () => {\n    const rating = await updatePlayingSong(currentVideoSnippet); //  it will update song on db and return the rating\n\n    setRating(rating);\n    console.log(rating);\n  }; // this will be fired when song is ended\n\n\n  const songEnded = () => {\n    // if repeat is false we will play next else just set the time to 0\n    if (!isRepeatOn) {\n      playNext();\n    } else {\n      audioPlayer.current.currentTime = 0;\n      playAudio();\n    }\n  };\n\n  let initPosition = 0;\n  const containerRef = useRef(null);\n  const swipeHandlerMaximized = useSwipeable({\n    onSwipedDown: e => {\n      setPlayerState(\"minimized\");\n      history.goBack();\n    },\n    onSwiping: e => {\n      // console.log(e);\n      // getting the event for touches to extract the position\n      if (initPosition === 0) {\n        initPosition = e.event.changedTouches[0].screenY;\n      }\n\n      const screenY = e.event.changedTouches[0].screenY;\n      let positionDifference = Math.round(screenY - initPosition);\n\n      if (positionDifference < 1) {\n        positionDifference = 0;\n      }\n\n      const containerRefStyle = containerRef.current.style;\n      containerRefStyle.transform = `translateY(${positionDifference}px)`;\n      containerRefStyle.transition = \"none\";\n    },\n    onSwiped: e => {\n      initPosition = 0;\n      containerRef.current.style = \"\"; // we will make the initial position 0 again after user leaves the screen\n    },\n    onSwipedUp: e => {\n      if (playerState === \"minimized\") {\n        setPlayerState(\"maximized\");\n      }\n    },\n    onSwipedRight: e => {\n      const playTimeout = setTimeout(() => {\n        clearTimeout(playTimeout);\n        playNext();\n      }, 250);\n    },\n    onSwipedLeft: e => {\n      const playTimeout = setTimeout(() => {\n        clearTimeout(playTimeout);\n        playPrevious();\n      }, 250);\n    }\n  });\n  const swipeHandlerMin = useSwipeable({\n    onSwipedUp: e => {\n      expandPlayer();\n    }\n  });\n  useEffect(() => {\n    if (location.pathname === \"/play\" && !currentVideoSnippet.id) {\n      console.log(\"history is in play fetching song\");\n      fetchAndSetCurrentVideoSnippet(params.get(\"id\")); // math will give the song id from\n    } // we will only change if its push  otherwise while changing song from playlist changes the state\n    // Listen for changes to the current location.\n\n\n    const unlisten = history.listen(location => {\n      // location is an object like window.location\n      if (location.pathname === \"/play\") {\n        // we will only change if its push  otherwise while changing song from playlist changes the state\n        if (history.action !== \"REPLACE\") {\n          setPlayerState(\"maximized\");\n          console.log(\"set player state to maximized\");\n        }\n      } else {\n        setPlayerState(\"minimized\");\n        console.log(\"set player state to minimized\");\n      }\n\n      console.log(history);\n    });\n  }, [history]);\n  useEffect(() => {\n    console.log(playerState);\n  }, [playerState]);\n\n  const returnMinMaxClass = () => {\n    if (playerState === \"minimized\") {\n      return \"playerMinimized\";\n    } else if (playerState === \"playlist\") {\n      return \"playerPlaylist\";\n    }\n  };\n\n  const returnMaximizedPlayer = () => {\n    if (playerState === \"maximized\" || playerState === \"playlist\") {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Grid, {\n        container: true,\n        direction: \"column\",\n        className: \"main-player-inner\",\n        style: {\n          height: \" calc(100vh - 46px)\",\n          justifyContent: \"space-evenly\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(TopBar, {\n        song: currentVideoSnippet,\n        player: player,\n        setPlayerState: setPlayerState,\n        history: history,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", Object.assign({}, swipeHandlerMaximized, {\n        className: \"musicArtContainer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 456,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(MusicArt, {\n        data: currentVideoSnippet,\n        rating: rating,\n        audioEl: player,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(TimelineController, {\n        audioState: audioState,\n        player: player,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(Grid, {\n        container: true,\n        direction: \"row\",\n        justify: \"space-evenly\",\n        alignItems: \"center\",\n        style: {\n          maxWidth: \"290px\",\n          height: \"80px\",\n          margin: \"0 auto\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(PreviousButton, {\n        playPrevious: playPrevious,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(PlayPauseButton, {\n        player: player,\n        audioState: audioState,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 473,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(NextButton, {\n        onPlayNext: playNext,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 15\n        }\n      }))), /*#__PURE__*/React.createElement(RelatedVideos, {\n        toggleMaxPlaylist: toggleMaxPlaylist,\n        setPlaylist: () => setIsItFromPlaylist(true),\n        playerState: playerState,\n        relatedVideos: relatedVideos,\n        setRelatedVideos: data => setRelatedVideos(data),\n        isRepeatOn: isRepeatOn // this will set the repeat setting\n        ,\n        setIsRepeatOn: () => {\n          setIsRepeatOn(!isRepeatOn);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 477,\n          columnNumber: 11\n        }\n      }));\n    }\n  };\n\n  const returnMinimizedPlayer = () => {\n    if (playerState === \"minimized\" && currentVideoSnippet.id) {\n      return /*#__PURE__*/React.createElement(\"div\", Object.assign({}, swipeHandlerMin, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(MiniMusicArt // we are making an object for props we will pass it to play pause button through mini music art\n      , {\n        playPause: {\n          player: player,\n          minimized: minimized,\n          audioState: audioState\n        },\n        playNext: e => {\n          e.stopPropagation();\n          setIsNextFromMini(true);\n          playNext();\n        },\n        data: currentVideoSnippet,\n        emptyPlayer: e => {\n          e.stopPropagation();\n          setCurrentVideoSnippet([]);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(TimelineController, {\n        audioState: audioState,\n        player: player,\n        minimized: minimized,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 516,\n          columnNumber: 11\n        }\n      }));\n    }\n  };\n\n  const fetchAndSetCurrentVideoSnippet = id => {\n    youtubeSearch.get(\"videos\", {\n      params: {\n        id: id\n      }\n    }).then(res => {\n      const item = res.data.items[0];\n      console.log(currentVideoSnippet);\n      setCurrentVideoSnippet({\n        id: item.id,\n        title: item.snippet.title,\n        channelTitle: item.snippet.channelTitle,\n        maxThumbnail: `https://img.youtube.com/vi/${item.id}/maxresdefault.jpg`,\n        sdThumbnail: `https://img.youtube.com/vi/${item.id}/sddefault.jpg` // this is the url of the max resolution of thumbnail\n\n      });\n    });\n  };\n\n  if (!currentVideoSnippet.id) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    // drag=\"y\"\n    // dragConstraints={{ top: 0, bottom: 600 }}\n    ref: containerRef // style={playerStyle}\n    ,\n    onClick: expandPlayer,\n    className: \"mediaPlayerContainer \" + returnMinMaxClass(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 552,\n      columnNumber: 5\n    }\n  }, returnMaximizedPlayer(), returnMinimizedPlayer(), /*#__PURE__*/React.createElement(\"audio\", {\n    // onTimeUpdate={timeUpdate}\n    onLoadStart: () => {\n      setAudioState(\"loading\");\n    },\n    id: \"audio-element\",\n    onLoadedData: updateSongDB // crossOrigin=\"anonymous\"\n    ,\n    onPlay: () => setAudioState(\"playing\"),\n    onPlaying: () => setAudioState(\"playing\"),\n    onPause: () => setAudioState(\"paused\"),\n    onEnded: songEnded,\n    autoPlay: true,\n    ref: audioPlayer // type=\"audio/mp4\"\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 562,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default MainPlayer;","map":{"version":3,"sources":["C:/myProJects/WeatherApp/weatherapp/src/components/player/MainPlayer.js"],"names":["React","useEffect","useContext","useState","useRef","Grid","useSwipeable","PlayPauseButton","NextButton","PreviousButton","MusicArt","TimelineController","TopBar","MiniMusicArt","RelatedVideos","getAudioLink","youtubeSearch","updatePlayingSong","GlobalContext","relatedVideosVar","MainPlayer","location","history","params","URLSearchParams","search","currentVideoSnippet","themeSelectValue","dispatch","setCurrentVideoSnippet","data","type","snippet","relatedVideos","setRelatedVideos","isItFromPlaylist","setIsItFromPlaylist","audioState","setAudioState","playerState","setPlayerState","minimized","setMinimized","isRepeatOn","setIsRepeatOn","rating","setRating","isNextFromMini","setIsNextFromMini","audioURL","setAudioURL","body","document","querySelector","audioPlayer","player","current","setupMediaSessions","navigator","console","log","mediaSession","metadata","window","MediaMetadata","title","artist","channelTitle","artwork","src","sdThumbnail","sizes","setActionHandler","playAudio","pause","playPrevious","playNext","play","then","_","catch","error","getAudio","setTimeout","res","get","id","proxyURL","audio","URL","createObjectURL","searchRelated","relatedToVideoId","maxResults","items","pathname","push","replace","setAudioSrcAndPlay","setVideoSnippet","video","videoId","maxThumbnail","hidden","currentIndex","findIndex","currentTime","playerStyle","position","right","bottom","background","width","height","zIndex","display","transition","transform","style","overflow","expandPlayer","state","modal","toggleMaxPlaylist","updateSongDB","songEnded","initPosition","containerRef","swipeHandlerMaximized","onSwipedDown","e","goBack","onSwiping","event","changedTouches","screenY","positionDifference","Math","round","containerRefStyle","onSwiped","onSwipedUp","onSwipedRight","playTimeout","clearTimeout","onSwipedLeft","swipeHandlerMin","fetchAndSetCurrentVideoSnippet","unlisten","listen","action","returnMinMaxClass","returnMaximizedPlayer","justifyContent","maxWidth","margin","returnMinimizedPlayer","stopPropagation","item"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState, useRef } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport { useSwipeable } from \"react-swipeable\";\nimport PlayPauseButton from \"./PlayPauseButton\";\nimport NextButton from \"./NextButton\";\nimport PreviousButton from \"./PreviousButton\";\nimport MusicArt from \"./MusicArt\";\nimport TimelineController from \"./TimelineController\";\nimport TopBar from \"./TopBar\";\nimport MiniMusicArt from \"./MiniMusicArt\";\nimport RelatedVideos from \"../RelatedVideos\";\nimport getAudioLink from \"../../apis/getAudioLink\";\nimport youtubeSearch from \"../../apis/yotubeSearch\";\nimport { updatePlayingSong } from \"../../external/saveSong\";\n\nimport \"../../external/saveCountry\";\n\nimport \"../../style.css\";\n\nimport { GlobalContext } from \"../GlobalState\";\n\n// window.onbeforeunload = function() {\n//   return 'You have unsaved changes!';\n// }\nlet relatedVideosVar;\n\nconst MainPlayer = ({ location, history }) => {\n  let params = new URLSearchParams(location.search);\n\n  const [{ currentVideoSnippet, themeSelectValue }, dispatch] = useContext(\n    GlobalContext\n  );\n\n  const setCurrentVideoSnippet = data => {\n    dispatch({ type: \"setCurrentVideoSnippet\", snippet: data });\n  };\n\n  const [relatedVideos, setRelatedVideos] = useState([]);\n  const [isItFromPlaylist, setIsItFromPlaylist] = useState(false);\n  //\n  const [audioState, setAudioState] = useState(null);\n  // there will be 4 states\n  // loading, loaded, playing, paused\n\n  const [playerState, setPlayerState] = useState(null);\n  // there will be 3 states\n  // maximized, minimized, playlist\n\n  const [minimized, setMinimized] = useState(true);\n  const [isRepeatOn, setIsRepeatOn] = useState(false);\n  const [rating, setRating] = useState(\"none\");\n  const [isNextFromMini, setIsNextFromMini] = useState(false);\n  const [audioURL, setAudioURL] = useState(null);\n  const body = document.querySelector(\"body\");\n\n  const audioPlayer = useRef();\n  const player = audioPlayer.current;\n  const setupMediaSessions = () => {\n    if (\"mediaSession\" in navigator) {\n      console.log(\"navigator setupped\");\n\n      navigator.mediaSession.metadata = new window.MediaMetadata({\n        title: currentVideoSnippet.title,\n        artist: currentVideoSnippet.channelTitle,\n        artwork: [\n          {\n            src: currentVideoSnippet.sdThumbnail,\n            sizes: \"512x512\",\n            type: \"image/png\"\n          }\n        ]\n      });\n      navigator.mediaSession.setActionHandler(\"play\", () => {\n        /* Code excerpted. */\n        playAudio();\n      });\n      navigator.mediaSession.setActionHandler(\"pause\", () => {\n        /* Code excerpted. */\n        audioPlayer.current.pause();\n      });\n      navigator.mediaSession.setActionHandler(\"previoustrack\", () => {\n        playPrevious();\n      });\n      navigator.mediaSession.setActionHandler(\"nexttrack\", () => {\n        playNext();\n      });\n    }\n  };\n\n  const playAudio = () => {\n    audioPlayer.current\n      .play()\n      .then(_ => {\n        // Automatic playback started!\n        // Show playing UI.\n        console.log(\"audio played auto\");\n        setupMediaSessions();\n      })\n      .catch(error => {\n        // Auto-play was prevented\n        // Show paused UI.\n        console.log(\"playback prevented\");\n        setAudioState(\"paused\");\n      });\n  };\n\n  useEffect(() => {\n    console.log(\"state changed triggedred\");\n    const getAudio = async data => {\n      // audioPlayer.current.src = \"\";\n      // maximize the player every time id changes\n      // only if playlist is not open\n      if (playerState !== \"playlist\" && !isNextFromMini) {\n        setPlayerState(\"maximized\");\n        //\n        console.log(\"maximizing here yar and state is\", playerState);\n      }\n\n      setTimeout(() => {\n        setIsNextFromMini(false);\n        // change it back to false\n      }, 200);\n\n      setAudioState(\"loading\");\n      const res = await getAudioLink.get(\"/song\", {\n        params: { id: data }\n      });\n\n      // set the audio data\n      const proxyURL = \"https://server.ylight.xyz/proxy/\";\n      audioPlayer.current.src = res.data;\n      playAudio();\n\n      // var audioContext = new AudioContext();\n\n      // var track = audioContext.createMediaElementSource(audioPlayer.current);\n      // track.connect(audioContext.destination);\n    };\n\n    if (currentVideoSnippet.audio) {\n      console.log(\"yes its downloaded we will play from local file\");\n      // maximize the player every time id changes\n\n      setPlayerState(\"maximized\");\n      setAudioState(\"loading\");\n      audioPlayer.current.src = window.URL.createObjectURL(\n        currentVideoSnippet.audio\n      );\n      playAudio();\n    } else if (currentVideoSnippet.id) {\n      getAudio(currentVideoSnippet.id);\n    }\n\n    if (currentVideoSnippet.id) {\n      const searchRelated = async () => {\n        const res = await youtubeSearch.get(\"/search\", {\n          params: {\n            relatedToVideoId: currentVideoSnippet.id,\n            maxResults: 10\n          }\n        });\n        setRelatedVideos(res.data.items);\n      };\n\n      // if its not from the mini next button then only change history\n      if (!isNextFromMini) {\n        // if the click is not from playlist then only we will search for realated video\n        if (!isItFromPlaylist) {\n          // console.log(\"searching for related vids\", relatedVideos);\n          // if player is in playlist mode we will just replace history else push it\n          if (location.pathname !== \"/play\") {\n            // prevent duplicating history\n            history.push(`/play?id=${currentVideoSnippet.id}`);\n          }\n\n          searchRelated();\n        } else {\n          history.replace(`/play?id=${currentVideoSnippet.id}`);\n          setIsItFromPlaylist(false);\n        }\n      }\n\n      console.log(currentVideoSnippet);\n    }\n\n    // set rating to none when we load new song\n    setRating(\"none\");\n  }, [currentVideoSnippet, setIsItFromPlaylist]);\n\n  // useEffect(() => {\n  //   console.log(\"from playlist\", isItFromPlaylist);\n  // }, [isItFromPlaylist]);\n\n  useEffect(() => {\n    relatedVideosVar = relatedVideos;\n    console.log(\"related\", relatedVideos);\n  }, [relatedVideos]);\n\n  useEffect(() => {\n    console.log(\"isnext state\", isNextFromMini);\n  }, [isNextFromMini]);\n\n  const setAudioSrcAndPlay = async id => {\n    const res = await getAudioLink.get(\"/song\", {\n      params: { id: id }\n    });\n\n    // set the audio data\n    audioPlayer.current.src = res.data;\n    playAudio();\n  };\n\n  const setVideoSnippet = video => {\n    setCurrentVideoSnippet({\n      id: video.id.videoId,\n      title: video.snippet.title,\n      channelTitle: video.snippet.channelTitle,\n      maxThumbnail: `https://img.youtube.com/vi/${video.id.videoId}/hqdefault.jpg`,\n      sdThumbnail: `https://img.youtube.com/vi/${video.id.videoId}/sddefault.jpg`\n      // this is the url of the max resolution of thumbnail\n    });\n\n    // if window is minimized then only we will run this function\n    if (document.hidden) {\n      setAudioSrcAndPlay(video.id.videoId);\n    }\n  };\n\n  const playNext = () => {\n    // also set this is from playlist\n    setIsItFromPlaylist(true);\n    console.log(\"play next related videos\", relatedVideos);\n    // find the index of playing song in the playlist\n    const currentIndex = relatedVideosVar.findIndex(\n      video => video.id.videoId === currentVideoSnippet.id\n    );\n    console.log(\"the current index is\", currentIndex);\n\n    let video;\n    console.log(\"hey we will play next song\");\n    video = relatedVideosVar[currentIndex + 1]; //we will play the next song\n\n    setVideoSnippet(video);\n  };\n\n  const playPrevious = () => {\n    setIsItFromPlaylist(true);\n\n    // if the player time is greater than 5 sec we will move the time to 0\n    if (player.currentTime > 5) {\n      player.currentTime = 0;\n    } else {\n      const currentIndex = relatedVideosVar.findIndex(\n        video => video.id.videoId === currentVideoSnippet.id\n      );\n      let video;\n      if (currentIndex !== -1) {\n        video = relatedVideosVar[currentIndex - 1]; //we will play the next song\n        setVideoSnippet(video);\n      } else {\n        player.currentTime = 0;\n      }\n    }\n  };\n\n  let playerStyle = {\n    position: \"fixed\",\n    right: 0,\n    bottom: 0,\n    background: \"#fff\",\n    width: \"100%\",\n    height: \"100%\",\n    zIndex: 1400,\n    display: \"inline block\",\n    transition: \"all .3s ease\"\n  };\n\n  if (playerState === \"minimized\") {\n    playerStyle.transform = \"translateY(calc(100% - 106px))\";\n    playerStyle.zIndex = 0;\n    // if theme is not dark then only apply the pink style\n    if (themeSelectValue === \"Dark\") {\n      playerStyle.background = \"#333\";\n    } else {\n      playerStyle.background = \"#e91e63\";\n    }\n    // playerStyle.bottom = \"48px\";\n    // calculate the top height and we are subtracting 148px becz\n    // 48 is the value of menu bar and 100px is minimized height\n    // make body overflow scroll ðŸ˜\n    body.style.overflow = \"auto\";\n  }\n\n  if (playerState === \"maximized\") {\n    // make body overflow hidden ðŸ™ˆ\n    body.style.overflow = \"hidden\";\n    if (themeSelectValue === \"Dark\") {\n      playerStyle.background = \"#333\";\n    }\n  }\n\n  if (playerState === \"playlist\") {\n    playerStyle.transform = \"translateY(-418px)\";\n  }\n\n  const expandPlayer = () => {\n    if (playerState === \"minimized\") {\n      setPlayerState(\"maximized\");\n      setMinimized(true);\n      history.push({\n        pathname: \"/play\",\n        search: `?id=${currentVideoSnippet.id}`,\n        state: { modal: true }\n      });\n    }\n  };\n\n  const toggleMaxPlaylist = () => {\n    if (playerState === \"playlist\") {\n      setPlayerState(\"maximized\");\n    } else {\n      setPlayerState(\"playlist\");\n    }\n    console.log(\"Maximize the playlist\");\n  };\n\n  const updateSongDB = async () => {\n    const rating = await updatePlayingSong(currentVideoSnippet);\n    //  it will update song on db and return the rating\n    setRating(rating);\n    console.log(rating);\n  };\n\n  // this will be fired when song is ended\n  const songEnded = () => {\n    // if repeat is false we will play next else just set the time to 0\n    if (!isRepeatOn) {\n      playNext();\n    } else {\n      audioPlayer.current.currentTime = 0;\n      playAudio();\n    }\n  };\n\n  let initPosition = 0;\n  const containerRef = useRef(null);\n\n  const swipeHandlerMaximized = useSwipeable({\n    onSwipedDown: e => {\n      setPlayerState(\"minimized\");\n      history.goBack();\n    },\n    onSwiping: e => {\n      // console.log(e);\n      // getting the event for touches to extract the position\n      if (initPosition === 0) {\n        initPosition = e.event.changedTouches[0].screenY;\n      }\n\n      const screenY = e.event.changedTouches[0].screenY;\n      let positionDifference = Math.round(screenY - initPosition);\n      if (positionDifference < 1) {\n        positionDifference = 0;\n      }\n\n      const containerRefStyle = containerRef.current.style;\n      containerRefStyle.transform = `translateY(${positionDifference}px)`;\n      containerRefStyle.transition = \"none\";\n    },\n    onSwiped: e => {\n      initPosition = 0;\n      containerRef.current.style = \"\";\n      // we will make the initial position 0 again after user leaves the screen\n    },\n    onSwipedUp: e => {\n      if (playerState === \"minimized\") {\n        setPlayerState(\"maximized\");\n      }\n    },\n    onSwipedRight: e => {\n      const playTimeout = setTimeout(() => {\n        clearTimeout(playTimeout);\n        playNext();\n      }, 250);\n    },\n    onSwipedLeft: e => {\n      const playTimeout = setTimeout(() => {\n        clearTimeout(playTimeout);\n        playPrevious();\n      }, 250);\n    }\n  });\n\n  const swipeHandlerMin = useSwipeable({\n    onSwipedUp: e => {\n      expandPlayer();\n    }\n  });\n\n  useEffect(() => {\n    if (location.pathname === \"/play\" && !currentVideoSnippet.id) {\n      console.log(\"history is in play fetching song\");\n\n      fetchAndSetCurrentVideoSnippet(params.get(\"id\")); // math will give the song id from\n    }\n    // we will only change if its push  otherwise while changing song from playlist changes the state\n\n    // Listen for changes to the current location.\n    const unlisten = history.listen(location => {\n      // location is an object like window.location\n      if (location.pathname === \"/play\") {\n        // we will only change if its push  otherwise while changing song from playlist changes the state\n        if (history.action !== \"REPLACE\") {\n          setPlayerState(\"maximized\");\n          console.log(\"set player state to maximized\");\n        }\n      } else {\n        setPlayerState(\"minimized\");\n        console.log(\"set player state to minimized\");\n      }\n      console.log(history);\n    });\n  }, [history]);\n\n  useEffect(() => {\n    console.log(playerState);\n  }, [playerState]);\n\n  const returnMinMaxClass = () => {\n    if (playerState === \"minimized\") {\n      return \"playerMinimized\";\n    } else if (playerState === \"playlist\") {\n      return \"playerPlaylist\";\n    }\n  };\n\n  const returnMaximizedPlayer = () => {\n    if (playerState === \"maximized\" || playerState === \"playlist\") {\n      return (\n        <>\n          <Grid\n            container\n            direction=\"column\"\n            className=\"main-player-inner\"\n            style={{\n              height: \" calc(100vh - 46px)\",\n              justifyContent: \"space-evenly\"\n            }}\n          >\n            <TopBar\n              song={currentVideoSnippet}\n              player={player}\n              setPlayerState={setPlayerState}\n              history={history}\n            />\n            <div {...swipeHandlerMaximized} className=\"musicArtContainer\">\n              <MusicArt\n                data={currentVideoSnippet}\n                rating={rating}\n                audioEl={player}\n              />\n            </div>\n            <TimelineController audioState={audioState} player={player} />\n\n            <Grid\n              container\n              direction=\"row\"\n              justify=\"space-evenly\"\n              alignItems=\"center\"\n              style={{ maxWidth: \"290px\", height: \"80px\", margin: \"0 auto\" }}\n            >\n              <PreviousButton playPrevious={playPrevious} />\n              <PlayPauseButton player={player} audioState={audioState} />\n              <NextButton onPlayNext={playNext} />\n            </Grid>\n          </Grid>\n          <RelatedVideos\n            toggleMaxPlaylist={toggleMaxPlaylist}\n            setPlaylist={() => setIsItFromPlaylist(true)}\n            playerState={playerState}\n            relatedVideos={relatedVideos}\n            setRelatedVideos={data => setRelatedVideos(data)}\n            isRepeatOn={isRepeatOn}\n            // this will set the repeat setting\n            setIsRepeatOn={() => {\n              setIsRepeatOn(!isRepeatOn);\n            }}\n          />\n        </>\n      );\n    }\n  };\n\n  const returnMinimizedPlayer = () => {\n    if (playerState === \"minimized\" && currentVideoSnippet.id) {\n      return (\n        <div {...swipeHandlerMin}>\n          <MiniMusicArt\n            // we are making an object for props we will pass it to play pause button through mini music art\n            playPause={{\n              player: player,\n              minimized: minimized,\n              audioState: audioState\n            }}\n            playNext={e => {\n              e.stopPropagation();\n              setIsNextFromMini(true);\n              playNext();\n            }}\n            data={currentVideoSnippet}\n            emptyPlayer={e => {\n              e.stopPropagation();\n              setCurrentVideoSnippet([]);\n            }}\n          />\n          <TimelineController\n            audioState={audioState}\n            player={player}\n            minimized={minimized}\n          />\n        </div>\n      );\n    }\n  };\n\n  const fetchAndSetCurrentVideoSnippet = id => {\n    youtubeSearch\n      .get(\"videos\", {\n        params: {\n          id: id\n        }\n      })\n      .then(res => {\n        const item = res.data.items[0];\n        console.log(currentVideoSnippet);\n        setCurrentVideoSnippet({\n          id: item.id,\n          title: item.snippet.title,\n          channelTitle: item.snippet.channelTitle,\n          maxThumbnail: `https://img.youtube.com/vi/${item.id}/maxresdefault.jpg`,\n          sdThumbnail: `https://img.youtube.com/vi/${item.id}/sddefault.jpg`\n          // this is the url of the max resolution of thumbnail\n        });\n      });\n  };\n\n  if (!currentVideoSnippet.id) {\n    return null;\n  }\n\n  return (\n    <div\n      // drag=\"y\"\n      // dragConstraints={{ top: 0, bottom: 600 }}\n      ref={containerRef}\n      // style={playerStyle}\n      onClick={expandPlayer}\n      className={\"mediaPlayerContainer \" + returnMinMaxClass()}\n    >\n      {returnMaximizedPlayer()}\n      {returnMinimizedPlayer()}\n      <audio\n        // onTimeUpdate={timeUpdate}\n        onLoadStart={() => {\n          setAudioState(\"loading\");\n        }}\n        id=\"audio-element\"\n        onLoadedData={updateSongDB}\n        // crossOrigin=\"anonymous\"\n        onPlay={() => setAudioState(\"playing\")}\n        onPlaying={() => setAudioState(\"playing\")}\n        onPause={() => setAudioState(\"paused\")}\n        onEnded={songEnded}\n        autoPlay\n        ref={audioPlayer}\n        // type=\"audio/mp4\"\n      />\n    </div>\n  );\n};\n\nexport default MainPlayer;\n"]},"metadata":{},"sourceType":"module"}