{"ast":null,"code":"var _jsxFileName = \"C:\\\\myProJects\\\\WeatherApp\\\\weatherapp\\\\src\\\\components\\\\CurrentSection.js\";\nimport React, { useContext, useState, useEffect, useCallback, Suspense, lazy } from \"react\";\nimport { BrowserRouter as Router, withRouter, Route, Link, Switch } from \"react-router-dom\";\nimport { AnimatePresence } from \"framer-motion\";\nimport { Tabs, Tab, withStyles, Grid, CircularProgress } from \"@material-ui/core\";\nimport { Home, Favorite, VideoLibrary, History, GetApp } from \"@material-ui/icons/\";\nimport { GlobalContext } from \"./GlobalState\";\nimport { getHistory, getLikedSongs, getDownloadedSongs, removeDownloadingState, db } from \"../external/saveSong\";\nimport SettingsPage from \"./sections/SettingsPage\"; // import the db from save song\n\nimport MainPlayer from \"../components/player/MainPlayer\"; // pages\n\nconst LoginPage = lazy(() => import(\"./LoginPage\"));\nconst RenderDatabase = lazy(() => import(\"./RenderDatabase\"));\nconst SearchResult = lazy(() => import(\"./SearchResult\"));\nconst HomePage = lazy(() => import(\"./sections/HomePage\"));\nconst FeedbackForm = lazy(() => import(\"./sections/FeedbackForm\"));\nconst PrivacyPage = lazy(() => import(\"./sections/PrivacyPage\"));\nconst DonatePage = lazy(() => import(\"./sections/DonatePage\"));\nconst ContributorsPage = lazy(() => import(\"./sections/ContributorsPage\")); // custom styling the tab menus\n\nconst CustomTab = withStyles({\n  root: {\n    background: \"#4d6472\",\n    position: \"fixed\",\n    bottom: \"0\",\n    padding: 0,\n    width: \"100%\",\n    zIndex: 1300\n  },\n  indicator: {\n    display: \"none\"\n  },\n  labelIcon: {\n    margin: 0\n  }\n})(Tabs);\nconst CustomTabs = withStyles({\n  root: {\n    color: \"#FFB2C1\",\n    fontSize: \".75rem\",\n    margin: 0,\n    \"&:hover\": {\n      color: \"#ffffffed\",\n      opacity: 1\n    },\n    \"&$selected\": {\n      color: \"#fff\"\n    },\n    \"&:focus\": {\n      color: \"#FFFFFF\"\n    }\n  },\n  selected: {}\n})(Tab);\nlet deferredPrompt = undefined;\nlet previousLocation;\nwindow.addEventListener(\"beforeinstallprompt\", e => {\n  // Stash the event so it can be triggered later.\n  deferredPrompt = e;\n});\n\nconst CurrentSection = ({\n  history,\n  location\n}) => {\n  const [{\n    currentVideoSnippet,\n    searchResult\n  }] = useContext(GlobalContext);\n  console.log(currentVideoSnippet);\n  const [songsHistoryState, setSongsHistory] = useState([]);\n  const [songsLikedState, setSongsLiked] = useState([]);\n  const [songsDownloadedState, setSongsDownloaded] = useState([]);\n  const [tabValue, setTabValue] = useState(0);\n  const [updateCount, setUpdateCount] = useState(0);\n  const [redirectState, setRedirectState] = useState(null);\n  const circularLoader = /*#__PURE__*/React.createElement(Grid, {\n    style: {\n      height: \"100vh\"\n    },\n    container: true,\n    justify: \"center\",\n    alignItems: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(CircularProgress, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }));\n\n  function handleChange(event, newValue) {\n    setTabValue(newValue);\n  }\n\n  const fetchSongs = useCallback(async () => {\n    //it's same as the orders of our tabs\n    switch (tabValue) {\n      case 1:\n        setSongsLiked(await getLikedSongs());\n        break;\n\n      case 2:\n        setSongsDownloaded(await getDownloadedSongs());\n        break;\n\n      case 3:\n        setSongsHistory(await getHistory());\n        break;\n\n      default:\n        break;\n    }\n  }, [tabValue]); //\n\n  useEffect(() => {\n    fetchSongs();\n  }, [tabValue, fetchSongs]);\n  useEffect(() => {\n    fetchSongs();\n    console.log(\"fetching the songs\");\n  }, [updateCount, fetchSongs]);\n  useEffect(() => {\n    db.on(\"changes\", () => {\n      setUpdateCount(c => c + 1);\n    }); // will remove all the songs which are downloading in the first place\n\n    removeDownloadingState();\n    const isThisNewUser = localStorage.getItem(\"isThisNew\");\n\n    if (isThisNewUser === \"no\") {\n      setRedirectState(true);\n    } // if this is not a new user redirect it to home\n\n\n    previousLocation = location;\n    history.listen(location => {\n      if (location.pathname !== \"/play\") {\n        previousLocation = location;\n        console.log(previousLocation);\n      }\n    });\n  }, []);\n  useEffect(() => {\n    // we will redirect everytime user comes to root page\n    if (redirectState && history.location.pathname === \"/\") {\n      history.replace(\"/home\");\n    } // if the location is not play then we will push new location\n\n  }, [setRedirectState, history, redirectState]);\n\n  const checkPrevLocation = () => {\n    if (location.pathname === \"/play\") {\n      return previousLocation;\n    } else {\n      return location;\n    }\n  }; // we will load the homepage with all the playlists\n\n\n  const continueToHome = () => {\n    localStorage.setItem(\"isThisNew\", \"no\");\n    history.replace(\"/\");\n\n    if (deferredPrompt) {\n      // show the prompt to install app\n      deferredPrompt.prompt(); // Wait for the user to respond to the prompt\n\n      deferredPrompt.userChoice.then(choiceResult => {\n        if (choiceResult.outcome === \"accepted\") {\n          console.log(\"User accepted the A2HS prompt\");\n        } else {\n          console.log(\"User dismissed the A2HS prompt\");\n        }\n\n        deferredPrompt = null;\n      });\n    }\n  };\n\n  const returnMainPlayer = props => {\n    // we will return the main player if the path is not the \"/\"\n    if (window.location.pathname !== \"/\") {\n      return /*#__PURE__*/React.createElement(MainPlayer, Object.assign({}, props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 14\n        }\n      }));\n    } else {\n      return null;\n    }\n  }; // the set tab value will keep the tab active on their route\n  // there are 4 tabs so there will be 3 indexes\n\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Suspense, {\n    fallback: circularLoader,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    location: checkPrevLocation(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/page1\",\n    render: props => {\n      return /*#__PURE__*/React.createElement(LoginPage, {\n        continueToHome: continueToHome,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 22\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/search\",\n    render: props => /*#__PURE__*/React.createElement(SearchResult, {\n      videos: searchResult,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 30\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/home\",\n    render: props => {\n      setTabValue(0);\n      return /*#__PURE__*/React.createElement(HomePage, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 22\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/liked\",\n    render: props => {\n      setTabValue(1);\n      return /*#__PURE__*/React.createElement(RenderDatabase, Object.assign({\n        songs: songsLikedState\n      }, props, {\n        key: location.pathname,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 17\n        }\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/downloads\",\n    render: props => {\n      setTabValue(2);\n      return /*#__PURE__*/React.createElement(RenderDatabase, {\n        songs: songsDownloadedState,\n        key: location.pathname,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 17\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/history\",\n    render: props => {\n      setTabValue(3);\n      return /*#__PURE__*/React.createElement(RenderDatabase, {\n        songs: songsHistoryState,\n        key: location.pathname,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 17\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/app\",\n    render: props => {\n      window.location.replace(\"/\");\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 22\n        }\n      }, \"Redirecting you to play store\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/settings\",\n    component: SettingsPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/privacy\",\n    component: PrivacyPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/feedback\",\n    component: FeedbackForm,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/donate\",\n    component: DonatePage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/page1/contributors\",\n    component: ContributorsPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/\",\n    render: props => returnMainPlayer(props),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: currentVideoSnippet.id ? \"100px\" : \"50px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(CustomTab, {\n    value: tabValue,\n    onChange: handleChange,\n    variant: \"fullWidth\",\n    indicatorColor: \"primary\",\n    textColor: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CustomTabs, {\n    icon: /*#__PURE__*/React.createElement(Home, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 17\n      }\n    }),\n    \"aria-label\": \"Home\",\n    component: Link,\n    to: \"/page1/home\",\n    label: \"Home\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(CustomTabs, {\n    icon: /*#__PURE__*/React.createElement(Favorite, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 17\n      }\n    }),\n    \"aria-label\": \"Liked\",\n    component: Link,\n    to: \"/page1/liked\",\n    label: \"Liked\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(CustomTabs, {\n    icon: /*#__PURE__*/React.createElement(GetApp, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 17\n      }\n    }),\n    \"aria-label\": \"Downloads\",\n    component: Link,\n    to: \"/page1/downloads\",\n    label: \"Downloads\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(CustomTabs, {\n    icon: /*#__PURE__*/React.createElement(History, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 17\n      }\n    }),\n    \"aria-label\": \"History\",\n    component: Link,\n    to: \"/page1/history\",\n    label: \"History\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default withRouter(CurrentSection);","map":{"version":3,"sources":["C:/myProJects/WeatherApp/weatherapp/src/components/CurrentSection.js"],"names":["React","useContext","useState","useEffect","useCallback","Suspense","lazy","BrowserRouter","Router","withRouter","Route","Link","Switch","AnimatePresence","Tabs","Tab","withStyles","Grid","CircularProgress","Home","Favorite","VideoLibrary","History","GetApp","GlobalContext","getHistory","getLikedSongs","getDownloadedSongs","removeDownloadingState","db","SettingsPage","MainPlayer","LoginPage","RenderDatabase","SearchResult","HomePage","FeedbackForm","PrivacyPage","DonatePage","ContributorsPage","CustomTab","root","background","position","bottom","padding","width","zIndex","indicator","display","labelIcon","margin","CustomTabs","color","fontSize","opacity","selected","deferredPrompt","undefined","previousLocation","window","addEventListener","e","CurrentSection","history","location","currentVideoSnippet","searchResult","console","log","songsHistoryState","setSongsHistory","songsLikedState","setSongsLiked","songsDownloadedState","setSongsDownloaded","tabValue","setTabValue","updateCount","setUpdateCount","redirectState","setRedirectState","circularLoader","height","handleChange","event","newValue","fetchSongs","on","c","isThisNewUser","localStorage","getItem","listen","pathname","replace","checkPrevLocation","continueToHome","setItem","prompt","userChoice","then","choiceResult","outcome","returnMainPlayer","props","id"],"mappings":"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","sourcesContent":["import React, {\r\n  useContext,\r\n  useState,\r\n  useEffect,\r\n  useCallback,\r\n  Suspense,\r\n  lazy\r\n} from \"react\";\r\n\r\nimport {\r\n  BrowserRouter as Router,\r\n  withRouter,\r\n  Route,\r\n  Link,\r\n  Switch\r\n} from \"react-router-dom\";\r\n\r\nimport { AnimatePresence } from \"framer-motion\";\r\nimport {\r\n  Tabs,\r\n  Tab,\r\n  withStyles,\r\n  Grid,\r\n  CircularProgress\r\n} from \"@material-ui/core\";\r\n\r\n\r\nimport {\r\n  Home,\r\n  Favorite,\r\n  VideoLibrary,\r\n  History,\r\n  GetApp\r\n} from \"@material-ui/icons/\";\r\n\r\nimport { GlobalContext } from \"./GlobalState\";\r\nimport {\r\n  getHistory,\r\n  getLikedSongs,\r\n  getDownloadedSongs,\r\n  removeDownloadingState,\r\n  db\r\n} from \"../external/saveSong\";\r\n\r\nimport SettingsPage from \"./sections/SettingsPage\";\r\n// import the db from save song\r\nimport MainPlayer from \"../components/player/MainPlayer\";\r\n// pages\r\nconst LoginPage = lazy(() => import(\"./LoginPage\"));\r\nconst RenderDatabase = lazy(() => import(\"./RenderDatabase\"));\r\nconst SearchResult = lazy(() => import(\"./SearchResult\"));\r\nconst HomePage = lazy(() => import(\"./sections/HomePage\"));\r\nconst FeedbackForm = lazy(() => import(\"./sections/FeedbackForm\"));\r\nconst PrivacyPage = lazy(() => import(\"./sections/PrivacyPage\"));\r\nconst DonatePage = lazy(() => import(\"./sections/DonatePage\"));\r\nconst ContributorsPage = lazy(() => import(\"./sections/ContributorsPage\"));\r\n\r\n// custom styling the tab menus\r\nconst CustomTab = withStyles({\r\n  root: {\r\n    background: \"#4d6472\",\r\n    position: \"fixed\",\r\n    bottom: \"0\",\r\n    padding: 0,\r\n    width: \"100%\",\r\n    zIndex: 1300\r\n  },\r\n  indicator: {\r\n    display: \"none\"\r\n  },\r\n  labelIcon: {\r\n    margin: 0\r\n  }\r\n})(Tabs);\r\n\r\nconst CustomTabs = withStyles({\r\n  root: {\r\n    color: \"#FFB2C1\",\r\n    fontSize: \".75rem\",\r\n    margin: 0,\r\n\r\n    \"&:hover\": {\r\n      color: \"#ffffffed\",\r\n      opacity: 1\r\n    },\r\n    \"&$selected\": {\r\n      color: \"#fff\"\r\n    },\r\n    \"&:focus\": {\r\n      color: \"#FFFFFF\"\r\n    }\r\n  },\r\n\r\n  selected: {}\r\n})(Tab);\r\n\r\nlet deferredPrompt = undefined;\r\nlet previousLocation;\r\n\r\nwindow.addEventListener(\"beforeinstallprompt\", e => {\r\n  // Stash the event so it can be triggered later.\r\n  deferredPrompt = e;\r\n});\r\n\r\nconst CurrentSection = ({ history, location }) => {\r\n  const [{ currentVideoSnippet, searchResult }] = useContext(GlobalContext);\r\n  console.log(currentVideoSnippet);\r\n\r\n  const [songsHistoryState, setSongsHistory] = useState([]);\r\n  const [songsLikedState, setSongsLiked] = useState([]);\r\n  const [songsDownloadedState, setSongsDownloaded] = useState([]);\r\n  const [tabValue, setTabValue] = useState(0);\r\n  const [updateCount, setUpdateCount] = useState(0);\r\n  const [redirectState, setRedirectState] = useState(null);\r\n\r\n  const circularLoader = (\r\n    <Grid\r\n      style={{ height: \"100vh\" }}\r\n      container\r\n      justify=\"center\"\r\n      alignItems=\"center\"\r\n    >\r\n      <CircularProgress />\r\n    </Grid>\r\n  );\r\n\r\n  function handleChange(event, newValue) {\r\n    setTabValue(newValue);\r\n  }\r\n\r\n  const fetchSongs = useCallback(async () => {\r\n    //it's same as the orders of our tabs\r\n    switch (tabValue) {\r\n      case 1:\r\n        setSongsLiked(await getLikedSongs());\r\n        break;\r\n\r\n      case 2:\r\n        setSongsDownloaded(await getDownloadedSongs());\r\n        break;\r\n\r\n      case 3:\r\n        setSongsHistory(await getHistory());\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }, [tabValue]);\r\n  //\r\n  useEffect(() => {\r\n    fetchSongs();\r\n  }, [tabValue, fetchSongs]);\r\n\r\n  useEffect(() => {\r\n    fetchSongs();\r\n    console.log(\"fetching the songs\");\r\n  }, [updateCount, fetchSongs]);\r\n\r\n  useEffect(() => {\r\n    db.on(\"changes\", () => {\r\n      setUpdateCount(c => c + 1);\r\n    });\r\n    // will remove all the songs which are downloading in the first place\r\n    removeDownloadingState();\r\n\r\n    const isThisNewUser = localStorage.getItem(\"isThisNew\");\r\n    if (isThisNewUser === \"no\") {\r\n      setRedirectState(true);\r\n    }\r\n    // if this is not a new user redirect it to home\r\n    previousLocation = location;\r\n    history.listen(location => {\r\n      if (location.pathname !== \"/play\") {\r\n        previousLocation = location;\r\n        console.log(previousLocation);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // we will redirect everytime user comes to root page\r\n    if (redirectState && history.location.pathname === \"/\") {\r\n      history.replace(\"/home\");\r\n    }\r\n\r\n    // if the location is not play then we will push new location\r\n  }, [setRedirectState, history, redirectState]);\r\n\r\n  const checkPrevLocation = () => {\r\n    if (location.pathname === \"/play\") {\r\n      return previousLocation;\r\n    } else {\r\n      return location;\r\n    }\r\n  };\r\n\r\n  // we will load the homepage with all the playlists\r\n  const continueToHome = () => {\r\n    localStorage.setItem(\"isThisNew\", \"no\");\r\n    history.replace(\"/\");\r\n\r\n    if (deferredPrompt) {\r\n      // show the prompt to install app\r\n      deferredPrompt.prompt();\r\n      // Wait for the user to respond to the prompt\r\n      deferredPrompt.userChoice.then(choiceResult => {\r\n        if (choiceResult.outcome === \"accepted\") {\r\n          console.log(\"User accepted the A2HS prompt\");\r\n        } else {\r\n          console.log(\"User dismissed the A2HS prompt\");\r\n        }\r\n        deferredPrompt = null;\r\n      });\r\n    }\r\n  };\r\n\r\n  const returnMainPlayer = props => {\r\n    // we will return the main player if the path is not the \"/\"\r\n\r\n    if (window.location.pathname !== \"/\") {\r\n      return <MainPlayer {...props} />;\r\n    } else {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  // the set tab value will keep the tab active on their route\r\n  // there are 4 tabs so there will be 3 indexes\r\n  return (\r\n    <div>\r\n      <Suspense fallback={circularLoader}>\r\n        <Switch location={checkPrevLocation()}>\r\n          <Route\r\n            exact\r\n            path=\"/page1\"\r\n            render={props => {\r\n              return <LoginPage continueToHome={continueToHome} />;\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/search\"\r\n            render={props => <SearchResult videos={searchResult} />}\r\n          />\r\n          <Route\r\n            path=\"/page1/home\"\r\n            render={props => {\r\n              setTabValue(0);\r\n              return <HomePage />;\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/page1/liked\"\r\n            render={props => {\r\n              setTabValue(1);\r\n              return (\r\n                <RenderDatabase\r\n                  songs={songsLikedState}\r\n                  {...props}\r\n                  key={location.pathname}\r\n                />\r\n              );\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/page1/downloads\"\r\n            render={props => {\r\n              setTabValue(2);\r\n              return (\r\n                <RenderDatabase\r\n                  songs={songsDownloadedState}\r\n                  key={location.pathname}\r\n                />\r\n              );\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/page1/history\"\r\n            render={props => {\r\n              setTabValue(3);\r\n              return (\r\n                <RenderDatabase\r\n                  songs={songsHistoryState}\r\n                  key={location.pathname}\r\n                />\r\n              );\r\n            }}\r\n          />\r\n          <Route\r\n            path=\"/page1/app\"\r\n            render={props => {\r\n              window.location.replace(\r\n                \"/\"\r\n              );\r\n              return <div>Redirecting you to play store</div>;\r\n            }}\r\n          />\r\n\r\n          <Route path=\"/page1/settings\" component={SettingsPage} />\r\n          <Route path=\"/page1/privacy\" component={PrivacyPage} />\r\n\r\n          <Route path=\"/page1/feedback\" component={FeedbackForm} />\r\n          <Route path=\"/page1/donate\" component={DonatePage} />\r\n          <Route path=\"/page1/contributors\" component={ContributorsPage} />\r\n        </Switch>\r\n        <Route path=\"/\" render={props => returnMainPlayer(props)} />\r\n\r\n        <div style={{ height: currentVideoSnippet.id ? \"100px\" : \"50px\" }} />\r\n      </Suspense>\r\n      {/* if the player is on then return 100px else 50px*/}\r\n      <CustomTab\r\n        value={tabValue}\r\n        onChange={handleChange}\r\n        variant=\"fullWidth\"\r\n        indicatorColor=\"primary\"\r\n        textColor=\"primary\"\r\n      >\r\n        <CustomTabs\r\n          icon={<Home />}\r\n          aria-label=\"Home\"\r\n          component={Link}\r\n          to=\"/page1/home\"\r\n          label=\"Home\"\r\n        />\r\n\r\n        <CustomTabs\r\n          icon={<Favorite />}\r\n          aria-label=\"Liked\"\r\n          component={Link}\r\n          to=\"/page1/liked\"\r\n          label=\"Liked\"\r\n        />\r\n\r\n        <CustomTabs\r\n          icon={<GetApp />}\r\n          aria-label=\"Downloads\"\r\n          component={Link}\r\n          to=\"/page1/downloads\"\r\n          label=\"Downloads\"\r\n        />\r\n        <CustomTabs\r\n          icon={<History />}\r\n          aria-label=\"History\"\r\n          component={Link}\r\n          to=\"/page1/history\"\r\n          label=\"History\"\r\n        />\r\n      </CustomTab>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withRouter(CurrentSection);\r\n"]},"metadata":{},"sourceType":"module"}