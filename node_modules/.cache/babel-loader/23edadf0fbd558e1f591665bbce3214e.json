{"ast":null,"code":"import _slicedToArray from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback}from\"react\";import{useSwipeable}from\"react-swipeable\";import{motion}from\"framer-motion\";import{Avatar,Grid,Typography}from\"@material-ui/core\";import{FavoriteTwoTone}from\"@material-ui/icons\";import circleSvg from\"../../images/dottedCircle.svg\";import{rateSong}from\"../../external/saveSong\";var dblTouchTapMaxDelay=300;var latestTouchTap={time:0,target:null};function isDblTouchTap(event){var touchTap={time:new Date().getTime(),target:event.currentTarget};var isFastDblTouchTap=touchTap.target===latestTouchTap.target&&touchTap.time-latestTouchTap.time<dblTouchTapMaxDelay;latestTouchTap=touchTap;return isFastDblTouchTap;}var initialPosition;var MusicArt=function MusicArt(_ref){var data=_ref.data,rating=_ref.rating,audioEl=_ref.audioEl;var swipeUpHandler=useSwipeable({onSwipedUp:function onSwipedUp(e){dislikeSong();}});var _useState=useState({transform:\"scale(0)\"}),_useState2=_slicedToArray(_useState,2),heartStyle=_useState2[0],setHeartStyle=_useState2[1];var _useState3=useState({background:\"url(\".concat(circleSvg,\") no-repeat\"),padding:\"18px\",position:\"relative\",transition:\"transform 100ms\",transform:\"translateY(0)\"}),_useState4=_slicedToArray(_useState3,2),artContainerStyle=_useState4[0],setArtContainerStyle=_useState4[1];// const artContainerStyle = {\n//   background: `url(${circleSvg}) no-repeat`,\n//   padding: \"18px\",\n//   position: \"relative\",\n//   zIndex: \"1\"\n// };\n// if its less than 400 width we will use default hq thumbnail\nvar checkImg=function checkImg(e){if(e.target.naturalWidth<400){e.target.src=data.sdThumbnail;}};// double tap to like the song\nvar likeSong=useCallback(function(){// run the like function to like provided with song id and rating\nsetHeartStyle({transform:\"scale(0)\"});setTimeout(function(){setHeartStyle({transform:\"scale(1)\"});},300);},[setHeartStyle]);var dislikeSong=useCallback(function(){rateSong(data.id,\"disliked\");setHeartStyle({transform:\"scale(0)\"});setTimeout(function(){setHeartStyle({transform:\"scale(1)\",color:\"#2d3436\"});},200);},[setHeartStyle,data.id]);React.useEffect(function(){if(rating===\"liked\"){likeSong();}else if(rating===\"disliked\"){dislikeSong();}else{setHeartStyle({transform:\"scale(1)\"});}},[rating,likeSong,dislikeSong,setHeartStyle]);// if we find the channel name is before the song title we will remove it\n//using the regex\nvar shortTitle=function shortTitle(data){// this regex is to remove channel name from song title\nvar re=new RegExp(data.channelTitle+\" - | : \",\"g\");return data.title.replace(re,\"\");};var getThumbnail=function getThumbnail(){// if the thumbnail is downloaded then get it from database or else use the url to fetch\nif(data.thumbnail){return window.URL.createObjectURL(data.thumbnail);}else{return data.maxThumbnail;}};return/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"column\",justify:\"center\",alignItems:\"center\",style:{marginTop:\"40px\"},onClick:function onClick(e){if(isDblTouchTap(e)){likeSong();rateSong(data.id,\"liked\",audioEl);}// call the like song function on double tap\n}},/*#__PURE__*/React.createElement(motion.div,Object.assign({className:\"box\",drag:true,dragElastic:true,dragTransition:{bounceStiffness:100,bounceDamping:10},dragConstraints:{left:0,right:0,top:0,bottom:0},style:artContainerStyle},swipeUpHandler),/*#__PURE__*/React.createElement(FavoriteTwoTone,{className:\"songHeart left\",style:heartStyle}),/*#__PURE__*/React.createElement(FavoriteTwoTone,{className:\"songHeart right\",style:heartStyle}),/*#__PURE__*/React.createElement(Avatar,{className:\"searchThumb\",style:{width:\"215px\",height:\"215px\",boxShadow:\"#0000008c 1px 3px 8px\"},alt:\"video thumbnail\",src:getThumbnail(),imgProps:{onLoad:function onLoad(e){return checkImg(e);}}})),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Typography,{variant:\"h5\",className:\"musicArtTitle\",align:\"center\"},shortTitle(data)),/*#__PURE__*/React.createElement(\"h5\",{className:\"musicChannel\"},data.channelTitle),/*#__PURE__*/React.createElement(\"br\",null));};export default MusicArt;","map":{"version":3,"sources":["C:/myProJects/Server/weatherapp/src/components/player/MusicArt.js"],"names":["React","useState","useCallback","useSwipeable","motion","Avatar","Grid","Typography","FavoriteTwoTone","rateSong","dblTouchTapMaxDelay","latestTouchTap","time","target","isDblTouchTap","event","touchTap","Date","getTime","currentTarget","isFastDblTouchTap","initialPosition","MusicArt","data","rating","audioEl","swipeUpHandler","onSwipedUp","e","dislikeSong","transform","heartStyle","setHeartStyle","background","circleSvg","padding","position","transition","artContainerStyle","setArtContainerStyle","checkImg","naturalWidth","src","sdThumbnail","likeSong","setTimeout","id","color","useEffect","shortTitle","re","RegExp","channelTitle","title","replace","getThumbnail","thumbnail","window","URL","createObjectURL","maxThumbnail","marginTop","bounceStiffness","bounceDamping","left","right","top","bottom","width","height","boxShadow","onLoad"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from \"react\";\r\nimport { useSwipeable } from \"react-swipeable\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Avatar, Grid, Typography } from \"@material-ui/core\";\r\nimport { FavoriteTwoTone } from \"@material-ui/icons\";\r\nimport circleSvg from \"../../images/dottedCircle.svg\";\r\nimport { rateSong } from \"../../external/saveSong\";\r\n\r\nconst dblTouchTapMaxDelay = 300;\r\nlet latestTouchTap = {\r\n  time: 0,\r\n  target: null\r\n};\r\n\r\nfunction isDblTouchTap(event) {\r\n  const touchTap = {\r\n    time: new Date().getTime(),\r\n    target: event.currentTarget\r\n  };\r\n  const isFastDblTouchTap =\r\n    touchTap.target === latestTouchTap.target &&\r\n    touchTap.time - latestTouchTap.time < dblTouchTapMaxDelay;\r\n  latestTouchTap = touchTap;\r\n  return isFastDblTouchTap;\r\n}\r\n\r\nlet initialPosition;\r\n\r\nconst MusicArt = ({ data, rating, audioEl }) => {\r\n  const swipeUpHandler = useSwipeable({\r\n    onSwipedUp: e => {\r\n      dislikeSong();\r\n    }\r\n  });\r\n\r\n  const [heartStyle, setHeartStyle] = useState({\r\n    transform: \"scale(0)\"\r\n  });\r\n  const [artContainerStyle, setArtContainerStyle] = useState({\r\n    background: `url(${circleSvg}) no-repeat`,\r\n    padding: \"18px\",\r\n    position: \"relative\",\r\n    transition: \"transform 100ms\",\r\n    transform: \"translateY(0)\"\r\n  });\r\n\r\n  // const artContainerStyle = {\r\n  //   background: `url(${circleSvg}) no-repeat`,\r\n  //   padding: \"18px\",\r\n  //   position: \"relative\",\r\n  //   zIndex: \"1\"\r\n  // };\r\n\r\n  // if its less than 400 width we will use default hq thumbnail\r\n  const checkImg = e => {\r\n    if (e.target.naturalWidth < 400) {\r\n      e.target.src = data.sdThumbnail;\r\n    }\r\n  };\r\n\r\n  // double tap to like the song\r\n  const likeSong = useCallback(() => {\r\n    // run the like function to like provided with song id and rating\r\n    setHeartStyle({ transform: \"scale(0)\" });\r\n    setTimeout(() => {\r\n      setHeartStyle({ transform: \"scale(1)\" });\r\n    }, 300);\r\n  }, [setHeartStyle]);\r\n\r\n  const dislikeSong = useCallback(() => {\r\n    rateSong(data.id, \"disliked\");\r\n    setHeartStyle({ transform: \"scale(0)\" });\r\n    setTimeout(() => {\r\n      setHeartStyle({ transform: \"scale(1)\", color: \"#2d3436\" });\r\n    }, 200);\r\n  }, [setHeartStyle, data.id]);\r\n\r\n  React.useEffect(() => {\r\n    if (rating === \"liked\") {\r\n      likeSong();\r\n    } else if (rating === \"disliked\") {\r\n      dislikeSong();\r\n    } else {\r\n      setHeartStyle({ transform: \"scale(1)\" });\r\n    }\r\n  }, [rating, likeSong, dislikeSong, setHeartStyle]);\r\n\r\n  // if we find the channel name is before the song title we will remove it\r\n  //using the regex\r\n  const shortTitle = data => {\r\n    // this regex is to remove channel name from song title\r\n    const re = new RegExp(data.channelTitle + \" - | : \", \"g\");\r\n\r\n    return data.title.replace(re, \"\");\r\n  };\r\n\r\n  const getThumbnail = () => {\r\n    // if the thumbnail is downloaded then get it from database or else use the url to fetch\r\n    if (data.thumbnail) {\r\n      return window.URL.createObjectURL(data.thumbnail);\r\n    } else {\r\n      return data.maxThumbnail;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Grid\r\n      container\r\n      direction=\"column\"\r\n      justify=\"center\"\r\n      alignItems=\"center\"\r\n      style={{ marginTop: \"40px\" }}\r\n      onClick={e => {\r\n        if (isDblTouchTap(e)) {\r\n          likeSong();\r\n          rateSong(data.id, \"liked\", audioEl);\r\n        }\r\n        // call the like song function on double tap\r\n      }}\r\n    >\r\n      <motion.div\r\n        className=\"box\"\r\n        drag\r\n        dragElastic={true}\r\n        dragTransition={{ bounceStiffness: 100, bounceDamping: 10 }}\r\n        dragConstraints={{ left: 0, right: 0, top: 0, bottom: 0 }}\r\n        style={artContainerStyle}\r\n        {...swipeUpHandler}\r\n      >\r\n        <FavoriteTwoTone className={\"songHeart left\"} style={heartStyle} />\r\n        <FavoriteTwoTone className={\"songHeart right\"} style={heartStyle} />\r\n        <Avatar\r\n          className=\"searchThumb\"\r\n          style={{\r\n            width: \"215px\",\r\n            height: \"215px\",\r\n            boxShadow: \"#0000008c 1px 3px 8px\"\r\n          }}\r\n          alt=\"video thumbnail\"\r\n          src={getThumbnail()}\r\n          imgProps={{ onLoad: e => checkImg(e) }}\r\n        />\r\n      </motion.div>\r\n      <br />\r\n      <Typography variant=\"h5\" className=\"musicArtTitle\" align=\"center\">\r\n        {shortTitle(data)}\r\n      </Typography>\r\n      <h5 className=\"musicChannel\">\r\n        {data.channelTitle}\r\n      </h5>\r\n      <br />\r\n    </Grid>\r\n  );\r\n};\r\n\r\nexport default MusicArt;\r\n"]},"metadata":{},"sourceType":"module"}