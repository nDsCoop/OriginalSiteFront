{"ast":null,"code":"import _objectSpread from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _objectDestructuringEmpty from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectDestructuringEmpty\";import _slicedToArray from\"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect}from\"react\";// import {\n//   List,\n//   AutoSizer,\n//   CellMeasurer,\n//   CellMeasurerCache\n// } from \"react-virtualized\";\nimport{DynamicSizeList as List}from\"react-window-dynamic\";import CompletedTick from\"../images/CompletedTick.svg\";import DownloadIcon from\"../images/DownloadIcon.svg\";import{ListItem,Typography,ListItemAvatar,Avatar,Divider,ListItemText}from\"@material-ui/core\";import DownloadDeleteDialog from\"./DownloadDeleteDialog\";import{GlobalContext}from\"./GlobalState\";import getAudioLink from\"../apis/getAudioLink\";import{downloadSong,deleteSongAudio}from\"../external/saveSong\";// const cache = new CellMeasurerCache({\n//   minHeight: 50,\n//   defaultHeight: 60,\n//   fixedWidth: true\n//   // keyMapper: () => 1\n// });\nvar currentId;export var useSongMethods=function useSongMethods(songId){var _useContext=useContext(GlobalContext),_useContext2=_slicedToArray(_useContext,2);_objectDestructuringEmpty(_useContext2[0]);var dispatch=_useContext2[1];var setSnackbarMsg=React.useCallback(function(data){dispatch({type:\"setSnackbarMsg\",snippet:data});},[dispatch]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),deleteDialogState=_useState2[0],setDeleteDialogState=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),dontAskPopup=_useState4[0],setDontAskPopup=_useState4[1];useEffect(function(){//convert string to bool\nvar popupLocalState=localStorage.getItem(\"dontAskPopup\")===\"true\";setDontAskPopup(popupLocalState);// for popup settings\n},[]);var handleDownload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(songId){var res,status;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getAudioLink.get(\"/song\",{params:{id:songId}});case 2:res=_context.sent;_context.next=5;return downloadSong(songId,res.data);case 5:status=_context.sent;// after the downloading is done we will remove the downloading class\n// set the snackbar message\nsetSnackbarMsg(\"Song Downloaded\");console.log(\"song status\",status);case 8:case\"end\":return _context.stop();}}},_callee);}));return function handleDownload(_x){return _ref.apply(this,arguments);};}();var disablePopup=function disablePopup(){localStorage.setItem(\"dontAskPopup\",true);setDontAskPopup(true);};var deleteTheSong=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(checkBox){var deleted;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return deleteSongAudio(currentId);case 2:deleted=_context2.sent;setDeleteDialogState(false);setSnackbarMsg(\"Deleted Successfully\");console.log(currentId,checkBox);// we will set it to localstorage the popup option\nif(checkBox){disablePopup();}case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function deleteTheSong(_x2){return _ref2.apply(this,arguments);};}();// hadnling download dialog\nvar handleRemoveSong=function handleRemoveSong(songId){console.log(\"handle remove dude\");currentId=songId;// when user clicks on the download badge we will check the state\n// then delete the song without showing the popup if dontAskPopup is true\n// and delete the song by calling deleteTheSong\ndontAskPopup?deleteTheSong():setDeleteDialogState(true);};var deleteDialogComponent=dontAskPopup?null:/*#__PURE__*/React.createElement(DownloadDeleteDialog,{isOpen:deleteDialogState,handleCancel:function handleCancel(){return setDeleteDialogState(false);}// we will just hide the dialog on cancel\n,handleDelete:deleteTheSong//if user wants to delete the song we will just do it\n});return{handleDownload:handleDownload,handleRemoveSong:handleRemoveSong,deleteTheSong:deleteTheSong,dontAskPopup:dontAskPopup,setDeleteDialogState:setDeleteDialogState,deleteDialogState:deleteDialogState,deleteDialogComponent:deleteDialogComponent};};var RenderDatabase=function RenderDatabase(props){var songs=props.songs;var _useContext3=useContext(GlobalContext),_useContext4=_slicedToArray(_useContext3,2);_objectDestructuringEmpty(_useContext4[0]);var dispatch=_useContext4[1];var setCurrentVideoSnippet=function setCurrentVideoSnippet(data){dispatch({type:\"setCurrentVideoSnippet\",snippet:data});};var setSnackbarMsg=function setSnackbarMsg(data){dispatch({type:\"setSnakbarMsg\",snippet:data});};var _useState5=useState(window.innerHeight),_useState6=_slicedToArray(_useState5,2),windowHeight=_useState6[0],setWindowHeight=_useState6[1];var handleClick=function handleClick(song){// set all the info of current clicked video in this object\nsetCurrentVideoSnippet({id:song.videoId,audio:song.audio,thumbnail:song.thumbnail,title:song.title,channelTitle:song.channelTitle,maxThumbnail:\"https://img.youtube.com/vi/\".concat(song.videoId,\"/maxresdefault.jpg\"),sdThumbnail:\"https://img.youtube.com/vi/\".concat(song.videoId,\"/sddefault.jpg\")// this is the url of the max resolution of thumbnail\n});};var _useSongMethods=useSongMethods(),handleDownload=_useSongMethods.handleDownload,handleRemoveSong=_useSongMethods.handleRemoveSong,deleteDialogComponent=_useSongMethods.deleteDialogComponent;var returnAnimatedClass=function returnAnimatedClass(song){if(song.downloadState===\"downloading\"){console.log(song.downloadState);return\"downloading-animation\";}else{return\"\";}};useEffect(function(){setWindowHeight(window.innerHeight);});var renderResult=songs.map(function(song,index){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ListItem,{alignItems:\"flex-start\",button:true,onClick:function onClick(){return handleClick(song);}// component={Link}\n// to={{ pathname: \"/play\", search: `?id=${song.videoId}`, state: { modal: true } }}\n},/*#__PURE__*/React.createElement(ListItemAvatar,null,/*#__PURE__*/React.createElement(Avatar,{className:\"searchThumb\",style:{width:\"60px\",height:\"60px\",marginRight:\"15px\"},alt:song.title,src:\"https://img.youtube.com/vi/\".concat(song.videoId,\"/default.jpg\")})),/*#__PURE__*/React.createElement(ListItemText,{primary:song.title,secondary:/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Typography,{component:\"span\",variant:\"body2\",color:\"textPrimary\"},song.channelTitle))})),/*#__PURE__*/React.createElement(\"div\",{className:\"download-container\",onClick:function onClick(){return song.audio?handleRemoveSong(song.videoId):handleDownload(song.videoId);}},/*#__PURE__*/React.createElement(\"div\",{className:\"badge-container\"},/*#__PURE__*/React.createElement(\"img\",{className:returnAnimatedClass(song),src:song.audio?CompletedTick:DownloadIcon,alt:\"downloading icon\"}))));});var renderItem=React.forwardRef(function(row,ref){return/*#__PURE__*/React.createElement(\"div\",{ref:ref,style:_objectSpread(_objectSpread({},row.style),{},{maxWidth:\"1000px\",left:\"50%\",transform:\"translateX(-50%)\"})},renderResult[row.index],/*#__PURE__*/React.createElement(Divider,null));});return/*#__PURE__*/React.createElement(React.Fragment,null,deleteDialogComponent,/*#__PURE__*/React.createElement(List,{height:window.innerHeight-100,itemCount:songs.length,width:window.innerWidth},renderItem));};export default RenderDatabase;","map":{"version":3,"sources":["C:/myProJects/Server/weatherapp/src/components/RenderDatabase.js"],"names":["React","useContext","useState","useEffect","DynamicSizeList","List","ListItem","Typography","ListItemAvatar","Avatar","Divider","ListItemText","DownloadDeleteDialog","GlobalContext","getAudioLink","downloadSong","deleteSongAudio","currentId","useSongMethods","songId","dispatch","setSnackbarMsg","useCallback","data","type","snippet","deleteDialogState","setDeleteDialogState","dontAskPopup","setDontAskPopup","popupLocalState","localStorage","getItem","handleDownload","get","params","id","res","status","console","log","disablePopup","setItem","deleteTheSong","checkBox","deleted","handleRemoveSong","deleteDialogComponent","RenderDatabase","props","songs","setCurrentVideoSnippet","window","innerHeight","windowHeight","setWindowHeight","handleClick","song","videoId","audio","thumbnail","title","channelTitle","maxThumbnail","sdThumbnail","returnAnimatedClass","downloadState","renderResult","map","index","width","height","marginRight","CompletedTick","DownloadIcon","renderItem","forwardRef","row","ref","style","maxWidth","left","transform","length","innerWidth"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from \"react\";\r\n// import {\r\n//   List,\r\n//   AutoSizer,\r\n//   CellMeasurer,\r\n//   CellMeasurerCache\r\n// } from \"react-virtualized\";\r\n\r\nimport { DynamicSizeList as List } from \"react-window-dynamic\";\r\n\r\n\r\nimport CompletedTick from \"../images/CompletedTick.svg\";\r\nimport DownloadIcon from \"../images/DownloadIcon.svg\";\r\n\r\nimport {\r\n  ListItem,\r\n  Typography,\r\n  ListItemAvatar,\r\n  Avatar,\r\n  Divider,\r\n  ListItemText\r\n} from \"@material-ui/core\";\r\n\r\nimport DownloadDeleteDialog from \"./DownloadDeleteDialog\";\r\n\r\nimport { GlobalContext } from \"./GlobalState\";\r\n\r\nimport getAudioLink from \"../apis/getAudioLink\";\r\nimport { downloadSong, deleteSongAudio } from \"../external/saveSong\";\r\n\r\n// const cache = new CellMeasurerCache({\r\n//   minHeight: 50,\r\n//   defaultHeight: 60,\r\n//   fixedWidth: true\r\n//   // keyMapper: () => 1\r\n// });\r\n\r\nlet currentId;\r\n\r\nexport const useSongMethods = songId => {\r\n  const [{}, dispatch] = useContext(GlobalContext);\r\n\r\n  const setSnackbarMsg = React.useCallback(\r\n    data => {\r\n      dispatch({ type: \"setSnackbarMsg\", snippet: data });\r\n    },\r\n    [dispatch]\r\n  );\r\n\r\n  const [deleteDialogState, setDeleteDialogState] = useState(false);\r\n  const [dontAskPopup, setDontAskPopup] = useState(null);\r\n\r\n  useEffect(() => {\r\n    //convert string to bool\r\n    const popupLocalState = localStorage.getItem(\"dontAskPopup\") === \"true\";\r\n    setDontAskPopup(popupLocalState);\r\n    // for popup settings\r\n  }, []);\r\n\r\n  const handleDownload = async songId => {\r\n    // console.log(\"here is the id\", songId);\r\n    const res = await getAudioLink.get(\"/song\", {\r\n      params: { id: songId }\r\n    });\r\n    // first we will fetch the song link then we will download it\r\n    // the download song function takes id and the url\r\n    const status = await downloadSong(songId, res.data);\r\n    // after the downloading is done we will remove the downloading class\r\n    // set the snackbar message\r\n    setSnackbarMsg(\"Song Downloaded\");\r\n    console.log(\"song status\", status);\r\n  };\r\n\r\n  const disablePopup = () => {\r\n    localStorage.setItem(\"dontAskPopup\", true);\r\n    setDontAskPopup(true);\r\n  };\r\n\r\n  const deleteTheSong = async checkBox => {\r\n    const deleted = await deleteSongAudio(currentId);\r\n    setDeleteDialogState(false);\r\n    setSnackbarMsg(\"Deleted Successfully\");\r\n\r\n    console.log(currentId, checkBox);\r\n    // we will set it to localstorage the popup option\r\n    if (checkBox) {\r\n      disablePopup();\r\n    }\r\n  };\r\n\r\n  // hadnling download dialog\r\n  const handleRemoveSong = songId => {\r\n    console.log(\"handle remove dude\");\r\n    currentId = songId;\r\n    // when user clicks on the download badge we will check the state\r\n    // then delete the song without showing the popup if dontAskPopup is true\r\n    // and delete the song by calling deleteTheSong\r\n    dontAskPopup ? deleteTheSong() : setDeleteDialogState(true);\r\n  };\r\n\r\n  const deleteDialogComponent = dontAskPopup ? null : (\r\n    <DownloadDeleteDialog\r\n      isOpen={deleteDialogState}\r\n      handleCancel={() => setDeleteDialogState(false)} // we will just hide the dialog on cancel\r\n      handleDelete={deleteTheSong} //if user wants to delete the song we will just do it\r\n    />\r\n  );\r\n\r\n  return {\r\n    handleDownload,\r\n    handleRemoveSong,\r\n    deleteTheSong,\r\n    dontAskPopup,\r\n    setDeleteDialogState,\r\n    deleteDialogState,\r\n    deleteDialogComponent\r\n  };\r\n};\r\n\r\nconst RenderDatabase = props => {\r\n  const songs = props.songs;\r\n  const [{}, dispatch] = useContext(GlobalContext);\r\n  const setCurrentVideoSnippet = data => {\r\n    dispatch({ type: \"setCurrentVideoSnippet\", snippet: data });\r\n  };\r\n  const setSnackbarMsg = data => {\r\n    dispatch({ type: \"setSnakbarMsg\", snippet: data });\r\n  };\r\n\r\n  const [windowHeight, setWindowHeight] = useState(window.innerHeight);\r\n\r\n  const handleClick = song => {\r\n    // set all the info of current clicked video in this object\r\n    setCurrentVideoSnippet({\r\n      id: song.videoId,\r\n      audio: song.audio,\r\n      thumbnail: song.thumbnail,\r\n      title: song.title,\r\n      channelTitle: song.channelTitle,\r\n      maxThumbnail: `https://img.youtube.com/vi/${song.videoId}/maxresdefault.jpg`,\r\n      sdThumbnail: `https://img.youtube.com/vi/${song.videoId}/sddefault.jpg`\r\n      // this is the url of the max resolution of thumbnail\r\n    });\r\n  };\r\n\r\n  const {\r\n    handleDownload,\r\n    handleRemoveSong,\r\n    deleteDialogComponent\r\n  } = useSongMethods();\r\n\r\n  const returnAnimatedClass = song => {\r\n    if (song.downloadState === \"downloading\") {\r\n      console.log(song.downloadState);\r\n      return \"downloading-animation\";\r\n    } else {\r\n      return \"\";\r\n    }\r\n  };\r\n\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    setWindowHeight(window.innerHeight);\r\n  });\r\n\r\n  const renderResult = songs.map((song, index) => {\r\n    return (\r\n      <>\r\n        <ListItem\r\n          alignItems=\"flex-start\"\r\n          button\r\n          onClick={() => handleClick(song)}\r\n          // component={Link}\r\n          // to={{ pathname: \"/play\", search: `?id=${song.videoId}`, state: { modal: true } }}\r\n        >\r\n          <ListItemAvatar>\r\n            <Avatar\r\n              className=\"searchThumb\"\r\n              style={{ width: \"60px\", height: \"60px\", marginRight: \"15px\" }}\r\n              alt={song.title}\r\n              src={`https://img.youtube.com/vi/${song.videoId}/default.jpg`}\r\n            />\r\n          </ListItemAvatar>\r\n          {/* we will play the song when clicked on title */}\r\n          <ListItemText\r\n            primary={song.title}\r\n            secondary={\r\n              <React.Fragment>\r\n                <Typography\r\n                  component=\"span\"\r\n                  variant=\"body2\"\r\n                  color=\"textPrimary\"\r\n                >\r\n                  {song.channelTitle}\r\n                </Typography>\r\n              </React.Fragment>\r\n            }\r\n          />\r\n        </ListItem>\r\n        <div\r\n          className=\"download-container\"\r\n          onClick={() =>\r\n            song.audio\r\n              ? handleRemoveSong(song.videoId)\r\n              : handleDownload(song.videoId)\r\n          }\r\n        >\r\n          <div className=\"badge-container\">\r\n            {/* if there is audio file then we will show tick mark icon */}\r\n            <img\r\n              className={returnAnimatedClass(song)}\r\n              src={song.audio ? CompletedTick : DownloadIcon}\r\n              alt=\"downloading icon\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  });\r\n\r\n  const renderItem = React.forwardRef((row, ref) => (\r\n    <div\r\n      ref={ref}\r\n      style={{\r\n        ...row.style,\r\n        maxWidth: \"1000px\",\r\n        left: \"50%\",\r\n        transform: \"translateX(-50%)\"\r\n      }}\r\n    >\r\n      {renderResult[row.index]}\r\n      <Divider />\r\n    </div>\r\n  ));\r\n  return (\r\n    <>\r\n      {deleteDialogComponent}\r\n\r\n      <List\r\n        height={window.innerHeight - 100}\r\n        itemCount={songs.length}\r\n        width={window.innerWidth}\r\n      >\r\n        {renderItem}\r\n      </List>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RenderDatabase;\r\n"]},"metadata":{},"sourceType":"module"}