{"ast":null,"code":"var _jsxFileName = \"C:\\\\myProJects\\\\Server\\\\weatherapp\\\\src\\\\components\\\\library\\\\AudioGet.js\";\nimport React, { Component } from 'react';\nimport { ObjectID } from \"../helpers/objectid\";\nimport AudioAnalyser from './AudioAnalyser';\nimport { IconButton } from '@material-ui/core';\nimport { CgSoftwareUpload } from 'react-icons/cg';\n\nclass AudioGet extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getAudio = mediaRecorder => {\n      mediaRecorder.onstop = function (e) {\n        const blob = new Blob(chunks, {\n          'type': 'audio/ogg',\n          'lastModified': new Date(),\n          'name': new ObjectID().toString(),\n          'path': new ObjectID().toString()\n        });\n      };\n\n      mediaRecorder.ondataavailable = function (e) {\n        console.log('Final: ', e.data);\n        console.log(\"Pressed btn stop record!\");\n      };\n\n      this.state.audio.getTracks().forEach(track => {\n        console.log(track);\n        track.stop();\n      });\n      this.setState({\n        audio: null\n      });\n    };\n\n    this.toggleMicrophone = () => {\n      if (!this.state.isShowGetAudi) {\n        this.getMicrophone();\n      }\n    };\n\n    this.onClickOutSide = e => {\n      if (this.ref && !this.ref.contains(e.target)) {\n        // console.log(\"Here click out side login form!\");\n        this.stopMicrophone();\n        this.setState({\n          showGetAudi: false\n        });\n      }\n    };\n\n    this.state = {\n      audio: false,\n      isShowGetAudi: false,\n      temp: 10000\n    };\n  }\n\n  async getMicrophone() {\n    const audio = await navigator.mediaDevices.getUserMedia({\n      audio: true,\n      video: false\n    });\n    this.setState({\n      audio: true\n    });\n    const mediaRecorder = new MediaRecorder(audio);\n    mediaRecorder.start();\n    setTimeout(() => {\n      this.getAudio(mediaRecorder); // this.state.audio.getTracks().forEach(track => track.stop());\n      // this.setState({ audio: null });\n\n      this.setState({\n        temp: 10000\n      });\n    }, this.state.temp);\n  }\n\n  componentDidMount() {\n    window.addEventListener('mousedown', this.onClickOutSide); // this.addTestMessages();\n    // console.log(\"CDidMount\");\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('mousedown', this.onClickOutSide);\n  }\n\n  render() {\n    const {\n      isShowGetAudi\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, isShowGetAudi ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"getAdi\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 26\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 19\n      }\n    }, this.state.audio ? /*#__PURE__*/React.createElement(AudioAnalyser, {\n      audio: this.state.audio,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 39\n      }\n    }) : null)) : null, /*#__PURE__*/React.createElement(IconButton, {\n      ref: ref => this.ref = ref,\n      onClick: () => this.setState({\n        isShowGetAudi: !isShowGetAudi\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(CgSoftwareUpload, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 7\n      }\n    })));\n  }\n\n}\n\nexport default AudioGet;","map":{"version":3,"sources":["C:/myProJects/Server/weatherapp/src/components/library/AudioGet.js"],"names":["React","Component","ObjectID","AudioAnalyser","IconButton","CgSoftwareUpload","AudioGet","constructor","props","getAudio","mediaRecorder","onstop","e","blob","Blob","chunks","Date","toString","ondataavailable","console","log","data","state","audio","getTracks","forEach","track","stop","setState","toggleMicrophone","isShowGetAudi","getMicrophone","onClickOutSide","ref","contains","target","stopMicrophone","showGetAudi","temp","navigator","mediaDevices","getUserMedia","video","MediaRecorder","start","setTimeout","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport {ObjectID} from \"../helpers/objectid\";\r\nimport AudioAnalyser from './AudioAnalyser';\r\nimport { IconButton } from '@material-ui/core';\r\nimport { CgSoftwareUpload } from 'react-icons/cg';\r\n\r\nclass AudioGet extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      audio: false,\r\n      isShowGetAudi: false,\r\n      temp : 10000,\r\n    }\r\n  }\r\n\r\n  async getMicrophone() {\r\n\r\n    const audio = await navigator.mediaDevices.getUserMedia({\r\n      audio: true,\r\n      video: false\r\n    });\r\n    this.setState({ audio: true });\r\n    const mediaRecorder = new MediaRecorder(audio);\r\n    mediaRecorder.start();\r\n   \r\n    setTimeout(() => {\r\n      this.getAudio(mediaRecorder)\r\n      // this.state.audio.getTracks().forEach(track => track.stop());\r\n      // this.setState({ audio: null });\r\n      this.setState({temp : 10000})\r\n\r\n  }, this.state.temp);\r\n}\r\n\r\n  getAudio = (mediaRecorder) => {\r\n    mediaRecorder.onstop = function(e) {\r\n      const blob = new Blob(chunks, { \r\n          'type' : 'audio/ogg',\r\n          'lastModified': new Date(),\r\n          'name': new ObjectID().toString(),\r\n          'path' :new ObjectID().toString(),\r\n   });\r\n     \r\n  }\r\n  mediaRecorder.ondataavailable = function(e) {\r\n   \r\n    console.log('Final: ' ,e.data);\r\n    console.log(\"Pressed btn stop record!\");\r\n    } \r\n\r\n    this.state.audio.getTracks().forEach( track =>{\r\n      console.log(track);\r\n      track.stop();\r\n    });\r\n    this.setState({ audio: null });\r\n\r\n  }\r\n\r\n    \r\n\r\n\r\ntoggleMicrophone = () => {\r\n  if (!this.state.isShowGetAudi) {\r\n    this.getMicrophone();\r\n  } \r\n}\r\n  componentDidMount(){\r\n    window.addEventListener('mousedown', this.onClickOutSide);\r\n    // this.addTestMessages();\r\n    // console.log(\"CDidMount\");\r\n  }\r\n  componentWillUnmount(){\r\n    window.removeEventListener('mousedown', this.onClickOutSide);\r\n  }\r\n  onClickOutSide = (e) => {\r\n    if(this.ref && !this.ref.contains(e.target)){\r\n        // console.log(\"Here click out side login form!\");\r\n        this.stopMicrophone();\r\n        this.setState({\r\n            showGetAudi: false,\r\n        })\r\n    }\r\n}\r\n\r\n  \r\n  render() {\r\n    const { isShowGetAudi } = this.state\r\n    return(\r\n      <>\r\n       {\r\n         isShowGetAudi ? <div className=\"getAdi\">\r\n                  <div>\r\n                  {this.state.audio ? <AudioAnalyser audio={this.state.audio} /> : null}\r\n                  </div>\r\n          </div> : null\r\n      }\r\n      <IconButton ref = {(ref) => this.ref = ref} onClick = {() => this.setState({isShowGetAudi: !isShowGetAudi})} >\r\n      <CgSoftwareUpload />\r\n      </IconButton>\r\n      </>\r\n\r\n    ) \r\n  }\r\n}\r\n\r\nexport default AudioGet;"]},"metadata":{},"sourceType":"module"}